<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="dcterms.date" content="2025-09-23">
<title>pythrash - Statistics Basics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script><link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../../_include/styles.css">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">PythRaSh</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-r" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">R</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-r">
<li>
    <a class="dropdown-item" href="../../ch/rbasics/git.html" rel="" target="">
 <span class="dropdown-text">git</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/rbasics/firststeps.html" rel="" target="">
 <span class="dropdown-text">Basic R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/rbasics/tidyverse.html" rel="" target="">
 <span class="dropdown-text">The tidyverse</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/rbasics/correlation_regression.html" rel="" target="">
 <span class="dropdown-text">Advanced R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/rbasics/baddata.html" rel="" target="">
 <span class="dropdown-text">Data Wrangling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/rbasics/solutions.html" rel="" target="">
 <span class="dropdown-text">Problem Solutions</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-python" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Python</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-python">
<li>
    <a class="dropdown-item" href="../../ch/python/basics.html" rel="" target="">
 <span class="dropdown-text">Basics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/python/uv_tutorial.html" rel="" target="">
 <span class="dropdown-text">UV Package Manager</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/python/panda.html" rel="" target="">
 <span class="dropdown-text">Advanced Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/python/MLA.html" rel="" target="">
 <span class="dropdown-text">Machine Learning Algorithms</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/python/AI.html" rel="" target="">
 <span class="dropdown-text">AI</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-linux-and-clt" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Linux and CLT</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-linux-and-clt">
<li>
    <a class="dropdown-item" href="../../ch/linux-and-ctl/basics.html" rel="" target="">
 <span class="dropdown-text">Linux Basics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/linux-and-ctl/advanced.html" rel="" target="">
 <span class="dropdown-text">Advanced Command Line</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-probability-and-statistics" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Probability and Statistics</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-probability-and-statistics">
<li>
    <a class="dropdown-item" href="../../ch/prob_stat/prob_basic.html" rel="" target="">
 <span class="dropdown-text">Probability Basics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/prob_stat/stat.html" rel="" target="">
 <span class="dropdown-text">Statistics</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-genomics" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Genomics</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-genomics">
<li>
    <a class="dropdown-item" href="../../ch/genomics/basics.html" rel="" target="">
 <span class="dropdown-text">Genomics Basics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/genomics/advanced.html" rel="" target="">
 <span class="dropdown-text">Advanced Genomics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/genomics/pipeline.html" rel="" target="">
 <span class="dropdown-text">Pipelines</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-newsletter" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Newsletter</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-newsletter">
<li>
    <a class="dropdown-item" href="../../ch/newsletter/index.html" rel="" target="">
 <span class="dropdown-text">All issues</span></a>
  </li>  
    </ul>
</li>
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-blogs" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Blogs</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-blogs">
<li>
    <a class="dropdown-item" href="../../ch/blogs/en/index.html" rel="" target="">
 <span class="dropdown-text">English</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/blogs/bn/index.html" rel="" target="">
 <span class="dropdown-text">Bangla</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/MdRasheduz-zaman" rel="" target="">
 <span class="menu-text">Contact</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/MdRasheduz-zaman/PythRaSh" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#part-1-the-coffee-shop-example---why-anova-types-matter" id="toc-part-1-the-coffee-shop-example---why-anova-types-matter" class="nav-link active" data-scroll-target="#part-1-the-coffee-shop-example---why-anova-types-matter">Part 1: The Coffee Shop Example - Why ANOVA Types Matter</a>
  <ul class="collapse">
<li><a href="#setting-the-stage-with-a-simple-story" id="toc-setting-the-stage-with-a-simple-story" class="nav-link" data-scroll-target="#setting-the-stage-with-a-simple-story">Setting the Stage with a Simple Story</a></li>
  <li><a href="#now-lets-create-reality-unbalanced-data" id="toc-now-lets-create-reality-unbalanced-data" class="nav-link" data-scroll-target="#now-lets-create-reality-unbalanced-data">Now Let’s Create Reality: Unbalanced Data</a></li>
  </ul>
</li>
  <li>
<a href="#part-2-the-mathematical-foundation-of-anova" id="toc-part-2-the-mathematical-foundation-of-anova" class="nav-link" data-scroll-target="#part-2-the-mathematical-foundation-of-anova">Part 2: The Mathematical Foundation of ANOVA</a>
  <ul class="collapse">
<li><a href="#the-general-linear-model" id="toc-the-general-linear-model" class="nav-link" data-scroll-target="#the-general-linear-model">The General Linear Model</a></li>
  <li><a href="#sum-of-squares-decomposition" id="toc-sum-of-squares-decomposition" class="nav-link" data-scroll-target="#sum-of-squares-decomposition">Sum of Squares Decomposition</a></li>
  </ul>
</li>
  <li>
<a href="#part-3-why-order-matters---a-visual-explanation" id="toc-part-3-why-order-matters---a-visual-explanation" class="nav-link" data-scroll-target="#part-3-why-order-matters---a-visual-explanation">Part 3: Why Order Matters - A Visual Explanation</a>
  <ul class="collapse">
<li><a href="#understanding-sequential-vs-simultaneous-testing" id="toc-understanding-sequential-vs-simultaneous-testing" class="nav-link" data-scroll-target="#understanding-sequential-vs-simultaneous-testing">Understanding Sequential vs Simultaneous Testing</a></li>
  </ul>
</li>
  <li>
<a href="#part-4-the-controversy---types-i-ii-and-iii-sum-of-squares" id="toc-part-4-the-controversy---types-i-ii-and-iii-sum-of-squares" class="nav-link" data-scroll-target="#part-4-the-controversy---types-i-ii-and-iii-sum-of-squares">Part 4: The Controversy - Types I, II, and III Sum of Squares</a>
  <ul class="collapse">
<li><a href="#manual-calculation-tables-for-understanding" id="toc-manual-calculation-tables-for-understanding" class="nav-link" data-scroll-target="#manual-calculation-tables-for-understanding">Manual Calculation Tables for Understanding</a></li>
  <li><a href="#type-i-sum-of-squares-sequential" id="toc-type-i-sum-of-squares-sequential" class="nav-link" data-scroll-target="#type-i-sum-of-squares-sequential">Type I Sum of Squares (Sequential)</a></li>
  <li><a href="#example-when-type-i-makes-sense" id="toc-example-when-type-i-makes-sense" class="nav-link" data-scroll-target="#example-when-type-i-makes-sense">Example: When Type I Makes Sense</a></li>
  <li><a href="#what-does-each-row-mean" id="toc-what-does-each-row-mean" class="nav-link" data-scroll-target="#what-does-each-row-mean">What Does Each Row Mean?</a></li>
  <li><a href="#type-ii-sum-of-squares-hierarchical" id="toc-type-ii-sum-of-squares-hierarchical" class="nav-link" data-scroll-target="#type-ii-sum-of-squares-hierarchical">Type II Sum of Squares (Hierarchical)</a></li>
  <li><a href="#what-does-each-row-mean-in-type-ii" id="toc-what-does-each-row-mean-in-type-ii" class="nav-link" data-scroll-target="#what-does-each-row-mean-in-type-ii">What Does Each Row Mean in Type II?</a></li>
  <li><a href="#type-iii-sum-of-squares-marginal" id="toc-type-iii-sum-of-squares-marginal" class="nav-link" data-scroll-target="#type-iii-sum-of-squares-marginal">Type III Sum of Squares (Marginal)</a></li>
  <li><a href="#what-does-each-row-mean-in-type-iii" id="toc-what-does-each-row-mean-in-type-iii" class="nav-link" data-scroll-target="#what-does-each-row-mean-in-type-iii">What Does Each Row Mean in Type III?</a></li>
  </ul>
</li>
  <li>
<a href="#part-5-why-all-three-types-give-the-same-answer-for-balanced-data" id="toc-part-5-why-all-three-types-give-the-same-answer-for-balanced-data" class="nav-link" data-scroll-target="#part-5-why-all-three-types-give-the-same-answer-for-balanced-data">Part 5: Why All Three Types Give the Same Answer for Balanced Data</a>
  <ul class="collapse">
<li><a href="#the-magic-of-orthogonality" id="toc-the-magic-of-orthogonality" class="nav-link" data-scroll-target="#the-magic-of-orthogonality">The Magic of Orthogonality</a></li>
  <li><a href="#detailed-comparison-table" id="toc-detailed-comparison-table" class="nav-link" data-scroll-target="#detailed-comparison-table">Detailed Comparison Table</a></li>
  </ul>
</li>
  <li>
<a href="#part-6-variance-heterogeneity-unequal-variances" id="toc-part-6-variance-heterogeneity-unequal-variances" class="nav-link" data-scroll-target="#part-6-variance-heterogeneity-unequal-variances">Part 6: Variance Heterogeneity (Unequal Variances)</a>
  <ul class="collapse">
<li><a href="#creating-data-with-unequal-variances" id="toc-creating-data-with-unequal-variances" class="nav-link" data-scroll-target="#creating-data-with-unequal-variances">Creating Data with Unequal Variances</a></li>
  <li><a href="#testing-for-homogeneity-of-variance" id="toc-testing-for-homogeneity-of-variance" class="nav-link" data-scroll-target="#testing-for-homogeneity-of-variance">Testing for Homogeneity of Variance</a></li>
  <li><a href="#consequences-of-ignoring-unequal-variances" id="toc-consequences-of-ignoring-unequal-variances" class="nav-link" data-scroll-target="#consequences-of-ignoring-unequal-variances">Consequences of Ignoring Unequal Variances</a></li>
  </ul>
</li>
  <li>
<a href="#part-7-complete-analysis-pipeline" id="toc-part-7-complete-analysis-pipeline" class="nav-link" data-scroll-target="#part-7-complete-analysis-pipeline">Part 7: Complete Analysis Pipeline</a>
  <ul class="collapse">
<li><a href="#step-by-step-analysis-function" id="toc-step-by-step-analysis-function" class="nav-link" data-scroll-target="#step-by-step-analysis-function">Step-by-Step Analysis Function</a></li>
  </ul>
</li>
  <li>
<a href="#part-8-practical-decision-tree" id="toc-part-8-practical-decision-tree" class="nav-link" data-scroll-target="#part-8-practical-decision-tree">Part 8: Practical Decision Tree</a>
  <ul class="collapse">
<li><a href="#when-to-use-which-type" id="toc-when-to-use-which-type" class="nav-link" data-scroll-target="#when-to-use-which-type">When to Use Which Type?</a></li>
  </ul>
</li>
  <li>
<a href="#part-9-quick-reference-functions" id="toc-part-9-quick-reference-functions" class="nav-link" data-scroll-target="#part-9-quick-reference-functions">Part 9: Quick Reference Functions</a>
  <ul class="collapse">
<li><a href="#comparison-function-for-all-three-types" id="toc-comparison-function-for-all-three-types" class="nav-link" data-scroll-target="#comparison-function-for-all-three-types">Comparison Function for All Three Types</a></li>
  </ul>
</li>
  <li>
<a href="#part-10-summary-and-key-takeaways" id="toc-part-10-summary-and-key-takeaways" class="nav-link" data-scroll-target="#part-10-summary-and-key-takeaways">Part 10: Summary and Key Takeaways</a>
  <ul class="collapse">
<li><a href="#the-essential-points" id="toc-the-essential-points" class="nav-link" data-scroll-target="#the-essential-points">The Essential Points</a></li>
  <li><a href="#mathematical-summary" id="toc-mathematical-summary" class="nav-link" data-scroll-target="#mathematical-summary">Mathematical Summary</a></li>
  <li><a href="#appendix-r-package-requirements" id="toc-appendix-r-package-requirements" class="nav-link" data-scroll-target="#appendix-r-package-requirements">Appendix: R Package Requirements</a></li>
  </ul>
</li>
  </ul><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="stat.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Statistics Basics</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Md Rasheduzzaman </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.fli.de/de/institute/institut-fuer-infektionsmedizin-imed/">
            FLI Insel Riems
            </a>
          </p>
        <p class="affiliation">
            <a href="https://github.com/MdRasheduz-zaman">
            &amp; Freelancer
            </a>
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Last updated</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 23, 2025</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Content summary</div>
    Statistical tests, Statistics, Statistic, CLT, etc.
  </div>
</div>

</header><div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>echo <span class="op">=</span> <span class="cn">TRUE</span>, warning <span class="op">=</span> <span class="cn">FALSE</span>, message <span class="op">=</span> <span class="cn">FALSE</span>, fig.width <span class="op">=</span> <span class="fl">10</span>, fig.height <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rvlenth/emmeans">emmeans</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/taiyun/corrplot">corrplot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Helper function for separators</span></span>
<span><span class="va">sep_line</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">char</span> <span class="op">=</span> <span class="st">"="</span>, <span class="va">n</span> <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">char</span>, <span class="va">n</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="part-1-the-coffee-shop-example---why-anova-types-matter" class="level1"><h1>Part 1: The Coffee Shop Example - Why ANOVA Types Matter</h1>
<section id="setting-the-stage-with-a-simple-story" class="level2"><h2 class="anchored" data-anchor-id="setting-the-stage-with-a-simple-story">Setting the Stage with a Simple Story</h2>
<p>Imagine you own a coffee shop and want to understand what affects customer satisfaction scores (1-10 scale). You consider two factors:</p>
<ol type="1">
<li>
<strong>Coffee Type</strong>: Regular vs Decaf</li>
<li>
<strong>Time of Day</strong>: Morning vs Afternoon</li>
</ol>
<p>Let’s create this scenario with data:</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a BALANCED design first (equal sample sizes)</span></span>
<span><span class="va">n_per_cell</span> <span class="op">&lt;-</span> <span class="fl">20</span>  <span class="co"># 20 customers in each combination</span></span>
<span></span>
<span><span class="va">balanced_coffee</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span></span>
<span>  coffee_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Regular"</span>, <span class="st">"Decaf"</span><span class="op">)</span>,</span>
<span>  time_of_day <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Morning"</span>, <span class="st">"Afternoon"</span><span class="op">)</span>,</span>
<span>  replicate <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_per_cell</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Create satisfaction scores with main effects and interaction</span></span>
<span>    satisfaction <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">coffee_type</span> <span class="op">==</span> <span class="st">"Regular"</span> <span class="op">&amp;</span> <span class="va">time_of_day</span> <span class="op">==</span> <span class="st">"Morning"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">8</span>, <span class="fl">1</span><span class="op">)</span>,    <span class="co"># High satisfaction</span></span>
<span>      <span class="va">coffee_type</span> <span class="op">==</span> <span class="st">"Regular"</span> <span class="op">&amp;</span> <span class="va">time_of_day</span> <span class="op">==</span> <span class="st">"Afternoon"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">6</span>, <span class="fl">1</span><span class="op">)</span>,  <span class="co"># Medium</span></span>
<span>      <span class="va">coffee_type</span> <span class="op">==</span> <span class="st">"Decaf"</span> <span class="op">&amp;</span> <span class="va">time_of_day</span> <span class="op">==</span> <span class="st">"Morning"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">5</span>, <span class="fl">1</span><span class="op">)</span>,      <span class="co"># Low-medium</span></span>
<span>      <span class="va">coffee_type</span> <span class="op">==</span> <span class="st">"Decaf"</span> <span class="op">&amp;</span> <span class="va">time_of_day</span> <span class="op">==</span> <span class="st">"Afternoon"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">1</span><span class="op">)</span>     <span class="co"># Medium-high</span></span>
<span>    <span class="op">)</span>,</span>
<span>    coffee_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">coffee_type</span><span class="op">)</span>,</span>
<span>    time_of_day <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">time_of_day</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">replicate</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show the structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Balanced Design - Sample Sizes:"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] "Balanced Design - Sample Sizes:"</code></pre>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">balanced_coffee</span><span class="op">$</span><span class="va">coffee_type</span>, <span class="va">balanced_coffee</span><span class="op">$</span><span class="va">time_of_day</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>         
          Morning Afternoon
  Regular      20        20
  Decaf        20        20</code></pre>
</div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate means for each cell</span></span>
<span><span class="va">cell_means_balanced</span> <span class="op">&lt;-</span> <span class="va">balanced_coffee</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">coffee_type</span>, <span class="va">time_of_day</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    mean_satisfaction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">satisfaction</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">'drop'</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">cell_means_balanced</span>, digits <span class="op">=</span> <span class="fl">2</span>, </span>
<span>      caption <span class="op">=</span> <span class="st">"Mean Satisfaction Scores - Balanced Design"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-sm small" data-quarto-postprocess="true">
<caption>Mean Satisfaction Scores - Balanced Design</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">coffee_type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">time_of_day</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean_satisfaction</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Regular</td>
<td style="text-align: left;">Morning</td>
<td style="text-align: right;">8.31</td>
<td style="text-align: right;">20</td>
</tr>
<tr class="even">
<td style="text-align: left;">Regular</td>
<td style="text-align: left;">Afternoon</td>
<td style="text-align: right;">5.74</td>
<td style="text-align: right;">20</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Decaf</td>
<td style="text-align: left;">Morning</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">20</td>
</tr>
<tr class="even">
<td style="text-align: left;">Decaf</td>
<td style="text-align: left;">Afternoon</td>
<td style="text-align: right;">7.01</td>
<td style="text-align: right;">20</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="now-lets-create-reality-unbalanced-data" class="level2"><h2 class="anchored" data-anchor-id="now-lets-create-reality-unbalanced-data">Now Let’s Create Reality: Unbalanced Data</h2>
<p>In real life, you don’t get equal numbers of customers in each category. Maybe fewer people order decaf in the morning:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create UNBALANCED design (unequal sample sizes)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="va">unbalanced_coffee</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="co"># Regular + Morning: 30 customers (popular!)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    coffee_type <span class="op">=</span> <span class="st">"Regular"</span>,</span>
<span>    time_of_day <span class="op">=</span> <span class="st">"Morning"</span>,</span>
<span>    satisfaction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">8</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="co"># Regular + Afternoon: 25 customers</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    coffee_type <span class="op">=</span> <span class="st">"Regular"</span>,</span>
<span>    time_of_day <span class="op">=</span> <span class="st">"Afternoon"</span>,</span>
<span>    satisfaction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">6</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="co"># Decaf + Morning: 10 customers (unpopular combination)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    coffee_type <span class="op">=</span> <span class="st">"Decaf"</span>,</span>
<span>    time_of_day <span class="op">=</span> <span class="st">"Morning"</span>,</span>
<span>    satisfaction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">5</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="co"># Decaf + Afternoon: 20 customers</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    coffee_type <span class="op">=</span> <span class="st">"Decaf"</span>,</span>
<span>    time_of_day <span class="op">=</span> <span class="st">"Afternoon"</span>,</span>
<span>    satisfaction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">7</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    coffee_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">coffee_type</span><span class="op">)</span>,</span>
<span>    time_of_day <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">time_of_day</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Unbalanced Design - Sample Sizes:"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] "Unbalanced Design - Sample Sizes:"</code></pre>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">unbalanced_coffee</span><span class="op">$</span><span class="va">coffee_type</span>, <span class="va">unbalanced_coffee</span><span class="op">$</span><span class="va">time_of_day</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>         
          Afternoon Morning
  Decaf          20      10
  Regular        25      30</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cell_means_unbalanced</span> <span class="op">&lt;-</span> <span class="va">unbalanced_coffee</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">coffee_type</span>, <span class="va">time_of_day</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    mean_satisfaction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">satisfaction</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">'drop'</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">cell_means_unbalanced</span>, digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Mean Satisfaction Scores - Unbalanced Design"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-sm small" data-quarto-postprocess="true">
<caption>Mean Satisfaction Scores - Unbalanced Design</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">coffee_type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">time_of_day</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean_satisfaction</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Decaf</td>
<td style="text-align: left;">Afternoon</td>
<td style="text-align: right;">7.13</td>
<td style="text-align: right;">20</td>
</tr>
<tr class="even">
<td style="text-align: left;">Decaf</td>
<td style="text-align: left;">Morning</td>
<td style="text-align: right;">4.94</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Regular</td>
<td style="text-align: left;">Afternoon</td>
<td style="text-align: right;">5.92</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Regular</td>
<td style="text-align: left;">Morning</td>
<td style="text-align: right;">8.07</td>
<td style="text-align: right;">30</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section><section id="part-2-the-mathematical-foundation-of-anova" class="level1"><h1>Part 2: The Mathematical Foundation of ANOVA</h1>
<section id="the-general-linear-model" class="level2"><h2 class="anchored" data-anchor-id="the-general-linear-model">The General Linear Model</h2>
<p>ANOVA is actually a special case of linear regression. Our two-way ANOVA model can be written as:</p>
<p><span class="math display">\[Y_{ijk} = \mu + \alpha_i + \beta_j + (\alpha\beta)_{ij} + \epsilon_{ijk}\]</span></p>
<p>Where:</p>
<ul>
<li>
<span class="math inline">\(Y_{ijk}\)</span> = satisfaction score for the <span class="math inline">\(k\)</span>-th customer with coffee type <span class="math inline">\(i\)</span> and time <span class="math inline">\(j\)</span>
</li>
<li>
<span class="math inline">\(\mu\)</span> = grand mean (overall average satisfaction)</li>
<li>
<span class="math inline">\(\alpha_i\)</span> = main effect of coffee type <span class="math inline">\(i\)</span> (how much Regular or Decaf changes satisfaction)</li>
<li>
<span class="math inline">\(\beta_j\)</span> = main effect of time of day <span class="math inline">\(j\)</span> (how much Morning or Afternoon changes satisfaction)</li>
<li>
<span class="math inline">\((\alpha\beta)_{ij}\)</span> = interaction effect (does the coffee type effect depend on time of day?)</li>
<li>
<span class="math inline">\(\epsilon_{ijk}\)</span> = random error (individual differences)</li>
</ul></section><section id="sum-of-squares-decomposition" class="level2"><h2 class="anchored" data-anchor-id="sum-of-squares-decomposition">Sum of Squares Decomposition</h2>
<p>The total variation in our data can be decomposed:</p>
<p><span class="math display">\[SS_{Total} = SS_{CoffeeType} + SS_{Time} + SS_{Interaction} + SS_{Error}\]</span></p>
<p>In plain English: Total variation = Variation due to coffee type + Variation due to time + Variation due to their combination + Random variation</p>
</section></section><section id="part-3-why-order-matters---a-visual-explanation" class="level1"><h1>Part 3: Why Order Matters - A Visual Explanation</h1>
<section id="understanding-sequential-vs-simultaneous-testing" class="level2"><h2 class="anchored" data-anchor-id="understanding-sequential-vs-simultaneous-testing">Understanding Sequential vs Simultaneous Testing</h2>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a visual demonstration of why order matters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Function to calculate partial correlations and visualize</span></span>
<span><span class="va">demonstrate_order_effects</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Calculate total sum of squares</span></span>
<span>  <span class="va">grand_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">satisfaction</span><span class="op">)</span></span>
<span>  <span class="va">ss_total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">satisfaction</span> <span class="op">-</span> <span class="va">grand_mean</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Calculate group means</span></span>
<span>  <span class="va">coffee_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">satisfaction</span>, <span class="va">data</span><span class="op">$</span><span class="va">coffee_type</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>  <span class="va">time_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">satisfaction</span>, <span class="va">data</span><span class="op">$</span><span class="va">time_of_day</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Calculate marginal sums of squares (ignoring the other factor)</span></span>
<span>  <span class="va">ss_coffee_alone</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">coffee_type</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">coffee_means</span> <span class="op">-</span> <span class="va">grand_mean</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">ss_time_alone</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">time_of_day</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">time_means</span> <span class="op">-</span> <span class="va">grand_mean</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Create a data frame for visualization</span></span>
<span>  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    Approach <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Coffee First"</span>, <span class="st">"Time First"</span>, <span class="st">"Coffee Alone"</span>, <span class="st">"Time Alone"</span><span class="op">)</span>,</span>
<span>    Coffee_SS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ss_coffee_alone</span>, <span class="cn">NA</span>, <span class="va">ss_coffee_alone</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    Time_SS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">ss_time_alone</span>, <span class="cn">NA</span>, <span class="va">ss_time_alone</span><span class="op">)</span>,</span>
<span>    Order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1st"</span>, <span class="st">"1st"</span>, <span class="st">"Marginal"</span>, <span class="st">"Marginal"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    ss_total <span class="op">=</span> <span class="va">ss_total</span>,</span>
<span>    ss_coffee_alone <span class="op">=</span> <span class="va">ss_coffee_alone</span>,</span>
<span>    ss_time_alone <span class="op">=</span> <span class="va">ss_time_alone</span>,</span>
<span>    coffee_means <span class="op">=</span> <span class="va">coffee_means</span>,</span>
<span>    time_means <span class="op">=</span> <span class="va">time_means</span>,</span>
<span>    grand_mean <span class="op">=</span> <span class="va">grand_mean</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Apply to both datasets</span></span>
<span><span class="va">balanced_results</span> <span class="op">&lt;-</span> <span class="fu">demonstrate_order_effects</span><span class="op">(</span><span class="va">balanced_coffee</span><span class="op">)</span></span>
<span><span class="va">unbalanced_results</span> <span class="op">&lt;-</span> <span class="fu">demonstrate_order_effects</span><span class="op">(</span><span class="va">unbalanced_coffee</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create comparison table</span></span>
<span><span class="va">comparison_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Design <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Balanced"</span>, <span class="st">"Balanced"</span>, <span class="st">"Unbalanced"</span>, <span class="st">"Unbalanced"</span><span class="op">)</span>,</span>
<span>  Factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Coffee Type"</span>, <span class="st">"Time of Day"</span>, <span class="st">"Coffee Type"</span>, <span class="st">"Time of Day"</span><span class="op">)</span>,</span>
<span>  `SS When Tested First` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="va">balanced_results</span><span class="op">$</span><span class="va">ss_coffee_alone</span>,</span>
<span>    <span class="va">balanced_results</span><span class="op">$</span><span class="va">ss_time_alone</span>,</span>
<span>    <span class="va">unbalanced_results</span><span class="op">$</span><span class="va">ss_coffee_alone</span>,</span>
<span>    <span class="va">unbalanced_results</span><span class="op">$</span><span class="va">ss_time_alone</span></span>
<span>  <span class="op">)</span>,</span>
<span>  check.names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">comparison_df</span>, digits <span class="op">=</span> <span class="fl">2</span>, </span>
<span>      caption <span class="op">=</span> <span class="st">"Sum of Squares When Each Factor is Tested First"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-sm small" data-quarto-postprocess="true">
<caption>Sum of Squares When Each Factor is Tested First</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Design</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Factor</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SS When Tested First</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Balanced</td>
<td style="text-align: left;">Coffee Type</td>
<td style="text-align: right;">21.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">Balanced</td>
<td style="text-align: left;">Time of Day</td>
<td style="text-align: right;">1.60</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Unbalanced</td>
<td style="text-align: left;">Coffee Type</td>
<td style="text-align: right;">9.21</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unbalanced</td>
<td style="text-align: left;">Time of Day</td>
<td style="text-align: right;">14.48</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why Does Order Matter in Unbalanced Designs?
</div>
</div>
<div class="callout-body-container callout-body">
<p>In unbalanced designs, the factors are <strong>correlated</strong>. When factors are correlated:</p>
<ol type="1">
<li>The effect of Coffee Type partially overlaps with the effect of Time</li>
<li>Testing Coffee first “claims” the overlapping variance</li>
<li>Testing Time first would claim that same overlapping variance differently</li>
<li>This is why Type I (sequential) ANOVA gives different results based on order</li>
</ol>
</div>
</div>
</section></section><section id="part-4-the-controversy---types-i-ii-and-iii-sum-of-squares" class="level1"><h1>Part 4: The Controversy - Types I, II, and III Sum of Squares</h1>
<section id="manual-calculation-tables-for-understanding" class="level2"><h2 class="anchored" data-anchor-id="manual-calculation-tables-for-understanding">Manual Calculation Tables for Understanding</h2>
<p>Let’s manually calculate the different types of sum of squares to truly understand what’s happening:</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Function to manually calculate all types of SS</span></span>
<span><span class="va">calculate_all_ss_types</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">show_details</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Prepare data</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="va">grand_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">satisfaction</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Get cell means and counts</span></span>
<span>  <span class="va">cell_summary</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">coffee_type</span>, <span class="va">time_of_day</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>      mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">satisfaction</span><span class="op">)</span>,</span>
<span>      n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      sum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">satisfaction</span><span class="op">)</span>,</span>
<span>      .groups <span class="op">=</span> <span class="st">'drop'</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Marginal means</span></span>
<span>  <span class="va">coffee_marginal</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">coffee_type</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>      mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">satisfaction</span><span class="op">)</span>,</span>
<span>      n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      .groups <span class="op">=</span> <span class="st">'drop'</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">time_marginal</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">time_of_day</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>      mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">satisfaction</span><span class="op">)</span>,</span>
<span>      n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      .groups <span class="op">=</span> <span class="st">'drop'</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">show_details</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Cell Means and Sample Sizes:"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">cell_summary</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Marginal Means - Coffee Type:"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">coffee_marginal</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Marginal Means - Time of Day:"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">time_marginal</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Grand Mean:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">grand_mean</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu">sep_line</span><span class="op">(</span><span class="st">"-"</span>, <span class="fl">40</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Calculate Type I SS (Sequential)</span></span>
<span>  <span class="co"># Order 1: Coffee -&gt; Time -&gt; Interaction</span></span>
<span>  </span>
<span>  <span class="co"># SS(Coffee | μ)</span></span>
<span>  <span class="va">ss_coffee_type1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">coffee_marginal</span><span class="op">$</span><span class="va">n</span> <span class="op">*</span> <span class="op">(</span><span class="va">coffee_marginal</span><span class="op">$</span><span class="va">mean</span> <span class="op">-</span> <span class="va">grand_mean</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># For SS(Time | μ, Coffee), we need residuals after fitting Coffee</span></span>
<span>  <span class="va">model_coffee_only</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">satisfaction</span> <span class="op">~</span> <span class="va">coffee_type</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span>  <span class="va">residuals_after_coffee</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">model_coffee_only</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Create pseudo-data with residuals</span></span>
<span>  <span class="va">pseudo_data_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    residuals <span class="op">=</span> <span class="va">residuals_after_coffee</span>,</span>
<span>    time_of_day <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">time_of_day</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">model_time_on_residuals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">residuals</span> <span class="op">~</span> <span class="va">time_of_day</span>, data <span class="op">=</span> <span class="va">pseudo_data_time</span><span class="op">)</span></span>
<span>  <span class="va">ss_time_type1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">model_time_on_residuals</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Calculate Type II SS (Marginal, no interaction)</span></span>
<span>  <span class="va">model_both_main</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">satisfaction</span> <span class="op">~</span> <span class="va">coffee_type</span> <span class="op">+</span> <span class="va">time_of_day</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span>  <span class="va">model_coffee_only</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">satisfaction</span> <span class="op">~</span> <span class="va">coffee_type</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span>  <span class="va">model_time_only</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">satisfaction</span> <span class="op">~</span> <span class="va">time_of_day</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">ss_coffee_type2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">model_both_main</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">model_time_only</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">ss_time_type2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">model_both_main</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">model_coffee_only</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Calculate Type III SS (Marginal, with interaction)</span></span>
<span>  <span class="co"># This requires more complex calculations with contrast coding</span></span>
<span>  </span>
<span>  <span class="co"># Create results table</span></span>
<span>  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    `Type` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Type I"</span>, <span class="st">"Type II"</span>, <span class="st">"Type III*"</span><span class="op">)</span>,</span>
<span>    `SS_Coffee` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ss_coffee_type1</span>, <span class="va">ss_coffee_type2</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    `SS_Time` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ss_time_type1</span>, <span class="va">ss_time_type2</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    check.names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Calculate for both designs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"BALANCED DESIGN:"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] "BALANCED DESIGN:"</code></pre>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">balanced_calc</span> <span class="op">&lt;-</span> <span class="fu">calculate_all_ss_types</span><span class="op">(</span><span class="va">balanced_coffee</span>, show_details <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] "Cell Means and Sample Sizes:"
# A tibble: 4 × 5
  coffee_type time_of_day  mean     n   sum
  &lt;fct&gt;       &lt;fct&gt;       &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
1 Regular     Morning      8.31    20  166.
2 Regular     Afternoon    5.74    20  115.
3 Decaf       Morning      5.00    20  100.
4 Decaf       Afternoon    7.01    20  140.
[1] ""
[1] "Marginal Means - Coffee Type:"
# A tibble: 2 × 3
  coffee_type  mean     n
  &lt;fct&gt;       &lt;dbl&gt; &lt;int&gt;
1 Regular      7.03    40
2 Decaf        6.00    40
[1] ""
[1] "Marginal Means - Time of Day:"
# A tibble: 2 × 3
  time_of_day  mean     n
  &lt;fct&gt;       &lt;dbl&gt; &lt;int&gt;
1 Morning      6.66    40
2 Afternoon    6.37    40
[1] ""
[1] "Grand Mean: 6.516"
---------------------------------------- </code></pre>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">balanced_calc</span>, digits <span class="op">=</span> <span class="fl">2</span>, </span>
<span>      caption <span class="op">=</span> <span class="st">"Manual SS Calculations - Balanced Design"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-sm small" data-quarto-postprocess="true">
<caption>Manual SS Calculations - Balanced Design</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SS_Coffee</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SS_Time</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Type I</td>
<td style="text-align: right;">21.03</td>
<td style="text-align: right;">1.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Type II</td>
<td style="text-align: right;">21.03</td>
<td style="text-align: right;">1.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Type III*</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] ""</code></pre>
</div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"UNBALANCED DESIGN:"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] "UNBALANCED DESIGN:"</code></pre>
</div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">unbalanced_calc</span> <span class="op">&lt;-</span> <span class="fu">calculate_all_ss_types</span><span class="op">(</span><span class="va">unbalanced_coffee</span>, show_details <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] "Cell Means and Sample Sizes:"
# A tibble: 4 × 5
  coffee_type time_of_day  mean     n   sum
  &lt;fct&gt;       &lt;fct&gt;       &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
1 Decaf       Afternoon    7.13    20 143. 
2 Decaf       Morning      4.94    10  49.4
3 Regular     Afternoon    5.92    25 148. 
4 Regular     Morning      8.07    30 242. 
[1] ""
[1] "Marginal Means - Coffee Type:"
# A tibble: 2 × 3
  coffee_type  mean     n
  &lt;fct&gt;       &lt;dbl&gt; &lt;int&gt;
1 Decaf        6.40    30
2 Regular      7.09    55
[1] ""
[1] "Marginal Means - Time of Day:"
# A tibble: 2 × 3
  time_of_day  mean     n
  &lt;fct&gt;       &lt;dbl&gt; &lt;int&gt;
1 Afternoon    6.46    45
2 Morning      7.29    40
[1] ""
[1] "Grand Mean: 6.849"
---------------------------------------- </code></pre>
</div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">unbalanced_calc</span>, digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Manual SS Calculations - Unbalanced Design"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-sm small" data-quarto-postprocess="true">
<caption>Manual SS Calculations - Unbalanced Design</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SS_Coffee</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SS_Time</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Type I</td>
<td style="text-align: right;">9.21</td>
<td style="text-align: right;">10.17</td>
</tr>
<tr class="even">
<td style="text-align: left;">Type II</td>
<td style="text-align: right;">5.34</td>
<td style="text-align: right;">10.61</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Type III*</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="type-i-sum-of-squares-sequential" class="level2"><h2 class="anchored" data-anchor-id="type-i-sum-of-squares-sequential">Type I Sum of Squares (Sequential)</h2>
<p><strong>Mathematical Definition:</strong></p>
<ul>
<li>
<span class="math inline">\(SS(\alpha | \mu)\)</span> = Sum of squares for A after fitting the mean</li>
<li>
<span class="math inline">\(SS(\beta | \mu, \alpha)\)</span> = Sum of squares for B after fitting mean and A</li>
<li>
<span class="math inline">\(SS(\alpha\beta | \mu, \alpha, \beta)\)</span> = Sum of squares for interaction after fitting everything else</li>
</ul>
<p><strong>Plain English:</strong> Type I asks “What does each factor explain that wasn’t already explained by factors entered before it?”</p>
</section><section id="example-when-type-i-makes-sense" class="level2 callout-info"><h2 class="anchored" data-anchor-id="example-when-type-i-makes-sense">Example: When Type I Makes Sense</h2>
<p><strong>Scenario: Educational Achievement Study</strong></p>
<p>Imagine studying factors affecting student test scores where we have a clear causal hierarchy:</p>
<ol type="1">
<li>
<strong>Socioeconomic Status (SES)</strong> - This is a background variable that exists before schooling</li>
<li>
<strong>School Quality</strong> - Students are assigned to schools based partly on where they live (related to SES)</li>
<li>
<strong>Teaching Method</strong> - Applied within schools</li>
</ol>
<p>Here, it makes sense to use Type I with SES entered first, then School Quality, then Teaching Method. We want to know:</p>
<ul>
<li>How much variance does SES explain?</li>
<li>How much <em>additional</em> variance does School Quality explain after accounting for SES?</li>
<li>How much <em>additional</em> variance does Teaching Method explain after accounting for both?</li>
</ul>
<p>This sequential approach respects the causal/temporal ordering of these factors.</p>
</section><div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Type I implementation with detailed output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"TYPE I - Sequential Sum of Squares"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] "TYPE I - Sequential Sum of Squares"</code></pre>
</div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">sep_line</span><span class="op">(</span><span class="st">"="</span>, <span class="fl">50</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>================================================== </code></pre>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model_type1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">satisfaction</span> <span class="op">~</span> <span class="va">coffee_type</span> <span class="op">+</span> <span class="va">time_of_day</span> <span class="op">+</span> <span class="va">coffee_type</span><span class="op">:</span><span class="va">time_of_day</span>, </span>
<span>                  data <span class="op">=</span> <span class="va">unbalanced_coffee</span><span class="op">)</span></span>
<span><span class="va">anova_type1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">model_type1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">anova_type1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Analysis of Variance Table

Response: satisfaction
                        Df Sum Sq Mean Sq F value    Pr(&gt;F)    
coffee_type              1  9.214   9.214  7.9036  0.006186 ** 
time_of_day              1 10.607  10.607  9.0985  0.003417 ** 
coffee_type:time_of_day  1 84.400  84.400 72.3995 7.439e-13 ***
Residuals               81 94.426   1.166                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<section id="what-does-each-row-mean" class="level2 callout-question"><h2 class="anchored" data-anchor-id="what-does-each-row-mean">What Does Each Row Mean?</h2>
<p>Click below to understand each row in the ANOVA table:</p>
<details><summary><strong>Click to see explanation</strong>
</summary><p><strong>Row 1 - coffee_type:</strong> This shows the sum of squares for coffee type when it’s the FIRST factor considered (after the intercept). It answers: “How much variance in satisfaction is explained by coffee type alone?”</p>
<p><strong>Row 2 - time_of_day:</strong> This shows the sum of squares for time of day AFTER removing the effect of coffee type. It answers: “How much additional variance is explained by time of day that wasn’t already explained by coffee type?”</p>
<p><strong>Row 3 - coffee_type:time_of_day:</strong> This is the interaction term. It answers: “Is the effect of coffee type different at different times of day?” A significant interaction means the effect of one factor depends on the level of the other.</p>
<p><strong>Row 4 - Residuals:</strong> This is the unexplained variance - the variation in satisfaction scores that can’t be explained by any of our factors. It represents individual differences and measurement error.</p>
<p><strong>Columns Explained:</strong></p>
<ul>
<li>
<strong>Df (Degrees of Freedom):</strong> Number of independent pieces of information. For factors: (number of levels - 1)</li>
<li>
<strong>Sum Sq:</strong> Total squared deviations explained by that factor</li>
<li>
<strong>Mean Sq:</strong> Sum Sq divided by Df (average squared deviation)</li>
<li>
<strong>F value:</strong> Ratio of factor’s Mean Sq to Residual Mean Sq (signal-to-noise ratio)</li>
<li>
<strong>Pr(&gt;F):</strong> p-value - probability of seeing this F-value or larger if null hypothesis is true</li>
</ul></details></section><section id="type-ii-sum-of-squares-hierarchical" class="level2"><h2 class="anchored" data-anchor-id="type-ii-sum-of-squares-hierarchical">Type II Sum of Squares (Hierarchical)</h2>
<p><strong>Mathematical Definition:</strong></p>
<ul>
<li>
<span class="math inline">\(SS(\alpha | \mu, \beta)\)</span> = Sum of squares for A after fitting mean and B</li>
<li>
<span class="math inline">\(SS(\beta | \mu, \alpha)\)</span> = Sum of squares for B after fitting mean and A</li>
<li>
<span class="math inline">\(SS(\alpha\beta | \mu, \alpha, \beta)\)</span> = Sum of squares for interaction after main effects</li>
</ul>
<p><strong>Plain English:</strong> Type II asks “What does each main effect explain that the other main effect doesn’t, ignoring interactions?”</p>
<p><strong>When to use:</strong> When you want to test main effects assuming no interaction (most common in practice)</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"TYPE II - Hierarchical Sum of Squares"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] "TYPE II - Hierarchical Sum of Squares"</code></pre>
</div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">sep_line</span><span class="op">(</span><span class="st">"="</span>, <span class="fl">50</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>================================================== </code></pre>
</div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="va">model_type1</span>, type <span class="op">=</span> <span class="st">"II"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Anova Table (Type II tests)

Response: satisfaction
                        Sum Sq Df F value    Pr(&gt;F)    
coffee_type              5.339  1  4.5802  0.035352 *  
time_of_day             10.607  1  9.0985  0.003417 ** 
coffee_type:time_of_day 84.400  1 72.3995 7.439e-13 ***
Residuals               94.426 81                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section><section id="what-does-each-row-mean-in-type-ii" class="level2 callout-question"><h2 class="anchored" data-anchor-id="what-does-each-row-mean-in-type-ii">What Does Each Row Mean in Type II?</h2>
<details><summary><strong>Click to see explanation</strong>
</summary><p><strong>Key Differences from Type I:</strong></p>
<p><strong>Row 1 - coffee_type:</strong> Now shows SS for coffee type AFTER adjusting for time_of_day (but NOT interaction). It answers: “What unique variance does coffee type explain that time doesn’t?”</p>
<p><strong>Row 2 - time_of_day:</strong> Shows SS for time AFTER adjusting for coffee_type (but NOT interaction). It answers: “What unique variance does time explain that coffee type doesn’t?”</p>
<p><strong>Row 3 - coffee_type:time_of_day:</strong> Same as Type I - interaction is always tested last.</p>
<p><strong>Why Type II is Often Preferred:</strong></p>
<ul>
<li>Tests each main effect controlling for other main effects</li>
<li>Order doesn’t matter (unlike Type I)</li>
<li>Assumes no interaction when testing main effects</li>
<li>More balanced approach for most research questions</li>
</ul></details></section><section id="type-iii-sum-of-squares-marginal" class="level2"><h2 class="anchored" data-anchor-id="type-iii-sum-of-squares-marginal">Type III Sum of Squares (Marginal)</h2>
<p><strong>Mathematical Definition:</strong></p>
<ul>
<li>
<span class="math inline">\(SS(\alpha | \mu, \beta, \alpha\beta)\)</span> = Sum of squares for A after fitting everything else</li>
<li>
<span class="math inline">\(SS(\beta | \mu, \alpha, \alpha\beta)\)</span> = Sum of squares for B after fitting everything else</li>
<li>
<span class="math inline">\(SS(\alpha\beta | \mu, \alpha, \beta)\)</span> = Sum of squares for interaction after main effects</li>
</ul>
<p><strong>Plain English:</strong> Type III asks “What does each effect explain that isn’t explained by any other effect, including interactions?”</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Type III implementation</span></span>
<span><span class="co"># IMPORTANT: Must use sum-to-zero contrasts for Type III</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html">contrasts</a></span><span class="op">(</span><span class="va">unbalanced_coffee</span><span class="op">$</span><span class="va">coffee_type</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/contrast.html">contr.sum</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html">contrasts</a></span><span class="op">(</span><span class="va">unbalanced_coffee</span><span class="op">$</span><span class="va">time_of_day</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/contrast.html">contr.sum</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_type3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">satisfaction</span> <span class="op">~</span> <span class="va">coffee_type</span> <span class="op">*</span> <span class="va">time_of_day</span>, data <span class="op">=</span> <span class="va">unbalanced_coffee</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"TYPE III - Marginal Sum of Squares"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] "TYPE III - Marginal Sum of Squares"</code></pre>
</div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">sep_line</span><span class="op">(</span><span class="st">"="</span>, <span class="fl">50</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>================================================== </code></pre>
</div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="va">model_type3</span>, type <span class="op">=</span> <span class="st">"III"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Anova Table (Type III tests)

Response: satisfaction
                         Sum Sq Df   F value    Pr(&gt;F)    
(Intercept)             3041.77  1 2609.2756 &lt; 2.2e-16 ***
coffee_type               16.40  1   14.0657 0.0003302 ***
time_of_day                0.01  1    0.0077 0.9302036    
coffee_type:time_of_day   84.40  1   72.3995 7.439e-13 ***
Residuals                 94.43 81                        
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section><section id="what-does-each-row-mean-in-type-iii" class="level2 callout-question"><h2 class="anchored" data-anchor-id="what-does-each-row-mean-in-type-iii">What Does Each Row Mean in Type III?</h2>
<details><summary><strong>Click to see explanation</strong>
</summary><p><strong>Type III Special Characteristics:</strong></p>
<p><strong>Row 1 - (Intercept):</strong> Type III includes the intercept test, which tests if the grand mean equals zero (usually not interesting).</p>
<p><strong>Row 2 - coffee_type:</strong> Tests coffee type AFTER adjusting for time AND interaction. Answers: “Is there a coffee type effect averaged across all times?”</p>
<p><strong>Row 3 - time_of_day:</strong> Tests time AFTER adjusting for coffee type AND interaction. Answers: “Is there a time effect averaged across all coffee types?”</p>
<p><strong>Row 4 - coffee_type:time_of_day:</strong> Same as other types - interaction effect.</p>
<p><strong>When Type III is Useful:</strong></p>
<ul>
<li>When interaction is significant</li>
<li>When you want the most conservative test</li>
<li>When following certain field conventions (e.g., some areas of psychology)</li>
<li>Tests “average” effects across all levels of other factors</li>
</ul></details></section></section><section id="part-5-why-all-three-types-give-the-same-answer-for-balanced-data" class="level1"><h1>Part 5: Why All Three Types Give the Same Answer for Balanced Data</h1>
<section id="the-magic-of-orthogonality" class="level2"><h2 class="anchored" data-anchor-id="the-magic-of-orthogonality">The Magic of Orthogonality</h2>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Demonstrate orthogonality in balanced vs unbalanced designs</span></span>
<span></span>
<span><span class="va">check_orthogonality</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">title</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Create design matrix</span></span>
<span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="va">coffee_type</span> <span class="op">*</span> <span class="va">time_of_day</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Calculate correlation matrix (excluding intercept)</span></span>
<span>  <span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Visualize</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">cor_matrix</span>, </span>
<span>           method <span class="op">=</span> <span class="st">"color"</span>, </span>
<span>           type <span class="op">=</span> <span class="st">"upper"</span>,</span>
<span>           tl.cex <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>           tl.col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>           title <span class="op">=</span> <span class="va">title</span>,</span>
<span>           mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>           addCoef.col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>           number.cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Check both designs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">balanced_cors</span> <span class="op">&lt;-</span> <span class="fu">check_orthogonality</span><span class="op">(</span><span class="va">balanced_coffee</span>, </span>
<span>                                     <span class="st">"Balanced Design\n(Orthogonal)"</span><span class="op">)</span></span>
<span><span class="va">unbalanced_cors</span> <span class="op">&lt;-</span> <span class="fu">check_orthogonality</span><span class="op">(</span><span class="va">unbalanced_coffee</span>, </span>
<span>                                       <span class="st">"Unbalanced Design\n(Non-orthogonal)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="stat_files/figure-html/why-balanced-same-1.png" class="img-fluid" width="3000"></p>
</div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why Balanced Designs Make All Types Equal
</div>
</div>
<div class="callout-body-container callout-body">
<p>In balanced designs, the design vectors are <strong>orthogonal</strong> (uncorrelated):</p>
<ol type="1">
<li>
<strong>Zero Correlation:</strong> The correlation between coffee_type and time_of_day is 0</li>
<li>
<strong>No Overlapping Variance:</strong> Each factor explains completely separate portions of variance</li>
<li>
<strong>Order Doesn’t Matter:</strong> Since factors don’t overlap, the sequence of testing is irrelevant</li>
<li>
<strong>Unique Contributions:</strong> Each factor’s contribution is unique and doesn’t depend on others</li>
</ol>
<p>This is why balanced designs are so desirable in experimental research!</p>
</div>
</div>
</section><section id="detailed-comparison-table" class="level2"><h2 class="anchored" data-anchor-id="detailed-comparison-table">Detailed Comparison Table</h2>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a comprehensive comparison</span></span>
<span><span class="va">compare_ss_types</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">design_name</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Type I (two orders)</span></span>
<span>  <span class="va">model_i_order1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">satisfaction</span> <span class="op">~</span> <span class="va">coffee_type</span> <span class="op">+</span> <span class="va">time_of_day</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span>  <span class="va">model_i_order2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">satisfaction</span> <span class="op">~</span> <span class="va">time_of_day</span> <span class="op">+</span> <span class="va">coffee_type</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">type_i_order1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">model_i_order1</span><span class="op">)</span></span>
<span>  <span class="va">type_i_order2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">model_i_order2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Type II</span></span>
<span>  <span class="va">type_ii</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="va">model_i_order1</span>, type <span class="op">=</span> <span class="st">"II"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Type III (with proper contrasts)</span></span>
<span>  <span class="va">data_copy</span> <span class="op">&lt;-</span> <span class="va">data</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html">contrasts</a></span><span class="op">(</span><span class="va">data_copy</span><span class="op">$</span><span class="va">coffee_type</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/contrast.html">contr.sum</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html">contrasts</a></span><span class="op">(</span><span class="va">data_copy</span><span class="op">$</span><span class="va">time_of_day</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/contrast.html">contr.sum</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">model_iii</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">satisfaction</span> <span class="op">~</span> <span class="va">coffee_type</span> <span class="op">+</span> <span class="va">time_of_day</span>, data <span class="op">=</span> <span class="va">data_copy</span><span class="op">)</span></span>
<span>  <span class="va">type_iii</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="va">model_iii</span>, type <span class="op">=</span> <span class="st">"III"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Create comparison table</span></span>
<span>  <span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    Design <span class="op">=</span> <span class="va">design_name</span>,</span>
<span>    Type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"I (Coffee→Time)"</span>, <span class="st">"I (Time→Coffee)"</span>, <span class="st">"II"</span>, <span class="st">"III"</span><span class="op">)</span>,</span>
<span>    Coffee_SS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="va">type_i_order1</span><span class="op">$</span><span class="va">`Sum Sq`</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>      <span class="va">type_i_order2</span><span class="op">$</span><span class="va">`Sum Sq`</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>      <span class="va">type_ii</span><span class="op">$</span><span class="va">`Sum Sq`</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>      <span class="va">type_iii</span><span class="op">$</span><span class="va">`Sum Sq`</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>    <span class="op">)</span>,</span>
<span>    Time_SS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="va">type_i_order1</span><span class="op">$</span><span class="va">`Sum Sq`</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>      <span class="va">type_i_order2</span><span class="op">$</span><span class="va">`Sum Sq`</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>      <span class="va">type_ii</span><span class="op">$</span><span class="va">`Sum Sq`</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>      <span class="va">type_iii</span><span class="op">$</span><span class="va">`Sum Sq`</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Compare both designs</span></span>
<span><span class="va">balanced_comparison</span> <span class="op">&lt;-</span> <span class="fu">compare_ss_types</span><span class="op">(</span><span class="va">balanced_coffee</span>, <span class="st">"Balanced"</span><span class="op">)</span></span>
<span><span class="va">unbalanced_comparison</span> <span class="op">&lt;-</span> <span class="fu">compare_ss_types</span><span class="op">(</span><span class="va">unbalanced_coffee</span>, <span class="st">"Unbalanced"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">full_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">balanced_comparison</span>, <span class="va">unbalanced_comparison</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">full_comparison</span>, digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Sum of Squares Comparison: All Types, Both Designs"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/group_rows.html">pack_rows</a></span><span class="op">(</span><span class="st">"Balanced Design"</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/group_rows.html">pack_rows</a></span><span class="op">(</span><span class="st">"Unbalanced Design"</span>, <span class="fl">5</span>, <span class="fl">8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-sm small" data-quarto-postprocess="true">
<caption>Sum of Squares Comparison: All Types, Both Designs</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Design</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Coffee_SS</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Time_SS</th>
</tr></thead>
<tbody>
<tr class="odd" data-grouplength="4">
<td colspan="4" style="border-bottom: 1px solid"><strong>Balanced Design</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Balanced</td>
<td style="text-align: left;">I (Coffee→Time)</td>
<td style="text-align: right;">21.03</td>
<td style="text-align: right;">1.60</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Balanced</td>
<td style="text-align: left;">I (Time→Coffee)</td>
<td style="text-align: right;">21.03</td>
<td style="text-align: right;">1.60</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Balanced</td>
<td style="text-align: left;">II</td>
<td style="text-align: right;">21.03</td>
<td style="text-align: right;">1.60</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Balanced</td>
<td style="text-align: left;">III</td>
<td style="text-align: right;">21.03</td>
<td style="text-align: right;">1.60</td>
</tr>
<tr class="even" data-grouplength="4">
<td colspan="4" style="border-bottom: 1px solid"><strong>Unbalanced Design</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Unbalanced</td>
<td style="text-align: left;">I (Coffee→Time)</td>
<td style="text-align: right;">9.21</td>
<td style="text-align: right;">10.61</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Unbalanced</td>
<td style="text-align: left;">I (Time→Coffee)</td>
<td style="text-align: right;">5.34</td>
<td style="text-align: right;">14.48</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Unbalanced</td>
<td style="text-align: left;">II</td>
<td style="text-align: right;">5.34</td>
<td style="text-align: right;">10.61</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Unbalanced</td>
<td style="text-align: left;">III</td>
<td style="text-align: right;">5.34</td>
<td style="text-align: right;">10.61</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section><section id="part-6-variance-heterogeneity-unequal-variances" class="level1"><h1>Part 6: Variance Heterogeneity (Unequal Variances)</h1>
<section id="creating-data-with-unequal-variances" class="level2"><h2 class="anchored" data-anchor-id="creating-data-with-unequal-variances">Creating Data with Unequal Variances</h2>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create data with very different variances</span></span>
<span><span class="va">hetero_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    group <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>    value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">50</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>  <span class="co"># Small variance</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    group <span class="op">=</span> <span class="st">"B"</span>, </span>
<span>    value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">52</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>  <span class="co"># Medium variance</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    group <span class="op">=</span> <span class="st">"C"</span>,</span>
<span>    value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">54</span>, sd <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="co"># Large variance</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate actual variances</span></span>
<span><span class="va">variance_summary</span> <span class="op">&lt;-</span> <span class="va">hetero_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    Mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>,</span>
<span>    Variance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>,</span>
<span>    SD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">'drop'</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">variance_summary</span>, digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Group Statistics with Heterogeneous Variances"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-sm small" data-quarto-postprocess="true">
<caption>Group Statistics with Heterogeneous Variances</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">group</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Variance</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: right;">49.91</td>
<td style="text-align: right;">3.85</td>
<td style="text-align: right;">1.96</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: right;">53.43</td>
<td style="text-align: right;">44.64</td>
<td style="text-align: right;">6.68</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C</td>
<td style="text-align: right;">54.37</td>
<td style="text-align: right;">170.22</td>
<td style="text-align: right;">13.05</td>
<td style="text-align: right;">30</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Visualize the different variances</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">hetero_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Heterogeneous Variances"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Notice the very different spreads"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">hetero_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Density Plot"</span>, </span>
<span>       subtitle <span class="op">=</span> <span class="st">"Different widths = different variances"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="stat_files/figure-html/variance-heterogeneity-1.png" class="img-fluid" width="3000"></p>
</div>
</div>
</section><section id="testing-for-homogeneity-of-variance" class="level2"><h2 class="anchored" data-anchor-id="testing-for-homogeneity-of-variance">Testing for Homogeneity of Variance</h2>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Testing for Equal Variances:"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] "Testing for Equal Variances:"</code></pre>
</div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">sep_line</span><span class="op">(</span><span class="st">"="</span>, <span class="fl">50</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>================================================== </code></pre>
</div>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Levene's Test (robust to non-normality):"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] "Levene's Test (robust to non-normality):"</code></pre>
</div>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">levene_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/leveneTest.html">leveneTest</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">hetero_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">levene_test</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value  Pr(&gt;F)    
group  2   19.13 1.3e-07 ***
      87                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] ""</code></pre>
</div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Bartlett's Test (sensitive to non-normality):"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] "Bartlett's Test (sensitive to non-normality):"</code></pre>
</div>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bartlett_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">hetero_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">bartlett_test</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>
    Bartlett test of homogeneity of variances

data:  value by group
Bartlett's K-squared = 73.797, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Interpreting Variance Tests
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Levene’s Test:</strong> p &lt; 0.05 indicates unequal variances (assumption violated)<br><strong>Bartlett’s Test:</strong> More powerful but sensitive to non-normality</p>
<p><strong>What to do with unequal variances:</strong></p>
<ol type="1">
<li>Use Welch’s ANOVA instead of standard ANOVA</li>
<li>Use Games-Howell post-hoc test instead of Tukey</li>
<li>Consider transforming data (log, square root)</li>
<li>Use robust methods or non-parametric alternatives</li>
</ol>
</div>
</div>
</section><section id="consequences-of-ignoring-unequal-variances" class="level2"><h2 class="anchored" data-anchor-id="consequences-of-ignoring-unequal-variances">Consequences of Ignoring Unequal Variances</h2>
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Standard ANOVA (assumes equal variances)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Standard ANOVA (assumes equal variances):"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] "Standard ANOVA (assumes equal variances):"</code></pre>
</div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">standard_anova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">hetero_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">standard_anova</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)
group        2    332   165.9   2.275  0.109
Residuals   87   6343    72.9               </code></pre>
</div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] ""</code></pre>
</div>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Welch's ANOVA (robust to unequal variances):"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] "Welch's ANOVA (robust to unequal variances):"</code></pre>
</div>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">welch_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/oneway.test.html">oneway.test</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">hetero_data</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">welch_test</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>
    One-way analysis of means (not assuming equal variances)

data:  value and group
F = 5.2616, num df = 2.000, denom df = 42.497, p-value = 0.009086</code></pre>
</div>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compare p-values</span></span>
<span><span class="va">comparison_pvalues</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Standard ANOVA"</span>, <span class="st">"Welch's ANOVA"</span><span class="op">)</span>,</span>
<span>  `Assumes Equal Variances` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Yes"</span>, <span class="st">"No"</span><span class="op">)</span>,</span>
<span>  `p-value` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">standard_anova</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">`Pr(&gt;F)`</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">welch_test</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span>,</span>
<span>  Decision <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">standard_anova</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">`Pr(&gt;F)`</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Reject H0"</span>, <span class="st">"Fail to reject H0"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">welch_test</span><span class="op">$</span><span class="va">p.value</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Reject H0"</span>, <span class="st">"Fail to reject H0"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  check.names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">comparison_pvalues</span>, digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Comparison: Standard vs Welch's ANOVA with Unequal Variances"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-sm small" data-quarto-postprocess="true">
<caption>Comparison: Standard vs Welch's ANOVA with Unequal Variances</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Assumes Equal Variances</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p-value</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Decision</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Standard ANOVA</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">0.1088</td>
<td style="text-align: left;">Fail to reject H0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Welch's ANOVA</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">0.0091</td>
<td style="text-align: left;">Reject H0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section><section id="part-7-complete-analysis-pipeline" class="level1"><h1>Part 7: Complete Analysis Pipeline</h1>
<section id="step-by-step-analysis-function" class="level2"><h2 class="anchored" data-anchor-id="step-by-step-analysis-function">Step-by-Step Analysis Function</h2>
<div class="cell">
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">analyze_data_complete</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">dv</span>, <span class="va">factors</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">formula_str</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">dv</span>, <span class="st">"~"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">factors</span>, collapse <span class="op">=</span> <span class="st">" * "</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">formula_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="va">formula_str</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">sep_line</span><span class="op">(</span><span class="st">"="</span>, <span class="fl">60</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"COMPLETE ANOVA ANALYSIS PIPELINE"</span><span class="op">)</span></span>
<span>  <span class="fu">sep_line</span><span class="op">(</span><span class="st">"="</span>, <span class="fl">60</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># 1. Check balance</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"STEP 1: CHECKING BALANCE"</span><span class="op">)</span></span>
<span>  <span class="fu">sep_line</span><span class="op">(</span><span class="st">"-"</span>, <span class="fl">40</span><span class="op">)</span></span>
<span>  <span class="va">design_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="va">factors</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, <span class="va">data</span><span class="op">[[</span><span class="va">factors</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">design_table</span><span class="op">)</span></span>
<span>  <span class="va">is_balanced</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">design_table</span> <span class="op">==</span> <span class="va">design_table</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Design is"</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">is_balanced</span>, <span class="st">"BALANCED ✓"</span>, <span class="st">"UNBALANCED ⚠️"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># 2. Fit model</span></span>
<span>  <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">formula_obj</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span>  <span class="va">anova_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># 3. Check assumptions</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"STEP 2: CHECKING ASSUMPTIONS"</span><span class="op">)</span></span>
<span>  <span class="fu">sep_line</span><span class="op">(</span><span class="st">"-"</span>, <span class="fl">40</span><span class="op">)</span></span>
<span>  <span class="co"># Normality of residuals</span></span>
<span>  <span class="va">shapiro_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Shapiro-Wilk test p ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="va">shapiro_p</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co"># Homogeneity of variances</span></span>
<span>  <span class="va">levene_p</span> <span class="op">&lt;-</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/leveneTest.html">leveneTest</a></span><span class="op">(</span><span class="va">formula_obj</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span><span class="op">$</span><span class="va">`Pr(&gt;F)`</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Levene’s test p ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="va">levene_p</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># 4. Effect sizes (eta squared)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"STEP 3: EFFECT SIZE (η²)"</span><span class="op">)</span></span>
<span>  <span class="fu">sep_line</span><span class="op">(</span><span class="st">"-"</span>, <span class="fl">40</span><span class="op">)</span></span>
<span>  <span class="va">ss_total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">anova_table</span><span class="op">[[</span><span class="st">"Sum Sq"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">ss_effects</span> <span class="op">&lt;-</span> <span class="va">anova_table</span><span class="op">[[</span><span class="st">"Sum Sq"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">factors</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">eta_squared</span> <span class="op">&lt;-</span> <span class="va">ss_effects</span> <span class="op">/</span> <span class="va">ss_total</span></span>
<span>  </span>
<span>  <span class="va">effect_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">anova_table</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">factors</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">eta_squared</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">result_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%s: η² = %.3f "</span>, <span class="va">effect_names</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">eta_squared</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">eta_squared</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">0.01</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">result_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">result_text</span>, <span class="st">"(negligible)"</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">eta_squared</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">0.06</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">result_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">result_text</span>, <span class="st">"(small)"</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">eta_squared</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">0.14</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">result_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">result_text</span>, <span class="st">"(medium)"</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">result_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">result_text</span>, <span class="st">"(large)"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">result_text</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># 5. Post-hoc tests</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"STEP 5: POST-HOC COMPARISONS"</span><span class="op">)</span></span>
<span>  <span class="fu">sep_line</span><span class="op">(</span><span class="st">"-"</span>, <span class="fl">40</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">levene_p</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Using Games-Howell (unequal variances)"</span><span class="op">)</span></span>
<span>    <span class="co"># Implement Games-Howell here if needed</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Using Tukey HSD (equal variances)"</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">is_balanced</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Run the pipeline on unbalanced_coffee</span></span>
<span><span class="va">final_model</span> <span class="op">&lt;-</span> <span class="fu">analyze_data_complete</span><span class="op">(</span></span>
<span>  <span class="va">unbalanced_coffee</span>,</span>
<span>  <span class="st">"satisfaction"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"coffee_type"</span>, <span class="st">"time_of_day"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>============================================================ 
[1] "COMPLETE ANOVA ANALYSIS PIPELINE"
============================================================ 
[1] ""
[1] "STEP 1: CHECKING BALANCE"
---------------------------------------- 
         
          Afternoon Morning
  Decaf          20      10
  Regular        25      30
[1] "Design is UNBALANCED ⚠️"
[1] ""
[1] "STEP 2: CHECKING ASSUMPTIONS"
---------------------------------------- 
[1] "Shapiro-Wilk test p = 0.15"
[1] "Levene’s test p = 0.581"
[1] ""
[1] "STEP 3: EFFECT SIZE (η²)"
---------------------------------------- 
[1] "coffee_type: η² = 0.046 (small)"
[1] "time_of_day: η² = 0.053 (small)"
[1] "coffee_type:time_of_day: η² = 0.425 (large)"
[1] ""
[1] "STEP 5: POST-HOC COMPARISONS"
---------------------------------------- 
[1] "Using Tukey HSD (equal variances)"</code></pre>
</div>
</div>
</section></section><section id="part-8-practical-decision-tree" class="level1"><h1>Part 8: Practical Decision Tree</h1>
<section id="when-to-use-which-type" class="level2"><h2 class="anchored" data-anchor-id="when-to-use-which-type">When to Use Which Type?</h2>
<div class="cell">
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a decision guide</span></span>
<span><span class="va">decision_guide</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Scenario <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Balanced design"</span>,</span>
<span>    <span class="st">"Unbalanced + No interaction"</span>,</span>
<span>    <span class="st">"Unbalanced + Significant interaction"</span>,</span>
<span>    <span class="st">"Natural hierarchy of factors"</span>,</span>
<span>    <span class="st">"Exploratory analysis"</span>,</span>
<span>    <span class="st">"Following field conventions"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  `Recommended Type` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Any (all equal)"</span>,</span>
<span>    <span class="st">"Type II"</span>,</span>
<span>    <span class="st">"Type III"</span>,</span>
<span>    <span class="st">"Type I"</span>,</span>
<span>    <span class="st">"Type III"</span>,</span>
<span>    <span class="st">"Check literature"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  Reasoning <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"All types give identical results with balanced data"</span>,</span>
<span>    <span class="st">"Type II tests main effects properly without interaction assumption"</span>,</span>
<span>    <span class="st">"Type III tests main effects in presence of interaction"</span>,</span>
<span>    <span class="st">"Type I respects the causal/temporal order"</span>,</span>
<span>    <span class="st">"Type III is most conservative"</span>,</span>
<span>    <span class="st">"Some fields have established preferences"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  check.names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">decision_guide</span>, </span>
<span>      caption <span class="op">=</span> <span class="st">"Decision Guide for Choosing ANOVA Type"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-sm small" data-quarto-postprocess="true">
<caption>Decision Guide for Choosing ANOVA Type</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Scenario</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Recommended Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Reasoning</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Balanced design</td>
<td style="text-align: left;">Any (all equal)</td>
<td style="text-align: left;">All types give identical results with balanced data</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unbalanced + No interaction</td>
<td style="text-align: left;">Type II</td>
<td style="text-align: left;">Type II tests main effects properly without interaction assumption</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Unbalanced + Significant interaction</td>
<td style="text-align: left;">Type III</td>
<td style="text-align: left;">Type III tests main effects in presence of interaction</td>
</tr>
<tr class="even">
<td style="text-align: left;">Natural hierarchy of factors</td>
<td style="text-align: left;">Type I</td>
<td style="text-align: left;">Type I respects the causal/temporal order</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Exploratory analysis</td>
<td style="text-align: left;">Type III</td>
<td style="text-align: left;">Type III is most conservative</td>
</tr>
<tr class="even">
<td style="text-align: left;">Following field conventions</td>
<td style="text-align: left;">Check literature</td>
<td style="text-align: left;">Some fields have established preferences</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section><section id="part-9-quick-reference-functions" class="level1"><h1>Part 9: Quick Reference Functions</h1>
<section id="comparison-function-for-all-three-types" class="level2"><h2 class="anchored" data-anchor-id="comparison-function-for-all-three-types">Comparison Function for All Three Types</h2>
<div class="cell">
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Quick function to compare all three types</span></span>
<span><span class="va">compare_anova_types</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">verbose</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Ensure factors</span></span>
<span>  <span class="va">factors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/allnames.html">all.vars</a></span><span class="op">(</span><span class="va">formula</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">f</span> <span class="kw">in</span> <span class="va">factors</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">f</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">data</span><span class="op">[[</span><span class="va">f</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="va">f</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Check balance</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">factors</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">design_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="va">factors</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, <span class="va">data</span><span class="op">[[</span><span class="va">factors</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">is_balanced</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">design_table</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">is_balanced</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Type I</span></span>
<span>  <span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Type II</span></span>
<span>  <span class="va">model2</span> <span class="op">&lt;-</span> <span class="va">model1</span></span>
<span>  </span>
<span>  <span class="co"># Type III (need sum contrasts)</span></span>
<span>  <span class="va">data_type3</span> <span class="op">&lt;-</span> <span class="va">data</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">f</span> <span class="kw">in</span> <span class="va">factors</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">f</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">data_type3</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html">contrasts</a></span><span class="op">(</span><span class="va">data_type3</span><span class="op">[[</span><span class="va">f</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/contrast.html">contr.sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html">nlevels</a></span><span class="op">(</span><span class="va">data_type3</span><span class="op">[[</span><span class="va">f</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">model3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">data_type3</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Store results</span></span>
<span>  <span class="va">type1_anova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">model1</span><span class="op">)</span></span>
<span>  <span class="va">type2_anova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="va">model2</span>, type <span class="op">=</span> <span class="st">"II"</span><span class="op">)</span></span>
<span>  <span class="va">type3_anova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="va">model3</span>, type <span class="op">=</span> <span class="st">"III"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">verbose</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"========== TYPE I (Sequential) =========="</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">type1_anova</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"========== TYPE II (No Interaction) =========="</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">type2_anova</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"========== TYPE III (Marginal) =========="</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">type3_anova</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"========== RECOMMENDATION =========="</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">is_balanced</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"✓ Balanced design detected - all types equivalent"</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"→ Use Type I for computational efficiency"</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"⚠️ Unbalanced design detected"</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="co"># Check for interaction</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">factors</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="co"># Get interaction p-value</span></span>
<span>        <span class="va">interaction_term</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">factors</span>, collapse <span class="op">=</span> <span class="st">":"</span><span class="op">)</span></span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="va">interaction_term</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">type2_anova</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="va">interaction_p</span> <span class="op">&lt;-</span> <span class="va">type2_anova</span><span class="op">[</span><span class="va">interaction_term</span>, <span class="st">"Pr(&gt;F)"</span><span class="op">]</span></span>
<span>          <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">interaction_p</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="va">interaction_p</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"→ Significant interaction (p ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">interaction_p</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"→ RECOMMEND: Type III for main effects interpretation"</span><span class="op">)</span></span>
<span>          <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"→ No significant interaction"</span><span class="op">)</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"→ RECOMMEND: Type II for main effects testing"</span><span class="op">)</span></span>
<span>          <span class="op">}</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Return results as a list</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    type1 <span class="op">=</span> <span class="va">type1_anova</span>,</span>
<span>    type2 <span class="op">=</span> <span class="va">type2_anova</span>, </span>
<span>    type3 <span class="op">=</span> <span class="va">type3_anova</span>,</span>
<span>    balanced <span class="op">=</span> <span class="va">is_balanced</span></span>
<span>  <span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Test the function</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Testing the comparison function with our coffee data:"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] "Testing the comparison function with our coffee data:"</code></pre>
</div>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">compare_anova_types</span><span class="op">(</span><span class="va">satisfaction</span> <span class="op">~</span> <span class="va">coffee_type</span> <span class="op">*</span> <span class="va">time_of_day</span>, </span>
<span>                              <span class="va">unbalanced_coffee</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] "========== TYPE I (Sequential) =========="
Analysis of Variance Table

Response: satisfaction
                        Df Sum Sq Mean Sq F value    Pr(&gt;F)    
coffee_type              1  9.214   9.214  7.9036  0.006186 ** 
time_of_day              1 10.607  10.607  9.0985  0.003417 ** 
coffee_type:time_of_day  1 84.400  84.400 72.3995 7.439e-13 ***
Residuals               81 94.426   1.166                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
[1] ""
[1] "========== TYPE II (No Interaction) =========="
Anova Table (Type II tests)

Response: satisfaction
                        Sum Sq Df F value    Pr(&gt;F)    
coffee_type              5.339  1  4.5802  0.035352 *  
time_of_day             10.607  1  9.0985  0.003417 ** 
coffee_type:time_of_day 84.400  1 72.3995 7.439e-13 ***
Residuals               94.426 81                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
[1] ""
[1] "========== TYPE III (Marginal) =========="
Anova Table (Type III tests)

Response: satisfaction
                         Sum Sq Df   F value    Pr(&gt;F)    
(Intercept)             3041.77  1 2609.2756 &lt; 2.2e-16 ***
coffee_type               16.40  1   14.0657 0.0003302 ***
time_of_day                0.01  1    0.0077 0.9302036    
coffee_type:time_of_day   84.40  1   72.3995 7.439e-13 ***
Residuals                 94.43 81                        
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
[1] ""
[1] "========== RECOMMENDATION =========="
[1] "⚠️ Unbalanced design detected"
[1] "→ Significant interaction (p = 0 )"
[1] "→ RECOMMEND: Type III for main effects interpretation"</code></pre>
</div>
</div>
</section></section><section id="part-10-summary-and-key-takeaways" class="level1"><h1>Part 10: Summary and Key Takeaways</h1>
<section id="the-essential-points" class="level2"><h2 class="anchored" data-anchor-id="the-essential-points">The Essential Points</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Takeaways
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>1. ANOVA Types exist because of unbalanced designs</strong></p>
<ul>
<li>Balanced designs: All types give same results</li>
<li>Unbalanced designs: Results differ, choice matters</li>
</ul>
<p><strong>2. Type I (Sequential)</strong></p>
<ul>
<li>Tests each factor after those before it</li>
<li>Order matters!</li>
<li>Use when: You have a natural hierarchy</li>
</ul>
<p><strong>3. Type II (Hierarchical)</strong></p>
<ul>
<li>Tests main effects adjusting for other main effects</li>
<li>Assumes no interaction</li>
<li>Use when: Testing main effects, interaction not significant</li>
</ul>
<p><strong>4. Type III (Marginal)</strong></p>
<ul>
<li>Tests each effect adjusting for all others</li>
<li>Most conservative</li>
<li>Use when: Interaction is significant</li>
</ul>
<p><strong>5. Practical Advice</strong></p>
<ul>
<li>Always check assumptions first</li>
<li>Report which type you used and why</li>
<li>Consider effect sizes, not just p-values</li>
<li>Be transparent about unbalanced designs</li>
</ul>
</div>
</div>
</section><section id="mathematical-summary" class="level2"><h2 class="anchored" data-anchor-id="mathematical-summary">Mathematical Summary</h2>
<p>The fundamental difference is in the hypotheses being tested:</p>
<ul>
<li><p><strong>Type I (Sequential):</strong><br><span class="math inline">\(H_0: \alpha_i = 0 \;|\; \mu\)</span></p></li>
<li><p><strong>Type II (No interaction):</strong><br><span class="math inline">\(H_0: \alpha_i = 0 \;|\; \mu, \beta_j\)</span></p></li>
<li><p><strong>Type III (Marginal):</strong><br><span class="math inline">\(H_0: \alpha_i = 0 \;|\; \mu, \beta_j, (\alpha\beta)_{ij}\)</span></p></li>
</ul>
<p>Here, the vertical bar “<span class="math inline">\(\;|\;\)</span>” means “given that we’ve already accounted for …”.</p>
<p>Visual Summary of Differences</p>
<div class="cell">
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a visual summary of when each type "claims" variance</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create conceptual data for visualization</span></span>
<span><span class="va">variance_allocation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Type I"</span>, <span class="st">"Type II"</span>, <span class="st">"Type III"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  Component <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Coffee Unique"</span>, <span class="st">"Shared"</span>, <span class="st">"Time Unique"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  Allocation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="co"># Type I: Coffee gets unique + shared</span></span>
<span>    <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">0</span>,  <span class="co"># Coffee tested first gets all shared</span></span>
<span>    <span class="co"># Type II: Each gets only unique</span></span>
<span>    <span class="fl">100</span>, <span class="fl">50</span>, <span class="fl">100</span>,  <span class="co"># Shared split conceptually</span></span>
<span>    <span class="co"># Type III: Most conservative</span></span>
<span>    <span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">100</span>   <span class="co"># Neither gets shared</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">variance_allocation</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Component</span>, y <span class="op">=</span> <span class="va">Allocation</span>, fill <span class="op">=</span> <span class="va">Type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Conceptual Variance Allocation by ANOVA Type"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"How each type 'claims' variance in unbalanced designs"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Variance Allocated (%)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Variance Component"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set2"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="stat_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="3000"></p>
</div>
</div>
<p>Final Recommendations Table</p>
<div class="cell">
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">final_recommendations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  `Research Question` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Do factors A and B affect the outcome?"</span>,</span>
<span>    <span class="st">"What is the unique contribution of A?"</span>,</span>
<span>    <span class="st">"Does A matter after controlling for everything?"</span>,</span>
<span>    <span class="st">"Following a causal chain A→B→C"</span>,</span>
<span>    <span class="st">"Interaction is significant"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  `Best Type` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Type II"</span>,</span>
<span>    <span class="st">"Type II"</span>,</span>
<span>    <span class="st">"Type III"</span>,</span>
<span>    <span class="st">"Type I"</span>,</span>
<span>    <span class="st">"Type III"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  `Why` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Tests main effects properly without assuming interaction"</span>,</span>
<span>    <span class="st">"Type II isolates unique variance of each factor"</span>,</span>
<span>    <span class="st">"Type III is most conservative, controls for all"</span>,</span>
<span>    <span class="st">"Type I respects the sequential nature"</span>,</span>
<span>    <span class="st">"Type III tests main effects in presence of interaction"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  check.names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">final_recommendations</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Final Recommendations for ANOVA Type Selection"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed table-sm small" data-quarto-postprocess="true">
<caption>Final Recommendations for ANOVA Type Selection</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Research Question</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Best Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Why</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Do factors A and B affect the outcome?</td>
<td style="text-align: left;">Type II</td>
<td style="text-align: left;">Tests main effects properly without assuming interaction</td>
</tr>
<tr class="even">
<td style="text-align: left;">What is the unique contribution of A?</td>
<td style="text-align: left;">Type II</td>
<td style="text-align: left;">Type II isolates unique variance of each factor</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Does A matter after controlling for everything?</td>
<td style="text-align: left;">Type III</td>
<td style="text-align: left;">Type III is most conservative, controls for all</td>
</tr>
<tr class="even">
<td style="text-align: left;">Following a causal chain A→B→C</td>
<td style="text-align: left;">Type I</td>
<td style="text-align: left;">Type I respects the sequential nature</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Interaction is significant</td>
<td style="text-align: left;">Type III</td>
<td style="text-align: left;">Type III tests main effects in presence of interaction</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Remember this Above All</strong></p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Golden Rule of ANOVA Types
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>If your design is balanced, rejoice!</strong> All types give the same answer.</p>
<p><strong>If your design is unbalanced:</strong></p>
<ul>
<li><ol type="1">
<li>Check if interaction is significant</li>
</ol></li>
<li><ol start="2" type="1">
<li>If NO interaction → Use Type II</li>
</ol></li>
<li><ol start="3" type="1">
<li>If YES interaction → Use Type III</li>
</ol></li>
<li><ol start="4" type="1">
<li>If natural hierarchy → Consider Type I</li>
</ol></li>
</ul>
<p><strong>Always report:</strong> Which type you used and why!</p>
</div>
</div>
</section><section id="appendix-r-package-requirements" class="level2"><h2 class="anchored" data-anchor-id="appendix-r-package-requirements">Appendix: R Package Requirements</h2>
<div class="cell">
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Required packages for this tutorial</span></span>
<span><span class="va">required_packages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"tidyverse"</span>,     <span class="co"># Data manipulation and visualization</span></span>
<span>  <span class="st">"car"</span>,           <span class="co"># For Type II and III ANOVA</span></span>
<span>  <span class="st">"emmeans"</span>,       <span class="co"># Estimated marginal means</span></span>
<span>  <span class="st">"knitr"</span>,         <span class="co"># For tables</span></span>
<span>  <span class="st">"kableExtra"</span>,    <span class="co"># Enhanced tables</span></span>
<span>  <span class="st">"patchwork"</span>,     <span class="co"># Combining plots</span></span>
<span>  <span class="st">"corrplot"</span>,      <span class="co"># Correlation plots</span></span>
<span>  <span class="st">"rstatix"</span>        <span class="co"># Additional statistical tests</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install if needed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="va">required_packages</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<!-- -->

</section></section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{rasheduzzaman2025,
  author = {Md Rasheduzzaman},
  title = {Statistics {Basics}},
  date = {2025-09-23},
  langid = {en},
  abstract = {Statistical tests, Statistics, Statistic, CLT, etc.}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-rasheduzzaman2025" class="csl-entry quarto-appendix-citeas" role="listitem">
Md Rasheduzzaman. 2025. <span>“Statistics Basics.”</span> September 23,
2025.
</div></div></section></div></main><!-- /main --><hr>
<div style="margin-top: 2em;">
  <p style="font-weight: 500; font-size: 1.1em;">
    💬 Have thoughts or questions? Join the discussion below using your GitHub account!
  </p>
  <p style="font-size: 0.95em; color: #666;">
    You can <strong>edit or delete</strong> your own comments. Reactions like 👍 ❤️ 🚀 are also supported.
  </p>
</div>

<div id="giscus_thread" style="margin-top: 1.5em;"></div>

<script src="https://giscus.app/client.js" data-repo="MdRasheduz-zaman/PythRaSh" data-repo-id="R_kgDOOZN9Xw" data-category-id="DIC_kwDOOZN9X84CpE6N" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="en" data-loading="lazy" crossorigin="anonymous" async="">
</script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb83" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Statistics Basics"</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="an">abstract:</span><span class="co"> "Statistical tests, Statistics, Statistic, CLT, etc."</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"src/helpersrc.R"</span>))</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup}</span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">message =</span> <span class="cn">FALSE</span>, <span class="at">fig.width =</span> <span class="dv">10</span>, <span class="at">fig.height =</span> <span class="dv">6</span>)</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function for separators</span></span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a>sep_line <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">char =</span> <span class="st">"="</span>, <span class="at">n =</span> <span class="dv">50</span>) {</span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="fu">rep</span>(char, n), <span class="at">collapse =</span> <span class="st">""</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-27"><a href="#cb83-27" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-28"><a href="#cb83-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-29"><a href="#cb83-29" aria-hidden="true" tabindex="-1"></a><span class="fu"># Part 1: The Coffee Shop Example - Why ANOVA Types Matter</span></span>
<span id="cb83-30"><a href="#cb83-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-31"><a href="#cb83-31" aria-hidden="true" tabindex="-1"></a><span class="fu">## Setting the Stage with a Simple Story</span></span>
<span id="cb83-32"><a href="#cb83-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-33"><a href="#cb83-33" aria-hidden="true" tabindex="-1"></a>Imagine you own a coffee shop and want to understand what affects customer satisfaction scores (1-10 scale). You consider two factors:</span>
<span id="cb83-34"><a href="#cb83-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-35"><a href="#cb83-35" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Coffee Type**: Regular vs Decaf</span>
<span id="cb83-36"><a href="#cb83-36" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Time of Day**: Morning vs Afternoon</span>
<span id="cb83-37"><a href="#cb83-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-38"><a href="#cb83-38" aria-hidden="true" tabindex="-1"></a>Let's create this scenario with data:</span>
<span id="cb83-39"><a href="#cb83-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-40"><a href="#cb83-40" aria-hidden="true" tabindex="-1"></a><span class="in">```{r create-coffee-data}</span></span>
<span id="cb83-41"><a href="#cb83-41" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb83-42"><a href="#cb83-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-43"><a href="#cb83-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a BALANCED design first (equal sample sizes)</span></span>
<span id="cb83-44"><a href="#cb83-44" aria-hidden="true" tabindex="-1"></a>n_per_cell <span class="ot">&lt;-</span> <span class="dv">20</span>  <span class="co"># 20 customers in each combination</span></span>
<span id="cb83-45"><a href="#cb83-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-46"><a href="#cb83-46" aria-hidden="true" tabindex="-1"></a>balanced_coffee <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb83-47"><a href="#cb83-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">coffee_type =</span> <span class="fu">c</span>(<span class="st">"Regular"</span>, <span class="st">"Decaf"</span>),</span>
<span id="cb83-48"><a href="#cb83-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_of_day =</span> <span class="fu">c</span>(<span class="st">"Morning"</span>, <span class="st">"Afternoon"</span>),</span>
<span id="cb83-49"><a href="#cb83-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">replicate =</span> <span class="dv">1</span><span class="sc">:</span>n_per_cell</span>
<span id="cb83-50"><a href="#cb83-50" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb83-51"><a href="#cb83-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb83-52"><a href="#cb83-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create satisfaction scores with main effects and interaction</span></span>
<span id="cb83-53"><a href="#cb83-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">satisfaction =</span> <span class="fu">case_when</span>(</span>
<span id="cb83-54"><a href="#cb83-54" aria-hidden="true" tabindex="-1"></a>      coffee_type <span class="sc">==</span> <span class="st">"Regular"</span> <span class="sc">&amp;</span> time_of_day <span class="sc">==</span> <span class="st">"Morning"</span> <span class="sc">~</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="dv">8</span>, <span class="dv">1</span>),    <span class="co"># High satisfaction</span></span>
<span id="cb83-55"><a href="#cb83-55" aria-hidden="true" tabindex="-1"></a>      coffee_type <span class="sc">==</span> <span class="st">"Regular"</span> <span class="sc">&amp;</span> time_of_day <span class="sc">==</span> <span class="st">"Afternoon"</span> <span class="sc">~</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="dv">6</span>, <span class="dv">1</span>),  <span class="co"># Medium</span></span>
<span id="cb83-56"><a href="#cb83-56" aria-hidden="true" tabindex="-1"></a>      coffee_type <span class="sc">==</span> <span class="st">"Decaf"</span> <span class="sc">&amp;</span> time_of_day <span class="sc">==</span> <span class="st">"Morning"</span> <span class="sc">~</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="dv">5</span>, <span class="dv">1</span>),      <span class="co"># Low-medium</span></span>
<span id="cb83-57"><a href="#cb83-57" aria-hidden="true" tabindex="-1"></a>      coffee_type <span class="sc">==</span> <span class="st">"Decaf"</span> <span class="sc">&amp;</span> time_of_day <span class="sc">==</span> <span class="st">"Afternoon"</span> <span class="sc">~</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="dv">7</span>, <span class="dv">1</span>)     <span class="co"># Medium-high</span></span>
<span id="cb83-58"><a href="#cb83-58" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-59"><a href="#cb83-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">coffee_type =</span> <span class="fu">factor</span>(coffee_type),</span>
<span id="cb83-60"><a href="#cb83-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_of_day =</span> <span class="fu">factor</span>(time_of_day)</span>
<span id="cb83-61"><a href="#cb83-61" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb83-62"><a href="#cb83-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>replicate)</span>
<span id="cb83-63"><a href="#cb83-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-64"><a href="#cb83-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the structure</span></span>
<span id="cb83-65"><a href="#cb83-65" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Balanced Design - Sample Sizes:"</span>)</span>
<span id="cb83-66"><a href="#cb83-66" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(balanced_coffee<span class="sc">$</span>coffee_type, balanced_coffee<span class="sc">$</span>time_of_day)</span>
<span id="cb83-67"><a href="#cb83-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-68"><a href="#cb83-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate means for each cell</span></span>
<span id="cb83-69"><a href="#cb83-69" aria-hidden="true" tabindex="-1"></a>cell_means_balanced <span class="ot">&lt;-</span> balanced_coffee <span class="sc">%&gt;%</span></span>
<span id="cb83-70"><a href="#cb83-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(coffee_type, time_of_day) <span class="sc">%&gt;%</span></span>
<span id="cb83-71"><a href="#cb83-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb83-72"><a href="#cb83-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_satisfaction =</span> <span class="fu">mean</span>(satisfaction),</span>
<span id="cb83-73"><a href="#cb83-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb83-74"><a href="#cb83-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb83-75"><a href="#cb83-75" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb83-76"><a href="#cb83-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-77"><a href="#cb83-77" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(cell_means_balanced, <span class="at">digits =</span> <span class="dv">2</span>, </span>
<span id="cb83-78"><a href="#cb83-78" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Mean Satisfaction Scores - Balanced Design"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-79"><a href="#cb83-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span>
<span id="cb83-80"><a href="#cb83-80" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-81"><a href="#cb83-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-82"><a href="#cb83-82" aria-hidden="true" tabindex="-1"></a><span class="fu">## Now Let's Create Reality: Unbalanced Data</span></span>
<span id="cb83-83"><a href="#cb83-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-84"><a href="#cb83-84" aria-hidden="true" tabindex="-1"></a>In real life, you don't get equal numbers of customers in each category. Maybe fewer people order decaf in the morning:</span>
<span id="cb83-85"><a href="#cb83-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-86"><a href="#cb83-86" aria-hidden="true" tabindex="-1"></a><span class="in">```{r create-unbalanced-data}</span></span>
<span id="cb83-87"><a href="#cb83-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Create UNBALANCED design (unequal sample sizes)</span></span>
<span id="cb83-88"><a href="#cb83-88" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb83-89"><a href="#cb83-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-90"><a href="#cb83-90" aria-hidden="true" tabindex="-1"></a>unbalanced_coffee <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb83-91"><a href="#cb83-91" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Regular + Morning: 30 customers (popular!)</span></span>
<span id="cb83-92"><a href="#cb83-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb83-93"><a href="#cb83-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">coffee_type =</span> <span class="st">"Regular"</span>,</span>
<span id="cb83-94"><a href="#cb83-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_of_day =</span> <span class="st">"Morning"</span>,</span>
<span id="cb83-95"><a href="#cb83-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">satisfaction =</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">8</span>, <span class="dv">1</span>)</span>
<span id="cb83-96"><a href="#cb83-96" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb83-97"><a href="#cb83-97" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Regular + Afternoon: 25 customers</span></span>
<span id="cb83-98"><a href="#cb83-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb83-99"><a href="#cb83-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">coffee_type =</span> <span class="st">"Regular"</span>,</span>
<span id="cb83-100"><a href="#cb83-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_of_day =</span> <span class="st">"Afternoon"</span>,</span>
<span id="cb83-101"><a href="#cb83-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">satisfaction =</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="dv">6</span>, <span class="dv">1</span>)</span>
<span id="cb83-102"><a href="#cb83-102" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb83-103"><a href="#cb83-103" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Decaf + Morning: 10 customers (unpopular combination)</span></span>
<span id="cb83-104"><a href="#cb83-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb83-105"><a href="#cb83-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">coffee_type =</span> <span class="st">"Decaf"</span>,</span>
<span id="cb83-106"><a href="#cb83-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_of_day =</span> <span class="st">"Morning"</span>,</span>
<span id="cb83-107"><a href="#cb83-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">satisfaction =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb83-108"><a href="#cb83-108" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb83-109"><a href="#cb83-109" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Decaf + Afternoon: 20 customers</span></span>
<span id="cb83-110"><a href="#cb83-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb83-111"><a href="#cb83-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">coffee_type =</span> <span class="st">"Decaf"</span>,</span>
<span id="cb83-112"><a href="#cb83-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_of_day =</span> <span class="st">"Afternoon"</span>,</span>
<span id="cb83-113"><a href="#cb83-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">satisfaction =</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">7</span>, <span class="dv">1</span>)</span>
<span id="cb83-114"><a href="#cb83-114" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb83-115"><a href="#cb83-115" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb83-116"><a href="#cb83-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb83-117"><a href="#cb83-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">coffee_type =</span> <span class="fu">factor</span>(coffee_type),</span>
<span id="cb83-118"><a href="#cb83-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_of_day =</span> <span class="fu">factor</span>(time_of_day)</span>
<span id="cb83-119"><a href="#cb83-119" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb83-120"><a href="#cb83-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-121"><a href="#cb83-121" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Unbalanced Design - Sample Sizes:"</span>)</span>
<span id="cb83-122"><a href="#cb83-122" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(unbalanced_coffee<span class="sc">$</span>coffee_type, unbalanced_coffee<span class="sc">$</span>time_of_day)</span>
<span id="cb83-123"><a href="#cb83-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-124"><a href="#cb83-124" aria-hidden="true" tabindex="-1"></a>cell_means_unbalanced <span class="ot">&lt;-</span> unbalanced_coffee <span class="sc">%&gt;%</span></span>
<span id="cb83-125"><a href="#cb83-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(coffee_type, time_of_day) <span class="sc">%&gt;%</span></span>
<span id="cb83-126"><a href="#cb83-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb83-127"><a href="#cb83-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_satisfaction =</span> <span class="fu">mean</span>(satisfaction),</span>
<span id="cb83-128"><a href="#cb83-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb83-129"><a href="#cb83-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb83-130"><a href="#cb83-130" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb83-131"><a href="#cb83-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-132"><a href="#cb83-132" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(cell_means_unbalanced, <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb83-133"><a href="#cb83-133" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Mean Satisfaction Scores - Unbalanced Design"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-134"><a href="#cb83-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span>
<span id="cb83-135"><a href="#cb83-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-136"><a href="#cb83-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-137"><a href="#cb83-137" aria-hidden="true" tabindex="-1"></a><span class="fu"># Part 2: The Mathematical Foundation of ANOVA</span></span>
<span id="cb83-138"><a href="#cb83-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-139"><a href="#cb83-139" aria-hidden="true" tabindex="-1"></a><span class="fu">## The General Linear Model</span></span>
<span id="cb83-140"><a href="#cb83-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-141"><a href="#cb83-141" aria-hidden="true" tabindex="-1"></a>ANOVA is actually a special case of linear regression. Our two-way ANOVA model can be written as:</span>
<span id="cb83-142"><a href="#cb83-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-143"><a href="#cb83-143" aria-hidden="true" tabindex="-1"></a>$$Y_{ijk} = \mu + \alpha_i + \beta_j + (\alpha\beta)_{ij} + \epsilon_{ijk}$$</span>
<span id="cb83-144"><a href="#cb83-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-145"><a href="#cb83-145" aria-hidden="true" tabindex="-1"></a>Where:</span>
<span id="cb83-146"><a href="#cb83-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-147"><a href="#cb83-147" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$Y_{ijk}$ = satisfaction score for the $k$-th customer with coffee type $i$ and time $j$</span>
<span id="cb83-148"><a href="#cb83-148" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\mu$ = grand mean (overall average satisfaction)</span>
<span id="cb83-149"><a href="#cb83-149" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\alpha_i$ = main effect of coffee type $i$ (how much Regular or Decaf changes satisfaction)</span>
<span id="cb83-150"><a href="#cb83-150" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\beta_j$ = main effect of time of day $j$ (how much Morning or Afternoon changes satisfaction)</span>
<span id="cb83-151"><a href="#cb83-151" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$(\alpha\beta)_{ij}$ = interaction effect (does the coffee type effect depend on time of day?)</span>
<span id="cb83-152"><a href="#cb83-152" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\epsilon_{ijk}$ = random error (individual differences)</span>
<span id="cb83-153"><a href="#cb83-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-154"><a href="#cb83-154" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sum of Squares Decomposition</span></span>
<span id="cb83-155"><a href="#cb83-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-156"><a href="#cb83-156" aria-hidden="true" tabindex="-1"></a>The total variation in our data can be decomposed:</span>
<span id="cb83-157"><a href="#cb83-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-158"><a href="#cb83-158" aria-hidden="true" tabindex="-1"></a>$$SS_{Total} = SS_{CoffeeType} + SS_{Time} + SS_{Interaction} + SS_{Error}$$</span>
<span id="cb83-159"><a href="#cb83-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-160"><a href="#cb83-160" aria-hidden="true" tabindex="-1"></a>In plain English: </span>
<span id="cb83-161"><a href="#cb83-161" aria-hidden="true" tabindex="-1"></a>Total variation = Variation due to coffee type + Variation due to time + Variation due to their combination + Random variation</span>
<span id="cb83-162"><a href="#cb83-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-163"><a href="#cb83-163" aria-hidden="true" tabindex="-1"></a><span class="fu"># Part 3: Why Order Matters - A Visual Explanation</span></span>
<span id="cb83-164"><a href="#cb83-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-165"><a href="#cb83-165" aria-hidden="true" tabindex="-1"></a><span class="fu">## Understanding Sequential vs Simultaneous Testing</span></span>
<span id="cb83-166"><a href="#cb83-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-167"><a href="#cb83-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r order-matters-demo}</span></span>
<span id="cb83-168"><a href="#cb83-168" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a visual demonstration of why order matters</span></span>
<span id="cb83-169"><a href="#cb83-169" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb83-170"><a href="#cb83-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-171"><a href="#cb83-171" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate partial correlations and visualize</span></span>
<span id="cb83-172"><a href="#cb83-172" aria-hidden="true" tabindex="-1"></a>demonstrate_order_effects <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb83-173"><a href="#cb83-173" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate total sum of squares</span></span>
<span id="cb83-174"><a href="#cb83-174" aria-hidden="true" tabindex="-1"></a>  grand_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>satisfaction)</span>
<span id="cb83-175"><a href="#cb83-175" aria-hidden="true" tabindex="-1"></a>  ss_total <span class="ot">&lt;-</span> <span class="fu">sum</span>((data<span class="sc">$</span>satisfaction <span class="sc">-</span> grand_mean)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb83-176"><a href="#cb83-176" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-177"><a href="#cb83-177" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate group means</span></span>
<span id="cb83-178"><a href="#cb83-178" aria-hidden="true" tabindex="-1"></a>  coffee_means <span class="ot">&lt;-</span> <span class="fu">tapply</span>(data<span class="sc">$</span>satisfaction, data<span class="sc">$</span>coffee_type, mean)</span>
<span id="cb83-179"><a href="#cb83-179" aria-hidden="true" tabindex="-1"></a>  time_means <span class="ot">&lt;-</span> <span class="fu">tapply</span>(data<span class="sc">$</span>satisfaction, data<span class="sc">$</span>time_of_day, mean)</span>
<span id="cb83-180"><a href="#cb83-180" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-181"><a href="#cb83-181" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate marginal sums of squares (ignoring the other factor)</span></span>
<span id="cb83-182"><a href="#cb83-182" aria-hidden="true" tabindex="-1"></a>  ss_coffee_alone <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">table</span>(data<span class="sc">$</span>coffee_type) <span class="sc">*</span> (coffee_means <span class="sc">-</span> grand_mean)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb83-183"><a href="#cb83-183" aria-hidden="true" tabindex="-1"></a>  ss_time_alone <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">table</span>(data<span class="sc">$</span>time_of_day) <span class="sc">*</span> (time_means <span class="sc">-</span> grand_mean)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb83-184"><a href="#cb83-184" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-185"><a href="#cb83-185" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame for visualization</span></span>
<span id="cb83-186"><a href="#cb83-186" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb83-187"><a href="#cb83-187" aria-hidden="true" tabindex="-1"></a>    <span class="at">Approach =</span> <span class="fu">c</span>(<span class="st">"Coffee First"</span>, <span class="st">"Time First"</span>, <span class="st">"Coffee Alone"</span>, <span class="st">"Time Alone"</span>),</span>
<span id="cb83-188"><a href="#cb83-188" aria-hidden="true" tabindex="-1"></a>    <span class="at">Coffee_SS =</span> <span class="fu">c</span>(ss_coffee_alone, <span class="cn">NA</span>, ss_coffee_alone, <span class="cn">NA</span>),</span>
<span id="cb83-189"><a href="#cb83-189" aria-hidden="true" tabindex="-1"></a>    <span class="at">Time_SS =</span> <span class="fu">c</span>(<span class="cn">NA</span>, ss_time_alone, <span class="cn">NA</span>, ss_time_alone),</span>
<span id="cb83-190"><a href="#cb83-190" aria-hidden="true" tabindex="-1"></a>    <span class="at">Order =</span> <span class="fu">c</span>(<span class="st">"1st"</span>, <span class="st">"1st"</span>, <span class="st">"Marginal"</span>, <span class="st">"Marginal"</span>)</span>
<span id="cb83-191"><a href="#cb83-191" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb83-192"><a href="#cb83-192" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-193"><a href="#cb83-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb83-194"><a href="#cb83-194" aria-hidden="true" tabindex="-1"></a>    <span class="at">ss_total =</span> ss_total,</span>
<span id="cb83-195"><a href="#cb83-195" aria-hidden="true" tabindex="-1"></a>    <span class="at">ss_coffee_alone =</span> ss_coffee_alone,</span>
<span id="cb83-196"><a href="#cb83-196" aria-hidden="true" tabindex="-1"></a>    <span class="at">ss_time_alone =</span> ss_time_alone,</span>
<span id="cb83-197"><a href="#cb83-197" aria-hidden="true" tabindex="-1"></a>    <span class="at">coffee_means =</span> coffee_means,</span>
<span id="cb83-198"><a href="#cb83-198" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_means =</span> time_means,</span>
<span id="cb83-199"><a href="#cb83-199" aria-hidden="true" tabindex="-1"></a>    <span class="at">grand_mean =</span> grand_mean</span>
<span id="cb83-200"><a href="#cb83-200" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb83-201"><a href="#cb83-201" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-202"><a href="#cb83-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-203"><a href="#cb83-203" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply to both datasets</span></span>
<span id="cb83-204"><a href="#cb83-204" aria-hidden="true" tabindex="-1"></a>balanced_results <span class="ot">&lt;-</span> <span class="fu">demonstrate_order_effects</span>(balanced_coffee)</span>
<span id="cb83-205"><a href="#cb83-205" aria-hidden="true" tabindex="-1"></a>unbalanced_results <span class="ot">&lt;-</span> <span class="fu">demonstrate_order_effects</span>(unbalanced_coffee)</span>
<span id="cb83-206"><a href="#cb83-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-207"><a href="#cb83-207" aria-hidden="true" tabindex="-1"></a><span class="co"># Create comparison table</span></span>
<span id="cb83-208"><a href="#cb83-208" aria-hidden="true" tabindex="-1"></a>comparison_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb83-209"><a href="#cb83-209" aria-hidden="true" tabindex="-1"></a>  <span class="at">Design =</span> <span class="fu">c</span>(<span class="st">"Balanced"</span>, <span class="st">"Balanced"</span>, <span class="st">"Unbalanced"</span>, <span class="st">"Unbalanced"</span>),</span>
<span id="cb83-210"><a href="#cb83-210" aria-hidden="true" tabindex="-1"></a>  <span class="at">Factor =</span> <span class="fu">c</span>(<span class="st">"Coffee Type"</span>, <span class="st">"Time of Day"</span>, <span class="st">"Coffee Type"</span>, <span class="st">"Time of Day"</span>),</span>
<span id="cb83-211"><a href="#cb83-211" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">SS When Tested First</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb83-212"><a href="#cb83-212" aria-hidden="true" tabindex="-1"></a>    balanced_results<span class="sc">$</span>ss_coffee_alone,</span>
<span id="cb83-213"><a href="#cb83-213" aria-hidden="true" tabindex="-1"></a>    balanced_results<span class="sc">$</span>ss_time_alone,</span>
<span id="cb83-214"><a href="#cb83-214" aria-hidden="true" tabindex="-1"></a>    unbalanced_results<span class="sc">$</span>ss_coffee_alone,</span>
<span id="cb83-215"><a href="#cb83-215" aria-hidden="true" tabindex="-1"></a>    unbalanced_results<span class="sc">$</span>ss_time_alone</span>
<span id="cb83-216"><a href="#cb83-216" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb83-217"><a href="#cb83-217" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb83-218"><a href="#cb83-218" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-219"><a href="#cb83-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-220"><a href="#cb83-220" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(comparison_df, <span class="at">digits =</span> <span class="dv">2</span>, </span>
<span id="cb83-221"><a href="#cb83-221" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Sum of Squares When Each Factor is Tested First"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-222"><a href="#cb83-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span>
<span id="cb83-223"><a href="#cb83-223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-224"><a href="#cb83-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-225"><a href="#cb83-225" aria-hidden="true" tabindex="-1"></a>::::{.callout-note}</span>
<span id="cb83-226"><a href="#cb83-226" aria-hidden="true" tabindex="-1"></a><span class="fu">## Why Does Order Matter in Unbalanced Designs?</span></span>
<span id="cb83-227"><a href="#cb83-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-228"><a href="#cb83-228" aria-hidden="true" tabindex="-1"></a>In unbalanced designs, the factors are **correlated**. When factors are correlated:</span>
<span id="cb83-229"><a href="#cb83-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-230"><a href="#cb83-230" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>The effect of Coffee Type partially overlaps with the effect of Time</span>
<span id="cb83-231"><a href="#cb83-231" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Testing Coffee first "claims" the overlapping variance</span>
<span id="cb83-232"><a href="#cb83-232" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Testing Time first would claim that same overlapping variance differently</span>
<span id="cb83-233"><a href="#cb83-233" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>This is why Type I (sequential) ANOVA gives different results based on order</span>
<span id="cb83-234"><a href="#cb83-234" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb83-235"><a href="#cb83-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-236"><a href="#cb83-236" aria-hidden="true" tabindex="-1"></a><span class="fu"># Part 4: The Controversy - Types I, II, and III Sum of Squares</span></span>
<span id="cb83-237"><a href="#cb83-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-238"><a href="#cb83-238" aria-hidden="true" tabindex="-1"></a><span class="fu">## Manual Calculation Tables for Understanding</span></span>
<span id="cb83-239"><a href="#cb83-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-240"><a href="#cb83-240" aria-hidden="true" tabindex="-1"></a>Let's manually calculate the different types of sum of squares to truly understand what's happening:</span>
<span id="cb83-241"><a href="#cb83-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-242"><a href="#cb83-242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r manual-calculations}</span></span>
<span id="cb83-243"><a href="#cb83-243" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to manually calculate all types of SS</span></span>
<span id="cb83-244"><a href="#cb83-244" aria-hidden="true" tabindex="-1"></a>calculate_all_ss_types <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">show_details =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb83-245"><a href="#cb83-245" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare data</span></span>
<span id="cb83-246"><a href="#cb83-246" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)</span>
<span id="cb83-247"><a href="#cb83-247" aria-hidden="true" tabindex="-1"></a>  grand_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>satisfaction)</span>
<span id="cb83-248"><a href="#cb83-248" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-249"><a href="#cb83-249" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get cell means and counts</span></span>
<span id="cb83-250"><a href="#cb83-250" aria-hidden="true" tabindex="-1"></a>  cell_summary <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb83-251"><a href="#cb83-251" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(coffee_type, time_of_day) <span class="sc">%&gt;%</span></span>
<span id="cb83-252"><a href="#cb83-252" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb83-253"><a href="#cb83-253" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean =</span> <span class="fu">mean</span>(satisfaction),</span>
<span id="cb83-254"><a href="#cb83-254" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb83-255"><a href="#cb83-255" aria-hidden="true" tabindex="-1"></a>      <span class="at">sum =</span> <span class="fu">sum</span>(satisfaction),</span>
<span id="cb83-256"><a href="#cb83-256" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb83-257"><a href="#cb83-257" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-258"><a href="#cb83-258" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-259"><a href="#cb83-259" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Marginal means</span></span>
<span id="cb83-260"><a href="#cb83-260" aria-hidden="true" tabindex="-1"></a>  coffee_marginal <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb83-261"><a href="#cb83-261" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(coffee_type) <span class="sc">%&gt;%</span></span>
<span id="cb83-262"><a href="#cb83-262" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb83-263"><a href="#cb83-263" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean =</span> <span class="fu">mean</span>(satisfaction),</span>
<span id="cb83-264"><a href="#cb83-264" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb83-265"><a href="#cb83-265" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb83-266"><a href="#cb83-266" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-267"><a href="#cb83-267" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-268"><a href="#cb83-268" aria-hidden="true" tabindex="-1"></a>  time_marginal <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb83-269"><a href="#cb83-269" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(time_of_day) <span class="sc">%&gt;%</span></span>
<span id="cb83-270"><a href="#cb83-270" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb83-271"><a href="#cb83-271" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean =</span> <span class="fu">mean</span>(satisfaction),</span>
<span id="cb83-272"><a href="#cb83-272" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb83-273"><a href="#cb83-273" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb83-274"><a href="#cb83-274" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-275"><a href="#cb83-275" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-276"><a href="#cb83-276" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(show_details) {</span>
<span id="cb83-277"><a href="#cb83-277" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Cell Means and Sample Sizes:"</span>)</span>
<span id="cb83-278"><a href="#cb83-278" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(cell_summary)</span>
<span id="cb83-279"><a href="#cb83-279" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">""</span>)</span>
<span id="cb83-280"><a href="#cb83-280" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Marginal Means - Coffee Type:"</span>)</span>
<span id="cb83-281"><a href="#cb83-281" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(coffee_marginal)</span>
<span id="cb83-282"><a href="#cb83-282" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">""</span>)</span>
<span id="cb83-283"><a href="#cb83-283" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Marginal Means - Time of Day:"</span>)</span>
<span id="cb83-284"><a href="#cb83-284" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(time_marginal)</span>
<span id="cb83-285"><a href="#cb83-285" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">""</span>)</span>
<span id="cb83-286"><a href="#cb83-286" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Grand Mean:"</span>, <span class="fu">round</span>(grand_mean, <span class="dv">3</span>)))</span>
<span id="cb83-287"><a href="#cb83-287" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sep_line</span>(<span class="st">"-"</span>, <span class="dv">40</span>)</span>
<span id="cb83-288"><a href="#cb83-288" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb83-289"><a href="#cb83-289" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-290"><a href="#cb83-290" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate Type I SS (Sequential)</span></span>
<span id="cb83-291"><a href="#cb83-291" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Order 1: Coffee -&gt; Time -&gt; Interaction</span></span>
<span id="cb83-292"><a href="#cb83-292" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-293"><a href="#cb83-293" aria-hidden="true" tabindex="-1"></a>  <span class="co"># SS(Coffee | μ)</span></span>
<span id="cb83-294"><a href="#cb83-294" aria-hidden="true" tabindex="-1"></a>  ss_coffee_type1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(coffee_marginal<span class="sc">$</span>n <span class="sc">*</span> (coffee_marginal<span class="sc">$</span>mean <span class="sc">-</span> grand_mean)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb83-295"><a href="#cb83-295" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-296"><a href="#cb83-296" aria-hidden="true" tabindex="-1"></a>  <span class="co"># For SS(Time | μ, Coffee), we need residuals after fitting Coffee</span></span>
<span id="cb83-297"><a href="#cb83-297" aria-hidden="true" tabindex="-1"></a>  model_coffee_only <span class="ot">&lt;-</span> <span class="fu">lm</span>(satisfaction <span class="sc">~</span> coffee_type, <span class="at">data =</span> data)</span>
<span id="cb83-298"><a href="#cb83-298" aria-hidden="true" tabindex="-1"></a>  residuals_after_coffee <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model_coffee_only)</span>
<span id="cb83-299"><a href="#cb83-299" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-300"><a href="#cb83-300" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create pseudo-data with residuals</span></span>
<span id="cb83-301"><a href="#cb83-301" aria-hidden="true" tabindex="-1"></a>  pseudo_data_time <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb83-302"><a href="#cb83-302" aria-hidden="true" tabindex="-1"></a>    <span class="at">residuals =</span> residuals_after_coffee,</span>
<span id="cb83-303"><a href="#cb83-303" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_of_day =</span> data<span class="sc">$</span>time_of_day</span>
<span id="cb83-304"><a href="#cb83-304" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb83-305"><a href="#cb83-305" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-306"><a href="#cb83-306" aria-hidden="true" tabindex="-1"></a>  model_time_on_residuals <span class="ot">&lt;-</span> <span class="fu">lm</span>(residuals <span class="sc">~</span> time_of_day, <span class="at">data =</span> pseudo_data_time)</span>
<span id="cb83-307"><a href="#cb83-307" aria-hidden="true" tabindex="-1"></a>  ss_time_type1 <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="fu">fitted</span>(model_time_on_residuals))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb83-308"><a href="#cb83-308" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-309"><a href="#cb83-309" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate Type II SS (Marginal, no interaction)</span></span>
<span id="cb83-310"><a href="#cb83-310" aria-hidden="true" tabindex="-1"></a>  model_both_main <span class="ot">&lt;-</span> <span class="fu">lm</span>(satisfaction <span class="sc">~</span> coffee_type <span class="sc">+</span> time_of_day, <span class="at">data =</span> data)</span>
<span id="cb83-311"><a href="#cb83-311" aria-hidden="true" tabindex="-1"></a>  model_coffee_only <span class="ot">&lt;-</span> <span class="fu">lm</span>(satisfaction <span class="sc">~</span> coffee_type, <span class="at">data =</span> data)</span>
<span id="cb83-312"><a href="#cb83-312" aria-hidden="true" tabindex="-1"></a>  model_time_only <span class="ot">&lt;-</span> <span class="fu">lm</span>(satisfaction <span class="sc">~</span> time_of_day, <span class="at">data =</span> data)</span>
<span id="cb83-313"><a href="#cb83-313" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-314"><a href="#cb83-314" aria-hidden="true" tabindex="-1"></a>  ss_coffee_type2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="fu">fitted</span>(model_both_main) <span class="sc">-</span> <span class="fu">fitted</span>(model_time_only))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb83-315"><a href="#cb83-315" aria-hidden="true" tabindex="-1"></a>  ss_time_type2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="fu">fitted</span>(model_both_main) <span class="sc">-</span> <span class="fu">fitted</span>(model_coffee_only))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb83-316"><a href="#cb83-316" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-317"><a href="#cb83-317" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate Type III SS (Marginal, with interaction)</span></span>
<span id="cb83-318"><a href="#cb83-318" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This requires more complex calculations with contrast coding</span></span>
<span id="cb83-319"><a href="#cb83-319" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-320"><a href="#cb83-320" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create results table</span></span>
<span id="cb83-321"><a href="#cb83-321" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb83-322"><a href="#cb83-322" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Type</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Type I"</span>, <span class="st">"Type II"</span>, <span class="st">"Type III*"</span>),</span>
<span id="cb83-323"><a href="#cb83-323" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">SS_Coffee</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(ss_coffee_type1, ss_coffee_type2, <span class="cn">NA</span>),</span>
<span id="cb83-324"><a href="#cb83-324" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">SS_Time</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(ss_time_type1, ss_time_type2, <span class="cn">NA</span>),</span>
<span id="cb83-325"><a href="#cb83-325" aria-hidden="true" tabindex="-1"></a>    <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb83-326"><a href="#cb83-326" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb83-327"><a href="#cb83-327" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-328"><a href="#cb83-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb83-329"><a href="#cb83-329" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-330"><a href="#cb83-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-331"><a href="#cb83-331" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate for both designs</span></span>
<span id="cb83-332"><a href="#cb83-332" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"BALANCED DESIGN:"</span>)</span>
<span id="cb83-333"><a href="#cb83-333" aria-hidden="true" tabindex="-1"></a>balanced_calc <span class="ot">&lt;-</span> <span class="fu">calculate_all_ss_types</span>(balanced_coffee, <span class="at">show_details =</span> <span class="cn">TRUE</span>)</span>
<span id="cb83-334"><a href="#cb83-334" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(balanced_calc, <span class="at">digits =</span> <span class="dv">2</span>, </span>
<span id="cb83-335"><a href="#cb83-335" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Manual SS Calculations - Balanced Design"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-336"><a href="#cb83-336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span>
<span id="cb83-337"><a href="#cb83-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-338"><a href="#cb83-338" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">""</span>)</span>
<span id="cb83-339"><a href="#cb83-339" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"UNBALANCED DESIGN:"</span>)</span>
<span id="cb83-340"><a href="#cb83-340" aria-hidden="true" tabindex="-1"></a>unbalanced_calc <span class="ot">&lt;-</span> <span class="fu">calculate_all_ss_types</span>(unbalanced_coffee, <span class="at">show_details =</span> <span class="cn">TRUE</span>)</span>
<span id="cb83-341"><a href="#cb83-341" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(unbalanced_calc, <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb83-342"><a href="#cb83-342" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Manual SS Calculations - Unbalanced Design"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-343"><a href="#cb83-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span>
<span id="cb83-344"><a href="#cb83-344" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-345"><a href="#cb83-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-346"><a href="#cb83-346" aria-hidden="true" tabindex="-1"></a><span class="fu">## Type I Sum of Squares (Sequential)</span></span>
<span id="cb83-347"><a href="#cb83-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-348"><a href="#cb83-348" aria-hidden="true" tabindex="-1"></a>**Mathematical Definition:**</span>
<span id="cb83-349"><a href="#cb83-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-350"><a href="#cb83-350" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$SS(\alpha | \mu)$ = Sum of squares for A after fitting the mean</span>
<span id="cb83-351"><a href="#cb83-351" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$SS(\beta | \mu, \alpha)$ = Sum of squares for B after fitting mean and A</span>
<span id="cb83-352"><a href="#cb83-352" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$SS(\alpha\beta | \mu, \alpha, \beta)$ = Sum of squares for interaction after fitting everything else</span>
<span id="cb83-353"><a href="#cb83-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-354"><a href="#cb83-354" aria-hidden="true" tabindex="-1"></a>**Plain English:** Type I asks "What does each factor explain that wasn't already explained by factors entered before it?"</span>
<span id="cb83-355"><a href="#cb83-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-356"><a href="#cb83-356" aria-hidden="true" tabindex="-1"></a>::::{.callout-info}</span>
<span id="cb83-357"><a href="#cb83-357" aria-hidden="true" tabindex="-1"></a><span class="fu">## Example: When Type I Makes Sense</span></span>
<span id="cb83-358"><a href="#cb83-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-359"><a href="#cb83-359" aria-hidden="true" tabindex="-1"></a>**Scenario: Educational Achievement Study**</span>
<span id="cb83-360"><a href="#cb83-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-361"><a href="#cb83-361" aria-hidden="true" tabindex="-1"></a>Imagine studying factors affecting student test scores where we have a clear causal hierarchy:</span>
<span id="cb83-362"><a href="#cb83-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-363"><a href="#cb83-363" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Socioeconomic Status (SES)** - This is a background variable that exists before schooling</span>
<span id="cb83-364"><a href="#cb83-364" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**School Quality** - Students are assigned to schools based partly on where they live (related to SES)</span>
<span id="cb83-365"><a href="#cb83-365" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Teaching Method** - Applied within schools</span>
<span id="cb83-366"><a href="#cb83-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-367"><a href="#cb83-367" aria-hidden="true" tabindex="-1"></a>Here, it makes sense to use Type I with SES entered first, then School Quality, then Teaching Method. We want to know:</span>
<span id="cb83-368"><a href="#cb83-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-369"><a href="#cb83-369" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>How much variance does SES explain?</span>
<span id="cb83-370"><a href="#cb83-370" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>How much *additional* variance does School Quality explain after accounting for SES?</span>
<span id="cb83-371"><a href="#cb83-371" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>How much *additional* variance does Teaching Method explain after accounting for both?</span>
<span id="cb83-372"><a href="#cb83-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-373"><a href="#cb83-373" aria-hidden="true" tabindex="-1"></a>This sequential approach respects the causal/temporal ordering of these factors.</span>
<span id="cb83-374"><a href="#cb83-374" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb83-375"><a href="#cb83-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-376"><a href="#cb83-376" aria-hidden="true" tabindex="-1"></a><span class="in">```{r type-I-detailed}</span></span>
<span id="cb83-377"><a href="#cb83-377" aria-hidden="true" tabindex="-1"></a><span class="co"># Type I implementation with detailed output</span></span>
<span id="cb83-378"><a href="#cb83-378" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"TYPE I - Sequential Sum of Squares"</span>)</span>
<span id="cb83-379"><a href="#cb83-379" aria-hidden="true" tabindex="-1"></a><span class="fu">sep_line</span>(<span class="st">"="</span>, <span class="dv">50</span>)</span>
<span id="cb83-380"><a href="#cb83-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-381"><a href="#cb83-381" aria-hidden="true" tabindex="-1"></a>model_type1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(satisfaction <span class="sc">~</span> coffee_type <span class="sc">+</span> time_of_day <span class="sc">+</span> coffee_type<span class="sc">:</span>time_of_day, </span>
<span id="cb83-382"><a href="#cb83-382" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> unbalanced_coffee)</span>
<span id="cb83-383"><a href="#cb83-383" aria-hidden="true" tabindex="-1"></a>anova_type1 <span class="ot">&lt;-</span> <span class="fu">anova</span>(model_type1)</span>
<span id="cb83-384"><a href="#cb83-384" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(anova_type1)</span>
<span id="cb83-385"><a href="#cb83-385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-386"><a href="#cb83-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-387"><a href="#cb83-387" aria-hidden="true" tabindex="-1"></a>::::{.callout-question}</span>
<span id="cb83-388"><a href="#cb83-388" aria-hidden="true" tabindex="-1"></a><span class="fu">## What Does Each Row Mean?</span></span>
<span id="cb83-389"><a href="#cb83-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-390"><a href="#cb83-390" aria-hidden="true" tabindex="-1"></a>Click below to understand each row in the ANOVA table:</span>
<span id="cb83-391"><a href="#cb83-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-392"><a href="#cb83-392" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;details&gt;</span></span>
<span id="cb83-393"><a href="#cb83-393" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;summary&gt;</span>**Click to see explanation**<span class="kw">&lt;/summary&gt;</span></span>
<span id="cb83-394"><a href="#cb83-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-395"><a href="#cb83-395" aria-hidden="true" tabindex="-1"></a>**Row 1 - coffee_type:** </span>
<span id="cb83-396"><a href="#cb83-396" aria-hidden="true" tabindex="-1"></a>This shows the sum of squares for coffee type when it's the FIRST factor considered (after the intercept). It answers: "How much variance in satisfaction is explained by coffee type alone?"</span>
<span id="cb83-397"><a href="#cb83-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-398"><a href="#cb83-398" aria-hidden="true" tabindex="-1"></a>**Row 2 - time_of_day:**</span>
<span id="cb83-399"><a href="#cb83-399" aria-hidden="true" tabindex="-1"></a>This shows the sum of squares for time of day AFTER removing the effect of coffee type. It answers: "How much additional variance is explained by time of day that wasn't already explained by coffee type?"</span>
<span id="cb83-400"><a href="#cb83-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-401"><a href="#cb83-401" aria-hidden="true" tabindex="-1"></a>**Row 3 - coffee_type:time_of_day:**</span>
<span id="cb83-402"><a href="#cb83-402" aria-hidden="true" tabindex="-1"></a>This is the interaction term. It answers: "Is the effect of coffee type different at different times of day?" A significant interaction means the effect of one factor depends on the level of the other.</span>
<span id="cb83-403"><a href="#cb83-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-404"><a href="#cb83-404" aria-hidden="true" tabindex="-1"></a>**Row 4 - Residuals:**</span>
<span id="cb83-405"><a href="#cb83-405" aria-hidden="true" tabindex="-1"></a>This is the unexplained variance - the variation in satisfaction scores that can't be explained by any of our factors. It represents individual differences and measurement error.</span>
<span id="cb83-406"><a href="#cb83-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-407"><a href="#cb83-407" aria-hidden="true" tabindex="-1"></a>**Columns Explained:**</span>
<span id="cb83-408"><a href="#cb83-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-409"><a href="#cb83-409" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Df (Degrees of Freedom):** Number of independent pieces of information. For factors: (number of levels - 1)</span>
<span id="cb83-410"><a href="#cb83-410" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Sum Sq:** Total squared deviations explained by that factor</span>
<span id="cb83-411"><a href="#cb83-411" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Mean Sq:** Sum Sq divided by Df (average squared deviation)</span>
<span id="cb83-412"><a href="#cb83-412" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**F value:** Ratio of factor's Mean Sq to Residual Mean Sq (signal-to-noise ratio)</span>
<span id="cb83-413"><a href="#cb83-413" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Pr(&gt;F):** p-value - probability of seeing this F-value or larger if null hypothesis is true</span>
<span id="cb83-414"><a href="#cb83-414" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/details&gt;</span></span>
<span id="cb83-415"><a href="#cb83-415" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb83-416"><a href="#cb83-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-417"><a href="#cb83-417" aria-hidden="true" tabindex="-1"></a><span class="fu">## Type II Sum of Squares (Hierarchical)</span></span>
<span id="cb83-418"><a href="#cb83-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-419"><a href="#cb83-419" aria-hidden="true" tabindex="-1"></a>**Mathematical Definition:**</span>
<span id="cb83-420"><a href="#cb83-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-421"><a href="#cb83-421" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$SS(\alpha | \mu, \beta)$ = Sum of squares for A after fitting mean and B</span>
<span id="cb83-422"><a href="#cb83-422" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$SS(\beta | \mu, \alpha)$ = Sum of squares for B after fitting mean and A</span>
<span id="cb83-423"><a href="#cb83-423" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$SS(\alpha\beta | \mu, \alpha, \beta)$ = Sum of squares for interaction after main effects</span>
<span id="cb83-424"><a href="#cb83-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-425"><a href="#cb83-425" aria-hidden="true" tabindex="-1"></a>**Plain English:** Type II asks "What does each main effect explain that the other main effect doesn't, ignoring interactions?"</span>
<span id="cb83-426"><a href="#cb83-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-427"><a href="#cb83-427" aria-hidden="true" tabindex="-1"></a>**When to use:** When you want to test main effects assuming no interaction (most common in practice)</span>
<span id="cb83-428"><a href="#cb83-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-429"><a href="#cb83-429" aria-hidden="true" tabindex="-1"></a><span class="in">```{r type-II-detailed}</span></span>
<span id="cb83-430"><a href="#cb83-430" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"TYPE II - Hierarchical Sum of Squares"</span>)</span>
<span id="cb83-431"><a href="#cb83-431" aria-hidden="true" tabindex="-1"></a><span class="fu">sep_line</span>(<span class="st">"="</span>, <span class="dv">50</span>)</span>
<span id="cb83-432"><a href="#cb83-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-433"><a href="#cb83-433" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(model_type1, <span class="at">type =</span> <span class="st">"II"</span>)</span>
<span id="cb83-434"><a href="#cb83-434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-435"><a href="#cb83-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-436"><a href="#cb83-436" aria-hidden="true" tabindex="-1"></a>::::{.callout-question}</span>
<span id="cb83-437"><a href="#cb83-437" aria-hidden="true" tabindex="-1"></a><span class="fu">## What Does Each Row Mean in Type II?</span></span>
<span id="cb83-438"><a href="#cb83-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-439"><a href="#cb83-439" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;details&gt;</span></span>
<span id="cb83-440"><a href="#cb83-440" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;summary&gt;</span>**Click to see explanation**<span class="kw">&lt;/summary&gt;</span></span>
<span id="cb83-441"><a href="#cb83-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-442"><a href="#cb83-442" aria-hidden="true" tabindex="-1"></a>**Key Differences from Type I:**</span>
<span id="cb83-443"><a href="#cb83-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-444"><a href="#cb83-444" aria-hidden="true" tabindex="-1"></a>**Row 1 - coffee_type:**</span>
<span id="cb83-445"><a href="#cb83-445" aria-hidden="true" tabindex="-1"></a>Now shows SS for coffee type AFTER adjusting for time_of_day (but NOT interaction). It answers: "What unique variance does coffee type explain that time doesn't?"</span>
<span id="cb83-446"><a href="#cb83-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-447"><a href="#cb83-447" aria-hidden="true" tabindex="-1"></a>**Row 2 - time_of_day:**</span>
<span id="cb83-448"><a href="#cb83-448" aria-hidden="true" tabindex="-1"></a>Shows SS for time AFTER adjusting for coffee_type (but NOT interaction). It answers: "What unique variance does time explain that coffee type doesn't?"</span>
<span id="cb83-449"><a href="#cb83-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-450"><a href="#cb83-450" aria-hidden="true" tabindex="-1"></a>**Row 3 - coffee_type:time_of_day:**</span>
<span id="cb83-451"><a href="#cb83-451" aria-hidden="true" tabindex="-1"></a>Same as Type I - interaction is always tested last.</span>
<span id="cb83-452"><a href="#cb83-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-453"><a href="#cb83-453" aria-hidden="true" tabindex="-1"></a>**Why Type II is Often Preferred:**</span>
<span id="cb83-454"><a href="#cb83-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-455"><a href="#cb83-455" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Tests each main effect controlling for other main effects</span>
<span id="cb83-456"><a href="#cb83-456" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Order doesn't matter (unlike Type I)</span>
<span id="cb83-457"><a href="#cb83-457" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Assumes no interaction when testing main effects</span>
<span id="cb83-458"><a href="#cb83-458" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>More balanced approach for most research questions</span>
<span id="cb83-459"><a href="#cb83-459" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/details&gt;</span></span>
<span id="cb83-460"><a href="#cb83-460" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb83-461"><a href="#cb83-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-462"><a href="#cb83-462" aria-hidden="true" tabindex="-1"></a><span class="fu">## Type III Sum of Squares (Marginal)</span></span>
<span id="cb83-463"><a href="#cb83-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-464"><a href="#cb83-464" aria-hidden="true" tabindex="-1"></a>**Mathematical Definition:**</span>
<span id="cb83-465"><a href="#cb83-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-466"><a href="#cb83-466" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$SS(\alpha | \mu, \beta, \alpha\beta)$ = Sum of squares for A after fitting everything else</span>
<span id="cb83-467"><a href="#cb83-467" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$SS(\beta | \mu, \alpha, \alpha\beta)$ = Sum of squares for B after fitting everything else</span>
<span id="cb83-468"><a href="#cb83-468" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$SS(\alpha\beta | \mu, \alpha, \beta)$ = Sum of squares for interaction after main effects</span>
<span id="cb83-469"><a href="#cb83-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-470"><a href="#cb83-470" aria-hidden="true" tabindex="-1"></a>**Plain English:** Type III asks "What does each effect explain that isn't explained by any other effect, including interactions?"</span>
<span id="cb83-471"><a href="#cb83-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-472"><a href="#cb83-472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r type-III-detailed}</span></span>
<span id="cb83-473"><a href="#cb83-473" aria-hidden="true" tabindex="-1"></a><span class="co"># Type III implementation</span></span>
<span id="cb83-474"><a href="#cb83-474" aria-hidden="true" tabindex="-1"></a><span class="co"># IMPORTANT: Must use sum-to-zero contrasts for Type III</span></span>
<span id="cb83-475"><a href="#cb83-475" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(unbalanced_coffee<span class="sc">$</span>coffee_type) <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="dv">2</span>)</span>
<span id="cb83-476"><a href="#cb83-476" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(unbalanced_coffee<span class="sc">$</span>time_of_day) <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="dv">2</span>)</span>
<span id="cb83-477"><a href="#cb83-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-478"><a href="#cb83-478" aria-hidden="true" tabindex="-1"></a>model_type3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(satisfaction <span class="sc">~</span> coffee_type <span class="sc">*</span> time_of_day, <span class="at">data =</span> unbalanced_coffee)</span>
<span id="cb83-479"><a href="#cb83-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-480"><a href="#cb83-480" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"TYPE III - Marginal Sum of Squares"</span>)</span>
<span id="cb83-481"><a href="#cb83-481" aria-hidden="true" tabindex="-1"></a><span class="fu">sep_line</span>(<span class="st">"="</span>, <span class="dv">50</span>)</span>
<span id="cb83-482"><a href="#cb83-482" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(model_type3, <span class="at">type =</span> <span class="st">"III"</span>)</span>
<span id="cb83-483"><a href="#cb83-483" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-484"><a href="#cb83-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-485"><a href="#cb83-485" aria-hidden="true" tabindex="-1"></a>::::{.callout-question}</span>
<span id="cb83-486"><a href="#cb83-486" aria-hidden="true" tabindex="-1"></a><span class="fu">## What Does Each Row Mean in Type III?</span></span>
<span id="cb83-487"><a href="#cb83-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-488"><a href="#cb83-488" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;details&gt;</span></span>
<span id="cb83-489"><a href="#cb83-489" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;summary&gt;</span>**Click to see explanation**<span class="kw">&lt;/summary&gt;</span></span>
<span id="cb83-490"><a href="#cb83-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-491"><a href="#cb83-491" aria-hidden="true" tabindex="-1"></a>**Type III Special Characteristics:**</span>
<span id="cb83-492"><a href="#cb83-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-493"><a href="#cb83-493" aria-hidden="true" tabindex="-1"></a>**Row 1 - (Intercept):**</span>
<span id="cb83-494"><a href="#cb83-494" aria-hidden="true" tabindex="-1"></a>Type III includes the intercept test, which tests if the grand mean equals zero (usually not interesting).</span>
<span id="cb83-495"><a href="#cb83-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-496"><a href="#cb83-496" aria-hidden="true" tabindex="-1"></a>**Row 2 - coffee_type:**</span>
<span id="cb83-497"><a href="#cb83-497" aria-hidden="true" tabindex="-1"></a>Tests coffee type AFTER adjusting for time AND interaction. Answers: "Is there a coffee type effect averaged across all times?"</span>
<span id="cb83-498"><a href="#cb83-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-499"><a href="#cb83-499" aria-hidden="true" tabindex="-1"></a>**Row 3 - time_of_day:**</span>
<span id="cb83-500"><a href="#cb83-500" aria-hidden="true" tabindex="-1"></a>Tests time AFTER adjusting for coffee type AND interaction. Answers: "Is there a time effect averaged across all coffee types?"</span>
<span id="cb83-501"><a href="#cb83-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-502"><a href="#cb83-502" aria-hidden="true" tabindex="-1"></a>**Row 4 - coffee_type:time_of_day:**</span>
<span id="cb83-503"><a href="#cb83-503" aria-hidden="true" tabindex="-1"></a>Same as other types - interaction effect.</span>
<span id="cb83-504"><a href="#cb83-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-505"><a href="#cb83-505" aria-hidden="true" tabindex="-1"></a>**When Type III is Useful:**</span>
<span id="cb83-506"><a href="#cb83-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-507"><a href="#cb83-507" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>When interaction is significant</span>
<span id="cb83-508"><a href="#cb83-508" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>When you want the most conservative test</span>
<span id="cb83-509"><a href="#cb83-509" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>When following certain field conventions (e.g., some areas of psychology)</span>
<span id="cb83-510"><a href="#cb83-510" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Tests "average" effects across all levels of other factors</span>
<span id="cb83-511"><a href="#cb83-511" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/details&gt;</span></span>
<span id="cb83-512"><a href="#cb83-512" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb83-513"><a href="#cb83-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-514"><a href="#cb83-514" aria-hidden="true" tabindex="-1"></a><span class="fu"># Part 5: Why All Three Types Give the Same Answer for Balanced Data</span></span>
<span id="cb83-515"><a href="#cb83-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-516"><a href="#cb83-516" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Magic of Orthogonality</span></span>
<span id="cb83-517"><a href="#cb83-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-518"><a href="#cb83-518" aria-hidden="true" tabindex="-1"></a><span class="in">```{r why-balanced-same}</span></span>
<span id="cb83-519"><a href="#cb83-519" aria-hidden="true" tabindex="-1"></a><span class="co"># Demonstrate orthogonality in balanced vs unbalanced designs</span></span>
<span id="cb83-520"><a href="#cb83-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-521"><a href="#cb83-521" aria-hidden="true" tabindex="-1"></a>check_orthogonality <span class="ot">&lt;-</span> <span class="cf">function</span>(data, title) {</span>
<span id="cb83-522"><a href="#cb83-522" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create design matrix</span></span>
<span id="cb83-523"><a href="#cb83-523" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> coffee_type <span class="sc">*</span> time_of_day, <span class="at">data =</span> data)</span>
<span id="cb83-524"><a href="#cb83-524" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-525"><a href="#cb83-525" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate correlation matrix (excluding intercept)</span></span>
<span id="cb83-526"><a href="#cb83-526" aria-hidden="true" tabindex="-1"></a>  cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(X[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb83-527"><a href="#cb83-527" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-528"><a href="#cb83-528" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Visualize</span></span>
<span id="cb83-529"><a href="#cb83-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>))</span>
<span id="cb83-530"><a href="#cb83-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">corrplot</span>(cor_matrix, </span>
<span id="cb83-531"><a href="#cb83-531" aria-hidden="true" tabindex="-1"></a>           <span class="at">method =</span> <span class="st">"color"</span>, </span>
<span id="cb83-532"><a href="#cb83-532" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"upper"</span>,</span>
<span id="cb83-533"><a href="#cb83-533" aria-hidden="true" tabindex="-1"></a>           <span class="at">tl.cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb83-534"><a href="#cb83-534" aria-hidden="true" tabindex="-1"></a>           <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb83-535"><a href="#cb83-535" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> title,</span>
<span id="cb83-536"><a href="#cb83-536" aria-hidden="true" tabindex="-1"></a>           <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>),</span>
<span id="cb83-537"><a href="#cb83-537" aria-hidden="true" tabindex="-1"></a>           <span class="at">addCoef.col =</span> <span class="st">"black"</span>,</span>
<span id="cb83-538"><a href="#cb83-538" aria-hidden="true" tabindex="-1"></a>           <span class="at">number.cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb83-539"><a href="#cb83-539" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-540"><a href="#cb83-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cor_matrix)</span>
<span id="cb83-541"><a href="#cb83-541" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-542"><a href="#cb83-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-543"><a href="#cb83-543" aria-hidden="true" tabindex="-1"></a><span class="co"># Check both designs</span></span>
<span id="cb83-544"><a href="#cb83-544" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb83-545"><a href="#cb83-545" aria-hidden="true" tabindex="-1"></a>balanced_cors <span class="ot">&lt;-</span> <span class="fu">check_orthogonality</span>(balanced_coffee, </span>
<span id="cb83-546"><a href="#cb83-546" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"Balanced Design</span><span class="sc">\n</span><span class="st">(Orthogonal)"</span>)</span>
<span id="cb83-547"><a href="#cb83-547" aria-hidden="true" tabindex="-1"></a>unbalanced_cors <span class="ot">&lt;-</span> <span class="fu">check_orthogonality</span>(unbalanced_coffee, </span>
<span id="cb83-548"><a href="#cb83-548" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"Unbalanced Design</span><span class="sc">\n</span><span class="st">(Non-orthogonal)"</span>)</span>
<span id="cb83-549"><a href="#cb83-549" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb83-550"><a href="#cb83-550" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-551"><a href="#cb83-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-552"><a href="#cb83-552" aria-hidden="true" tabindex="-1"></a>::::{.callout-important}</span>
<span id="cb83-553"><a href="#cb83-553" aria-hidden="true" tabindex="-1"></a><span class="fu">## Why Balanced Designs Make All Types Equal</span></span>
<span id="cb83-554"><a href="#cb83-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-555"><a href="#cb83-555" aria-hidden="true" tabindex="-1"></a>In balanced designs, the design vectors are **orthogonal** (uncorrelated):</span>
<span id="cb83-556"><a href="#cb83-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-557"><a href="#cb83-557" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Zero Correlation:** The correlation between coffee_type and time_of_day is 0</span>
<span id="cb83-558"><a href="#cb83-558" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**No Overlapping Variance:** Each factor explains completely separate portions of variance</span>
<span id="cb83-559"><a href="#cb83-559" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Order Doesn't Matter:** Since factors don't overlap, the sequence of testing is irrelevant</span>
<span id="cb83-560"><a href="#cb83-560" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Unique Contributions:** Each factor's contribution is unique and doesn't depend on others</span>
<span id="cb83-561"><a href="#cb83-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-562"><a href="#cb83-562" aria-hidden="true" tabindex="-1"></a>This is why balanced designs are so desirable in experimental research!</span>
<span id="cb83-563"><a href="#cb83-563" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb83-564"><a href="#cb83-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-565"><a href="#cb83-565" aria-hidden="true" tabindex="-1"></a><span class="fu">## Detailed Comparison Table</span></span>
<span id="cb83-566"><a href="#cb83-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-567"><a href="#cb83-567" aria-hidden="true" tabindex="-1"></a><span class="in">```{r detailed-comparison}</span></span>
<span id="cb83-568"><a href="#cb83-568" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a comprehensive comparison</span></span>
<span id="cb83-569"><a href="#cb83-569" aria-hidden="true" tabindex="-1"></a>compare_ss_types <span class="ot">&lt;-</span> <span class="cf">function</span>(data, design_name) {</span>
<span id="cb83-570"><a href="#cb83-570" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Type I (two orders)</span></span>
<span id="cb83-571"><a href="#cb83-571" aria-hidden="true" tabindex="-1"></a>  model_i_order1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(satisfaction <span class="sc">~</span> coffee_type <span class="sc">+</span> time_of_day, <span class="at">data =</span> data)</span>
<span id="cb83-572"><a href="#cb83-572" aria-hidden="true" tabindex="-1"></a>  model_i_order2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(satisfaction <span class="sc">~</span> time_of_day <span class="sc">+</span> coffee_type, <span class="at">data =</span> data)</span>
<span id="cb83-573"><a href="#cb83-573" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-574"><a href="#cb83-574" aria-hidden="true" tabindex="-1"></a>  type_i_order1 <span class="ot">&lt;-</span> <span class="fu">anova</span>(model_i_order1)</span>
<span id="cb83-575"><a href="#cb83-575" aria-hidden="true" tabindex="-1"></a>  type_i_order2 <span class="ot">&lt;-</span> <span class="fu">anova</span>(model_i_order2)</span>
<span id="cb83-576"><a href="#cb83-576" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-577"><a href="#cb83-577" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Type II</span></span>
<span id="cb83-578"><a href="#cb83-578" aria-hidden="true" tabindex="-1"></a>  type_ii <span class="ot">&lt;-</span> <span class="fu">Anova</span>(model_i_order1, <span class="at">type =</span> <span class="st">"II"</span>)</span>
<span id="cb83-579"><a href="#cb83-579" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-580"><a href="#cb83-580" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Type III (with proper contrasts)</span></span>
<span id="cb83-581"><a href="#cb83-581" aria-hidden="true" tabindex="-1"></a>  data_copy <span class="ot">&lt;-</span> data</span>
<span id="cb83-582"><a href="#cb83-582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrasts</span>(data_copy<span class="sc">$</span>coffee_type) <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="dv">2</span>)</span>
<span id="cb83-583"><a href="#cb83-583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrasts</span>(data_copy<span class="sc">$</span>time_of_day) <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="dv">2</span>)</span>
<span id="cb83-584"><a href="#cb83-584" aria-hidden="true" tabindex="-1"></a>  model_iii <span class="ot">&lt;-</span> <span class="fu">lm</span>(satisfaction <span class="sc">~</span> coffee_type <span class="sc">+</span> time_of_day, <span class="at">data =</span> data_copy)</span>
<span id="cb83-585"><a href="#cb83-585" aria-hidden="true" tabindex="-1"></a>  type_iii <span class="ot">&lt;-</span> <span class="fu">Anova</span>(model_iii, <span class="at">type =</span> <span class="st">"III"</span>)</span>
<span id="cb83-586"><a href="#cb83-586" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-587"><a href="#cb83-587" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create comparison table</span></span>
<span id="cb83-588"><a href="#cb83-588" aria-hidden="true" tabindex="-1"></a>  comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb83-589"><a href="#cb83-589" aria-hidden="true" tabindex="-1"></a>    <span class="at">Design =</span> design_name,</span>
<span id="cb83-590"><a href="#cb83-590" aria-hidden="true" tabindex="-1"></a>    <span class="at">Type =</span> <span class="fu">c</span>(<span class="st">"I (Coffee→Time)"</span>, <span class="st">"I (Time→Coffee)"</span>, <span class="st">"II"</span>, <span class="st">"III"</span>),</span>
<span id="cb83-591"><a href="#cb83-591" aria-hidden="true" tabindex="-1"></a>    <span class="at">Coffee_SS =</span> <span class="fu">c</span>(</span>
<span id="cb83-592"><a href="#cb83-592" aria-hidden="true" tabindex="-1"></a>      type_i_order1<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb83-593"><a href="#cb83-593" aria-hidden="true" tabindex="-1"></a>      type_i_order2<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">2</span>],</span>
<span id="cb83-594"><a href="#cb83-594" aria-hidden="true" tabindex="-1"></a>      type_ii<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb83-595"><a href="#cb83-595" aria-hidden="true" tabindex="-1"></a>      type_iii<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">2</span>]</span>
<span id="cb83-596"><a href="#cb83-596" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-597"><a href="#cb83-597" aria-hidden="true" tabindex="-1"></a>    <span class="at">Time_SS =</span> <span class="fu">c</span>(</span>
<span id="cb83-598"><a href="#cb83-598" aria-hidden="true" tabindex="-1"></a>      type_i_order1<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">2</span>],</span>
<span id="cb83-599"><a href="#cb83-599" aria-hidden="true" tabindex="-1"></a>      type_i_order2<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb83-600"><a href="#cb83-600" aria-hidden="true" tabindex="-1"></a>      type_ii<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">2</span>],</span>
<span id="cb83-601"><a href="#cb83-601" aria-hidden="true" tabindex="-1"></a>      type_iii<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">3</span>]</span>
<span id="cb83-602"><a href="#cb83-602" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-603"><a href="#cb83-603" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb83-604"><a href="#cb83-604" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-605"><a href="#cb83-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(comparison)</span>
<span id="cb83-606"><a href="#cb83-606" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-607"><a href="#cb83-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-608"><a href="#cb83-608" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare both designs</span></span>
<span id="cb83-609"><a href="#cb83-609" aria-hidden="true" tabindex="-1"></a>balanced_comparison <span class="ot">&lt;-</span> <span class="fu">compare_ss_types</span>(balanced_coffee, <span class="st">"Balanced"</span>)</span>
<span id="cb83-610"><a href="#cb83-610" aria-hidden="true" tabindex="-1"></a>unbalanced_comparison <span class="ot">&lt;-</span> <span class="fu">compare_ss_types</span>(unbalanced_coffee, <span class="st">"Unbalanced"</span>)</span>
<span id="cb83-611"><a href="#cb83-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-612"><a href="#cb83-612" aria-hidden="true" tabindex="-1"></a>full_comparison <span class="ot">&lt;-</span> <span class="fu">rbind</span>(balanced_comparison, unbalanced_comparison)</span>
<span id="cb83-613"><a href="#cb83-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-614"><a href="#cb83-614" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(full_comparison, <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb83-615"><a href="#cb83-615" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Sum of Squares Comparison: All Types, Both Designs"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-616"><a href="#cb83-616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-617"><a href="#cb83-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Balanced Design"</span>, <span class="dv">1</span>, <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-618"><a href="#cb83-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Unbalanced Design"</span>, <span class="dv">5</span>, <span class="dv">8</span>)</span>
<span id="cb83-619"><a href="#cb83-619" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-620"><a href="#cb83-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-621"><a href="#cb83-621" aria-hidden="true" tabindex="-1"></a><span class="fu"># Part 6: Variance Heterogeneity (Unequal Variances)</span></span>
<span id="cb83-622"><a href="#cb83-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-623"><a href="#cb83-623" aria-hidden="true" tabindex="-1"></a><span class="fu">## Creating Data with Unequal Variances</span></span>
<span id="cb83-624"><a href="#cb83-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-625"><a href="#cb83-625" aria-hidden="true" tabindex="-1"></a><span class="in">```{r variance-heterogeneity}</span></span>
<span id="cb83-626"><a href="#cb83-626" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb83-627"><a href="#cb83-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-628"><a href="#cb83-628" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data with very different variances</span></span>
<span id="cb83-629"><a href="#cb83-629" aria-hidden="true" tabindex="-1"></a>hetero_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb83-630"><a href="#cb83-630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb83-631"><a href="#cb83-631" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="st">"A"</span>,</span>
<span id="cb83-632"><a href="#cb83-632" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">2</span>)  <span class="co"># Small variance</span></span>
<span id="cb83-633"><a href="#cb83-633" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb83-634"><a href="#cb83-634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb83-635"><a href="#cb83-635" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="st">"B"</span>, </span>
<span id="cb83-636"><a href="#cb83-636" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">52</span>, <span class="at">sd =</span> <span class="dv">8</span>)  <span class="co"># Medium variance</span></span>
<span id="cb83-637"><a href="#cb83-637" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb83-638"><a href="#cb83-638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb83-639"><a href="#cb83-639" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="st">"C"</span>,</span>
<span id="cb83-640"><a href="#cb83-640" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">54</span>, <span class="at">sd =</span> <span class="dv">15</span>) <span class="co"># Large variance</span></span>
<span id="cb83-641"><a href="#cb83-641" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb83-642"><a href="#cb83-642" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb83-643"><a href="#cb83-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">factor</span>(group))</span>
<span id="cb83-644"><a href="#cb83-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-645"><a href="#cb83-645" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate actual variances</span></span>
<span id="cb83-646"><a href="#cb83-646" aria-hidden="true" tabindex="-1"></a>variance_summary <span class="ot">&lt;-</span> hetero_data <span class="sc">%&gt;%</span></span>
<span id="cb83-647"><a href="#cb83-647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span></span>
<span id="cb83-648"><a href="#cb83-648" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb83-649"><a href="#cb83-649" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean =</span> <span class="fu">mean</span>(value),</span>
<span id="cb83-650"><a href="#cb83-650" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variance =</span> <span class="fu">var</span>(value),</span>
<span id="cb83-651"><a href="#cb83-651" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">sd</span>(value),</span>
<span id="cb83-652"><a href="#cb83-652" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb83-653"><a href="#cb83-653" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb83-654"><a href="#cb83-654" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb83-655"><a href="#cb83-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-656"><a href="#cb83-656" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(variance_summary, <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb83-657"><a href="#cb83-657" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Group Statistics with Heterogeneous Variances"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-658"><a href="#cb83-658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span>
<span id="cb83-659"><a href="#cb83-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-660"><a href="#cb83-660" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the different variances</span></span>
<span id="cb83-661"><a href="#cb83-661" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(hetero_data, <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> value, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb83-662"><a href="#cb83-662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb83-663"><a href="#cb83-663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb83-664"><a href="#cb83-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heterogeneous Variances"</span>,</span>
<span id="cb83-665"><a href="#cb83-665" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Notice the very different spreads"</span>) <span class="sc">+</span></span>
<span id="cb83-666"><a href="#cb83-666" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb83-667"><a href="#cb83-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-668"><a href="#cb83-668" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(hetero_data, <span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb83-669"><a href="#cb83-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb83-670"><a href="#cb83-670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density Plot"</span>, </span>
<span id="cb83-671"><a href="#cb83-671" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Different widths = different variances"</span>) <span class="sc">+</span></span>
<span id="cb83-672"><a href="#cb83-672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb83-673"><a href="#cb83-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-674"><a href="#cb83-674" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span>
<span id="cb83-675"><a href="#cb83-675" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-676"><a href="#cb83-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-677"><a href="#cb83-677" aria-hidden="true" tabindex="-1"></a><span class="fu">## Testing for Homogeneity of Variance</span></span>
<span id="cb83-678"><a href="#cb83-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-679"><a href="#cb83-679" aria-hidden="true" tabindex="-1"></a><span class="in">```{r variance-tests}</span></span>
<span id="cb83-680"><a href="#cb83-680" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Testing for Equal Variances:"</span>)</span>
<span id="cb83-681"><a href="#cb83-681" aria-hidden="true" tabindex="-1"></a><span class="fu">sep_line</span>(<span class="st">"="</span>, <span class="dv">50</span>)</span>
<span id="cb83-682"><a href="#cb83-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-683"><a href="#cb83-683" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Levene's Test (robust to non-normality):"</span>)</span>
<span id="cb83-684"><a href="#cb83-684" aria-hidden="true" tabindex="-1"></a>levene_test <span class="ot">&lt;-</span> <span class="fu">leveneTest</span>(value <span class="sc">~</span> group, <span class="at">data =</span> hetero_data)</span>
<span id="cb83-685"><a href="#cb83-685" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(levene_test)</span>
<span id="cb83-686"><a href="#cb83-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-687"><a href="#cb83-687" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">""</span>)</span>
<span id="cb83-688"><a href="#cb83-688" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Bartlett's Test (sensitive to non-normality):"</span>)</span>
<span id="cb83-689"><a href="#cb83-689" aria-hidden="true" tabindex="-1"></a>bartlett_test <span class="ot">&lt;-</span> <span class="fu">bartlett.test</span>(value <span class="sc">~</span> group, <span class="at">data =</span> hetero_data)</span>
<span id="cb83-690"><a href="#cb83-690" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bartlett_test)</span>
<span id="cb83-691"><a href="#cb83-691" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-692"><a href="#cb83-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-693"><a href="#cb83-693" aria-hidden="true" tabindex="-1"></a>::::{.callout-warning}</span>
<span id="cb83-694"><a href="#cb83-694" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interpreting Variance Tests</span></span>
<span id="cb83-695"><a href="#cb83-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-696"><a href="#cb83-696" aria-hidden="true" tabindex="-1"></a>**Levene's Test:** p &lt; 0.05 indicates unequal variances (assumption violated)  </span>
<span id="cb83-697"><a href="#cb83-697" aria-hidden="true" tabindex="-1"></a>**Bartlett's Test:** More powerful but sensitive to non-normality</span>
<span id="cb83-698"><a href="#cb83-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-699"><a href="#cb83-699" aria-hidden="true" tabindex="-1"></a>**What to do with unequal variances:**</span>
<span id="cb83-700"><a href="#cb83-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-701"><a href="#cb83-701" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Use Welch's ANOVA instead of standard ANOVA</span>
<span id="cb83-702"><a href="#cb83-702" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Use Games-Howell post-hoc test instead of Tukey</span>
<span id="cb83-703"><a href="#cb83-703" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Consider transforming data (log, square root)</span>
<span id="cb83-704"><a href="#cb83-704" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Use robust methods or non-parametric alternatives</span>
<span id="cb83-705"><a href="#cb83-705" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb83-706"><a href="#cb83-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-707"><a href="#cb83-707" aria-hidden="true" tabindex="-1"></a><span class="fu">## Consequences of Ignoring Unequal Variances</span></span>
<span id="cb83-708"><a href="#cb83-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-709"><a href="#cb83-709" aria-hidden="true" tabindex="-1"></a><span class="in">```{r variance-consequences}</span></span>
<span id="cb83-710"><a href="#cb83-710" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard ANOVA (assumes equal variances)</span></span>
<span id="cb83-711"><a href="#cb83-711" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Standard ANOVA (assumes equal variances):"</span>)</span>
<span id="cb83-712"><a href="#cb83-712" aria-hidden="true" tabindex="-1"></a>standard_anova <span class="ot">&lt;-</span> <span class="fu">aov</span>(value <span class="sc">~</span> group, <span class="at">data =</span> hetero_data)</span>
<span id="cb83-713"><a href="#cb83-713" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(standard_anova)</span>
<span id="cb83-714"><a href="#cb83-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-715"><a href="#cb83-715" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">""</span>)</span>
<span id="cb83-716"><a href="#cb83-716" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Welch's ANOVA (robust to unequal variances):"</span>)</span>
<span id="cb83-717"><a href="#cb83-717" aria-hidden="true" tabindex="-1"></a>welch_test <span class="ot">&lt;-</span> <span class="fu">oneway.test</span>(value <span class="sc">~</span> group, <span class="at">data =</span> hetero_data, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb83-718"><a href="#cb83-718" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(welch_test)</span>
<span id="cb83-719"><a href="#cb83-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-720"><a href="#cb83-720" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare p-values</span></span>
<span id="cb83-721"><a href="#cb83-721" aria-hidden="true" tabindex="-1"></a>comparison_pvalues <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb83-722"><a href="#cb83-722" aria-hidden="true" tabindex="-1"></a>  <span class="at">Test =</span> <span class="fu">c</span>(<span class="st">"Standard ANOVA"</span>, <span class="st">"Welch's ANOVA"</span>),</span>
<span id="cb83-723"><a href="#cb83-723" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Assumes Equal Variances</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>),</span>
<span id="cb83-724"><a href="#cb83-724" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">summary</span>(standard_anova)[[<span class="dv">1</span>]]<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>], welch_test<span class="sc">$</span>p.value),</span>
<span id="cb83-725"><a href="#cb83-725" aria-hidden="true" tabindex="-1"></a>  <span class="at">Decision =</span> <span class="fu">c</span>(</span>
<span id="cb83-726"><a href="#cb83-726" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(<span class="fu">summary</span>(standard_anova)[[<span class="dv">1</span>]]<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>] <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Reject H0"</span>, <span class="st">"Fail to reject H0"</span>),</span>
<span id="cb83-727"><a href="#cb83-727" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(welch_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Reject H0"</span>, <span class="st">"Fail to reject H0"</span>)</span>
<span id="cb83-728"><a href="#cb83-728" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb83-729"><a href="#cb83-729" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb83-730"><a href="#cb83-730" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-731"><a href="#cb83-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-732"><a href="#cb83-732" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(comparison_pvalues, <span class="at">digits =</span> <span class="dv">4</span>,</span>
<span id="cb83-733"><a href="#cb83-733" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Comparison: Standard vs Welch's ANOVA with Unequal Variances"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-734"><a href="#cb83-734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span>
<span id="cb83-735"><a href="#cb83-735" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-736"><a href="#cb83-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-737"><a href="#cb83-737" aria-hidden="true" tabindex="-1"></a><span class="fu"># Part 7: Complete Analysis Pipeline</span></span>
<span id="cb83-738"><a href="#cb83-738" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step-by-Step Analysis Function</span></span>
<span id="cb83-741"><a href="#cb83-741" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-742"><a href="#cb83-742" aria-hidden="true" tabindex="-1"></a>analyze_data_complete <span class="ot">&lt;-</span> <span class="cf">function</span>(data, dv, factors) {</span>
<span id="cb83-743"><a href="#cb83-743" aria-hidden="true" tabindex="-1"></a>  formula_str <span class="ot">&lt;-</span> <span class="fu">paste</span>(dv, <span class="st">"~"</span>, <span class="fu">paste</span>(factors, <span class="at">collapse =</span> <span class="st">" * "</span>))</span>
<span id="cb83-744"><a href="#cb83-744" aria-hidden="true" tabindex="-1"></a>  formula_obj <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(formula_str)</span>
<span id="cb83-745"><a href="#cb83-745" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-746"><a href="#cb83-746" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sep_line</span>(<span class="st">"="</span>, <span class="dv">60</span>)</span>
<span id="cb83-747"><a href="#cb83-747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"COMPLETE ANOVA ANALYSIS PIPELINE"</span>)</span>
<span id="cb83-748"><a href="#cb83-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sep_line</span>(<span class="st">"="</span>, <span class="dv">60</span>)</span>
<span id="cb83-749"><a href="#cb83-749" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-750"><a href="#cb83-750" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1. Check balance</span></span>
<span id="cb83-751"><a href="#cb83-751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">""</span>)</span>
<span id="cb83-752"><a href="#cb83-752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"STEP 1: CHECKING BALANCE"</span>)</span>
<span id="cb83-753"><a href="#cb83-753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sep_line</span>(<span class="st">"-"</span>, <span class="dv">40</span>)</span>
<span id="cb83-754"><a href="#cb83-754" aria-hidden="true" tabindex="-1"></a>  design_table <span class="ot">&lt;-</span> <span class="fu">table</span>(data[[factors[<span class="dv">1</span>]]], data[[factors[<span class="dv">2</span>]]])</span>
<span id="cb83-755"><a href="#cb83-755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(design_table)</span>
<span id="cb83-756"><a href="#cb83-756" aria-hidden="true" tabindex="-1"></a>  is_balanced <span class="ot">&lt;-</span> <span class="fu">all</span>(design_table <span class="sc">==</span> design_table[<span class="dv">1</span>])</span>
<span id="cb83-757"><a href="#cb83-757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Design is"</span>, <span class="fu">ifelse</span>(is_balanced, <span class="st">"BALANCED ✓"</span>, <span class="st">"UNBALANCED ⚠️"</span>)))</span>
<span id="cb83-758"><a href="#cb83-758" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-759"><a href="#cb83-759" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2. Fit model</span></span>
<span id="cb83-760"><a href="#cb83-760" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">aov</span>(formula_obj, <span class="at">data =</span> data)</span>
<span id="cb83-761"><a href="#cb83-761" aria-hidden="true" tabindex="-1"></a>  anova_table <span class="ot">&lt;-</span> <span class="fu">anova</span>(model)</span>
<span id="cb83-762"><a href="#cb83-762" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-763"><a href="#cb83-763" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3. Check assumptions</span></span>
<span id="cb83-764"><a href="#cb83-764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">""</span>)</span>
<span id="cb83-765"><a href="#cb83-765" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"STEP 2: CHECKING ASSUMPTIONS"</span>)</span>
<span id="cb83-766"><a href="#cb83-766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sep_line</span>(<span class="st">"-"</span>, <span class="dv">40</span>)</span>
<span id="cb83-767"><a href="#cb83-767" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Normality of residuals</span></span>
<span id="cb83-768"><a href="#cb83-768" aria-hidden="true" tabindex="-1"></a>  shapiro_p <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(model))<span class="sc">$</span>p.value</span>
<span id="cb83-769"><a href="#cb83-769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Shapiro-Wilk test p ="</span>, <span class="fu">signif</span>(shapiro_p, <span class="dv">3</span>)))</span>
<span id="cb83-770"><a href="#cb83-770" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Homogeneity of variances</span></span>
<span id="cb83-771"><a href="#cb83-771" aria-hidden="true" tabindex="-1"></a>  levene_p <span class="ot">&lt;-</span> car<span class="sc">::</span><span class="fu">leveneTest</span>(formula_obj, <span class="at">data =</span> data)<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>]</span>
<span id="cb83-772"><a href="#cb83-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Levene’s test p ="</span>, <span class="fu">signif</span>(levene_p, <span class="dv">3</span>)))</span>
<span id="cb83-773"><a href="#cb83-773" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-774"><a href="#cb83-774" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 4. Effect sizes (eta squared)</span></span>
<span id="cb83-775"><a href="#cb83-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">""</span>)</span>
<span id="cb83-776"><a href="#cb83-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"STEP 3: EFFECT SIZE (η²)"</span>)</span>
<span id="cb83-777"><a href="#cb83-777" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sep_line</span>(<span class="st">"-"</span>, <span class="dv">40</span>)</span>
<span id="cb83-778"><a href="#cb83-778" aria-hidden="true" tabindex="-1"></a>  ss_total <span class="ot">&lt;-</span> <span class="fu">sum</span>(anova_table[[<span class="st">"Sum Sq"</span>]])</span>
<span id="cb83-779"><a href="#cb83-779" aria-hidden="true" tabindex="-1"></a>  ss_effects <span class="ot">&lt;-</span> anova_table[[<span class="st">"Sum Sq"</span>]][<span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(factors) <span class="sc">+</span> <span class="dv">1</span>)]</span>
<span id="cb83-780"><a href="#cb83-780" aria-hidden="true" tabindex="-1"></a>  eta_squared <span class="ot">&lt;-</span> ss_effects <span class="sc">/</span> ss_total</span>
<span id="cb83-781"><a href="#cb83-781" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-782"><a href="#cb83-782" aria-hidden="true" tabindex="-1"></a>  effect_names <span class="ot">&lt;-</span> <span class="fu">rownames</span>(anova_table)[<span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(factors) <span class="sc">+</span> <span class="dv">1</span>)]</span>
<span id="cb83-783"><a href="#cb83-783" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(eta_squared)) {</span>
<span id="cb83-784"><a href="#cb83-784" aria-hidden="true" tabindex="-1"></a>    result_text <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%s: η² = %.3f "</span>, effect_names[i], eta_squared[i])</span>
<span id="cb83-785"><a href="#cb83-785" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (eta_squared[i] <span class="sc">&lt;</span> <span class="fl">0.01</span>) {</span>
<span id="cb83-786"><a href="#cb83-786" aria-hidden="true" tabindex="-1"></a>      result_text <span class="ot">&lt;-</span> <span class="fu">paste0</span>(result_text, <span class="st">"(negligible)"</span>)</span>
<span id="cb83-787"><a href="#cb83-787" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (eta_squared[i] <span class="sc">&lt;</span> <span class="fl">0.06</span>) {</span>
<span id="cb83-788"><a href="#cb83-788" aria-hidden="true" tabindex="-1"></a>      result_text <span class="ot">&lt;-</span> <span class="fu">paste0</span>(result_text, <span class="st">"(small)"</span>)</span>
<span id="cb83-789"><a href="#cb83-789" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (eta_squared[i] <span class="sc">&lt;</span> <span class="fl">0.14</span>) {</span>
<span id="cb83-790"><a href="#cb83-790" aria-hidden="true" tabindex="-1"></a>      result_text <span class="ot">&lt;-</span> <span class="fu">paste0</span>(result_text, <span class="st">"(medium)"</span>)</span>
<span id="cb83-791"><a href="#cb83-791" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb83-792"><a href="#cb83-792" aria-hidden="true" tabindex="-1"></a>      result_text <span class="ot">&lt;-</span> <span class="fu">paste0</span>(result_text, <span class="st">"(large)"</span>)</span>
<span id="cb83-793"><a href="#cb83-793" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb83-794"><a href="#cb83-794" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(result_text)</span>
<span id="cb83-795"><a href="#cb83-795" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb83-796"><a href="#cb83-796" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-797"><a href="#cb83-797" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 5. Post-hoc tests</span></span>
<span id="cb83-798"><a href="#cb83-798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">""</span>)</span>
<span id="cb83-799"><a href="#cb83-799" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"STEP 5: POST-HOC COMPARISONS"</span>)</span>
<span id="cb83-800"><a href="#cb83-800" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sep_line</span>(<span class="st">"-"</span>, <span class="dv">40</span>)</span>
<span id="cb83-801"><a href="#cb83-801" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (levene_p <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb83-802"><a href="#cb83-802" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Using Games-Howell (unequal variances)"</span>)</span>
<span id="cb83-803"><a href="#cb83-803" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Implement Games-Howell here if needed</span></span>
<span id="cb83-804"><a href="#cb83-804" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb83-805"><a href="#cb83-805" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Using Tukey HSD (equal variances)"</span>)</span>
<span id="cb83-806"><a href="#cb83-806" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (is_balanced) {</span>
<span id="cb83-807"><a href="#cb83-807" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">TukeyHSD</span>(model))</span>
<span id="cb83-808"><a href="#cb83-808" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb83-809"><a href="#cb83-809" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb83-810"><a href="#cb83-810" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-811"><a href="#cb83-811" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">invisible</span>(model))</span>
<span id="cb83-812"><a href="#cb83-812" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-813"><a href="#cb83-813" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the pipeline on unbalanced_coffee</span></span>
<span id="cb83-814"><a href="#cb83-814" aria-hidden="true" tabindex="-1"></a>final_model <span class="ot">&lt;-</span> <span class="fu">analyze_data_complete</span>(</span>
<span id="cb83-815"><a href="#cb83-815" aria-hidden="true" tabindex="-1"></a>  unbalanced_coffee,</span>
<span id="cb83-816"><a href="#cb83-816" aria-hidden="true" tabindex="-1"></a>  <span class="st">"satisfaction"</span>,</span>
<span id="cb83-817"><a href="#cb83-817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"coffee_type"</span>, <span class="st">"time_of_day"</span>)</span>
<span id="cb83-818"><a href="#cb83-818" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-819"><a href="#cb83-819" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-820"><a href="#cb83-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-821"><a href="#cb83-821" aria-hidden="true" tabindex="-1"></a><span class="fu"># Part 8: Practical Decision Tree</span></span>
<span id="cb83-822"><a href="#cb83-822" aria-hidden="true" tabindex="-1"></a><span class="fu">## When to Use Which Type?</span></span>
<span id="cb83-823"><a href="#cb83-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-826"><a href="#cb83-826" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-827"><a href="#cb83-827" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a decision guide</span></span>
<span id="cb83-828"><a href="#cb83-828" aria-hidden="true" tabindex="-1"></a>decision_guide <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb83-829"><a href="#cb83-829" aria-hidden="true" tabindex="-1"></a>  <span class="at">Scenario =</span> <span class="fu">c</span>(</span>
<span id="cb83-830"><a href="#cb83-830" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Balanced design"</span>,</span>
<span id="cb83-831"><a href="#cb83-831" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Unbalanced + No interaction"</span>,</span>
<span id="cb83-832"><a href="#cb83-832" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Unbalanced + Significant interaction"</span>,</span>
<span id="cb83-833"><a href="#cb83-833" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Natural hierarchy of factors"</span>,</span>
<span id="cb83-834"><a href="#cb83-834" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Exploratory analysis"</span>,</span>
<span id="cb83-835"><a href="#cb83-835" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Following field conventions"</span></span>
<span id="cb83-836"><a href="#cb83-836" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb83-837"><a href="#cb83-837" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Recommended Type</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb83-838"><a href="#cb83-838" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Any (all equal)"</span>,</span>
<span id="cb83-839"><a href="#cb83-839" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Type II"</span>,</span>
<span id="cb83-840"><a href="#cb83-840" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Type III"</span>,</span>
<span id="cb83-841"><a href="#cb83-841" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Type I"</span>,</span>
<span id="cb83-842"><a href="#cb83-842" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Type III"</span>,</span>
<span id="cb83-843"><a href="#cb83-843" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Check literature"</span></span>
<span id="cb83-844"><a href="#cb83-844" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb83-845"><a href="#cb83-845" aria-hidden="true" tabindex="-1"></a>  <span class="at">Reasoning =</span> <span class="fu">c</span>(</span>
<span id="cb83-846"><a href="#cb83-846" aria-hidden="true" tabindex="-1"></a>    <span class="st">"All types give identical results with balanced data"</span>,</span>
<span id="cb83-847"><a href="#cb83-847" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Type II tests main effects properly without interaction assumption"</span>,</span>
<span id="cb83-848"><a href="#cb83-848" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Type III tests main effects in presence of interaction"</span>,</span>
<span id="cb83-849"><a href="#cb83-849" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Type I respects the causal/temporal order"</span>,</span>
<span id="cb83-850"><a href="#cb83-850" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Type III is most conservative"</span>,</span>
<span id="cb83-851"><a href="#cb83-851" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Some fields have established preferences"</span></span>
<span id="cb83-852"><a href="#cb83-852" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb83-853"><a href="#cb83-853" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb83-854"><a href="#cb83-854" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-855"><a href="#cb83-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-856"><a href="#cb83-856" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(decision_guide, </span>
<span id="cb83-857"><a href="#cb83-857" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Decision Guide for Choosing ANOVA Type"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-858"><a href="#cb83-858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span>
<span id="cb83-859"><a href="#cb83-859" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-860"><a href="#cb83-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-861"><a href="#cb83-861" aria-hidden="true" tabindex="-1"></a><span class="fu"># Part 9: Quick Reference Functions</span></span>
<span id="cb83-862"><a href="#cb83-862" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparison Function for All Three Types</span></span>
<span id="cb83-865"><a href="#cb83-865" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-866"><a href="#cb83-866" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick function to compare all three types</span></span>
<span id="cb83-867"><a href="#cb83-867" aria-hidden="true" tabindex="-1"></a>compare_anova_types <span class="ot">&lt;-</span> <span class="cf">function</span>(formula, data, <span class="at">verbose =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb83-868"><a href="#cb83-868" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(car)</span>
<span id="cb83-869"><a href="#cb83-869" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-870"><a href="#cb83-870" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure factors</span></span>
<span id="cb83-871"><a href="#cb83-871" aria-hidden="true" tabindex="-1"></a>  factors <span class="ot">&lt;-</span> <span class="fu">all.vars</span>(formula)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb83-872"><a href="#cb83-872" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(f <span class="cf">in</span> factors) {</span>
<span id="cb83-873"><a href="#cb83-873" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(f <span class="sc">%in%</span> <span class="fu">names</span>(data)) {</span>
<span id="cb83-874"><a href="#cb83-874" aria-hidden="true" tabindex="-1"></a>      data[[f]] <span class="ot">&lt;-</span> <span class="fu">factor</span>(data[[f]])</span>
<span id="cb83-875"><a href="#cb83-875" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb83-876"><a href="#cb83-876" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb83-877"><a href="#cb83-877" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-878"><a href="#cb83-878" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check balance</span></span>
<span id="cb83-879"><a href="#cb83-879" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(factors) <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb83-880"><a href="#cb83-880" aria-hidden="true" tabindex="-1"></a>    design_table <span class="ot">&lt;-</span> <span class="fu">table</span>(data[[factors[<span class="dv">1</span>]]], data[[factors[<span class="dv">2</span>]]])</span>
<span id="cb83-881"><a href="#cb83-881" aria-hidden="true" tabindex="-1"></a>    is_balanced <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">as.vector</span>(design_table))) <span class="sc">==</span> <span class="dv">1</span></span>
<span id="cb83-882"><a href="#cb83-882" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb83-883"><a href="#cb83-883" aria-hidden="true" tabindex="-1"></a>    is_balanced <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb83-884"><a href="#cb83-884" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb83-885"><a href="#cb83-885" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-886"><a href="#cb83-886" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Type I</span></span>
<span id="cb83-887"><a href="#cb83-887" aria-hidden="true" tabindex="-1"></a>  model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula, <span class="at">data =</span> data)</span>
<span id="cb83-888"><a href="#cb83-888" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-889"><a href="#cb83-889" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Type II</span></span>
<span id="cb83-890"><a href="#cb83-890" aria-hidden="true" tabindex="-1"></a>  model2 <span class="ot">&lt;-</span> model1</span>
<span id="cb83-891"><a href="#cb83-891" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-892"><a href="#cb83-892" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Type III (need sum contrasts)</span></span>
<span id="cb83-893"><a href="#cb83-893" aria-hidden="true" tabindex="-1"></a>  data_type3 <span class="ot">&lt;-</span> data</span>
<span id="cb83-894"><a href="#cb83-894" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(f <span class="cf">in</span> factors) {</span>
<span id="cb83-895"><a href="#cb83-895" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(f <span class="sc">%in%</span> <span class="fu">names</span>(data_type3)) {</span>
<span id="cb83-896"><a href="#cb83-896" aria-hidden="true" tabindex="-1"></a>      <span class="fu">contrasts</span>(data_type3[[f]]) <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="fu">nlevels</span>(data_type3[[f]]))</span>
<span id="cb83-897"><a href="#cb83-897" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb83-898"><a href="#cb83-898" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb83-899"><a href="#cb83-899" aria-hidden="true" tabindex="-1"></a>  model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula, <span class="at">data =</span> data_type3)</span>
<span id="cb83-900"><a href="#cb83-900" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-901"><a href="#cb83-901" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store results</span></span>
<span id="cb83-902"><a href="#cb83-902" aria-hidden="true" tabindex="-1"></a>  type1_anova <span class="ot">&lt;-</span> <span class="fu">anova</span>(model1)</span>
<span id="cb83-903"><a href="#cb83-903" aria-hidden="true" tabindex="-1"></a>  type2_anova <span class="ot">&lt;-</span> <span class="fu">Anova</span>(model2, <span class="at">type =</span> <span class="st">"II"</span>)</span>
<span id="cb83-904"><a href="#cb83-904" aria-hidden="true" tabindex="-1"></a>  type3_anova <span class="ot">&lt;-</span> <span class="fu">Anova</span>(model3, <span class="at">type =</span> <span class="st">"III"</span>)</span>
<span id="cb83-905"><a href="#cb83-905" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-906"><a href="#cb83-906" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(verbose) {</span>
<span id="cb83-907"><a href="#cb83-907" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"========== TYPE I (Sequential) =========="</span>)</span>
<span id="cb83-908"><a href="#cb83-908" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(type1_anova)</span>
<span id="cb83-909"><a href="#cb83-909" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb83-910"><a href="#cb83-910" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">""</span>)</span>
<span id="cb83-911"><a href="#cb83-911" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"========== TYPE II (No Interaction) =========="</span>)</span>
<span id="cb83-912"><a href="#cb83-912" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(type2_anova)</span>
<span id="cb83-913"><a href="#cb83-913" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb83-914"><a href="#cb83-914" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">""</span>)</span>
<span id="cb83-915"><a href="#cb83-915" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"========== TYPE III (Marginal) =========="</span>)</span>
<span id="cb83-916"><a href="#cb83-916" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(type3_anova)</span>
<span id="cb83-917"><a href="#cb83-917" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb83-918"><a href="#cb83-918" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">""</span>)</span>
<span id="cb83-919"><a href="#cb83-919" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"========== RECOMMENDATION =========="</span>)</span>
<span id="cb83-920"><a href="#cb83-920" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb83-921"><a href="#cb83-921" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(is_balanced) {</span>
<span id="cb83-922"><a href="#cb83-922" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">"✓ Balanced design detected - all types equivalent"</span>)</span>
<span id="cb83-923"><a href="#cb83-923" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">"→ Use Type I for computational efficiency"</span>)</span>
<span id="cb83-924"><a href="#cb83-924" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb83-925"><a href="#cb83-925" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">"⚠️ Unbalanced design detected"</span>)</span>
<span id="cb83-926"><a href="#cb83-926" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb83-927"><a href="#cb83-927" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Check for interaction</span></span>
<span id="cb83-928"><a href="#cb83-928" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">length</span>(factors) <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb83-929"><a href="#cb83-929" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get interaction p-value</span></span>
<span id="cb83-930"><a href="#cb83-930" aria-hidden="true" tabindex="-1"></a>        interaction_term <span class="ot">&lt;-</span> <span class="fu">paste</span>(factors, <span class="at">collapse =</span> <span class="st">":"</span>)</span>
<span id="cb83-931"><a href="#cb83-931" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(interaction_term <span class="sc">%in%</span> <span class="fu">rownames</span>(type2_anova)) {</span>
<span id="cb83-932"><a href="#cb83-932" aria-hidden="true" tabindex="-1"></a>          interaction_p <span class="ot">&lt;-</span> type2_anova[interaction_term, <span class="st">"Pr(&gt;F)"</span>]</span>
<span id="cb83-933"><a href="#cb83-933" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(interaction_p) <span class="sc">&amp;&amp;</span> interaction_p <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb83-934"><a href="#cb83-934" aria-hidden="true" tabindex="-1"></a>            <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"→ Significant interaction (p ="</span>, <span class="fu">round</span>(interaction_p, <span class="dv">3</span>), <span class="st">")"</span>))</span>
<span id="cb83-935"><a href="#cb83-935" aria-hidden="true" tabindex="-1"></a>            <span class="fu">print</span>(<span class="st">"→ RECOMMEND: Type III for main effects interpretation"</span>)</span>
<span id="cb83-936"><a href="#cb83-936" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> {</span>
<span id="cb83-937"><a href="#cb83-937" aria-hidden="true" tabindex="-1"></a>            <span class="fu">print</span>(<span class="st">"→ No significant interaction"</span>)</span>
<span id="cb83-938"><a href="#cb83-938" aria-hidden="true" tabindex="-1"></a>            <span class="fu">print</span>(<span class="st">"→ RECOMMEND: Type II for main effects testing"</span>)</span>
<span id="cb83-939"><a href="#cb83-939" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb83-940"><a href="#cb83-940" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb83-941"><a href="#cb83-941" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb83-942"><a href="#cb83-942" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb83-943"><a href="#cb83-943" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb83-944"><a href="#cb83-944" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-945"><a href="#cb83-945" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return results as a list</span></span>
<span id="cb83-946"><a href="#cb83-946" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">invisible</span>(<span class="fu">list</span>(</span>
<span id="cb83-947"><a href="#cb83-947" aria-hidden="true" tabindex="-1"></a>    <span class="at">type1 =</span> type1_anova,</span>
<span id="cb83-948"><a href="#cb83-948" aria-hidden="true" tabindex="-1"></a>    <span class="at">type2 =</span> type2_anova, </span>
<span id="cb83-949"><a href="#cb83-949" aria-hidden="true" tabindex="-1"></a>    <span class="at">type3 =</span> type3_anova,</span>
<span id="cb83-950"><a href="#cb83-950" aria-hidden="true" tabindex="-1"></a>    <span class="at">balanced =</span> is_balanced</span>
<span id="cb83-951"><a href="#cb83-951" aria-hidden="true" tabindex="-1"></a>  )))</span>
<span id="cb83-952"><a href="#cb83-952" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-953"><a href="#cb83-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-954"><a href="#cb83-954" aria-hidden="true" tabindex="-1"></a><span class="co"># Test the function</span></span>
<span id="cb83-955"><a href="#cb83-955" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Testing the comparison function with our coffee data:"</span>)</span>
<span id="cb83-956"><a href="#cb83-956" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">compare_anova_types</span>(satisfaction <span class="sc">~</span> coffee_type <span class="sc">*</span> time_of_day, </span>
<span id="cb83-957"><a href="#cb83-957" aria-hidden="true" tabindex="-1"></a>                              unbalanced_coffee, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb83-958"><a href="#cb83-958" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-959"><a href="#cb83-959" aria-hidden="true" tabindex="-1"></a><span class="fu"># Part 10: Summary and Key Takeaways</span></span>
<span id="cb83-960"><a href="#cb83-960" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Essential Points</span></span>
<span id="cb83-961"><a href="#cb83-961" aria-hidden="true" tabindex="-1"></a>::::{.callout-note}</span>
<span id="cb83-962"><a href="#cb83-962" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key Takeaways</span></span>
<span id="cb83-963"><a href="#cb83-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-964"><a href="#cb83-964" aria-hidden="true" tabindex="-1"></a>**1. ANOVA Types exist because of unbalanced designs**  </span>
<span id="cb83-965"><a href="#cb83-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-966"><a href="#cb83-966" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Balanced designs: All types give same results</span>
<span id="cb83-967"><a href="#cb83-967" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Unbalanced designs: Results differ, choice matters</span>
<span id="cb83-968"><a href="#cb83-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-969"><a href="#cb83-969" aria-hidden="true" tabindex="-1"></a>**2. Type I (Sequential)**  </span>
<span id="cb83-970"><a href="#cb83-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-971"><a href="#cb83-971" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Tests each factor after those before it</span>
<span id="cb83-972"><a href="#cb83-972" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Order matters!</span>
<span id="cb83-973"><a href="#cb83-973" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use when: You have a natural hierarchy</span>
<span id="cb83-974"><a href="#cb83-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-975"><a href="#cb83-975" aria-hidden="true" tabindex="-1"></a>**3. Type II (Hierarchical)**  </span>
<span id="cb83-976"><a href="#cb83-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-977"><a href="#cb83-977" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Tests main effects adjusting for other main effects</span>
<span id="cb83-978"><a href="#cb83-978" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Assumes no interaction</span>
<span id="cb83-979"><a href="#cb83-979" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use when: Testing main effects, interaction not significant</span>
<span id="cb83-980"><a href="#cb83-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-981"><a href="#cb83-981" aria-hidden="true" tabindex="-1"></a>**4. Type III (Marginal)**  </span>
<span id="cb83-982"><a href="#cb83-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-983"><a href="#cb83-983" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Tests each effect adjusting for all others</span>
<span id="cb83-984"><a href="#cb83-984" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Most conservative</span>
<span id="cb83-985"><a href="#cb83-985" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use when: Interaction is significant</span>
<span id="cb83-986"><a href="#cb83-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-987"><a href="#cb83-987" aria-hidden="true" tabindex="-1"></a>**5. Practical Advice**  </span>
<span id="cb83-988"><a href="#cb83-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-989"><a href="#cb83-989" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Always check assumptions first</span>
<span id="cb83-990"><a href="#cb83-990" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Report which type you used and why</span>
<span id="cb83-991"><a href="#cb83-991" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Consider effect sizes, not just p-values</span>
<span id="cb83-992"><a href="#cb83-992" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Be transparent about unbalanced designs</span>
<span id="cb83-993"><a href="#cb83-993" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb83-994"><a href="#cb83-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-995"><a href="#cb83-995" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mathematical Summary  </span></span>
<span id="cb83-996"><a href="#cb83-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-997"><a href="#cb83-997" aria-hidden="true" tabindex="-1"></a>The fundamental difference is in the hypotheses being tested:</span>
<span id="cb83-998"><a href="#cb83-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-999"><a href="#cb83-999" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Type I (Sequential):**  </span>
<span id="cb83-1000"><a href="#cb83-1000" aria-hidden="true" tabindex="-1"></a>  $H_0: \alpha_i = 0 \;|\; \mu$</span>
<span id="cb83-1001"><a href="#cb83-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1002"><a href="#cb83-1002" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Type II (No interaction):**  </span>
<span id="cb83-1003"><a href="#cb83-1003" aria-hidden="true" tabindex="-1"></a>  $H_0: \alpha_i = 0 \;|\; \mu, \beta_j$</span>
<span id="cb83-1004"><a href="#cb83-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1005"><a href="#cb83-1005" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Type III (Marginal):**  </span>
<span id="cb83-1006"><a href="#cb83-1006" aria-hidden="true" tabindex="-1"></a>  $H_0: \alpha_i = 0 \;|\; \mu, \beta_j, (\alpha\beta)_{ij}$</span>
<span id="cb83-1007"><a href="#cb83-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1008"><a href="#cb83-1008" aria-hidden="true" tabindex="-1"></a>Here, the vertical bar “$\;|\;$” means “given that we’ve already accounted for …”.</span>
<span id="cb83-1009"><a href="#cb83-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1010"><a href="#cb83-1010" aria-hidden="true" tabindex="-1"></a>Visual Summary of Differences</span>
<span id="cb83-1013"><a href="#cb83-1013" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-1014"><a href="#cb83-1014" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a visual summary of when each type "claims" variance</span></span>
<span id="cb83-1015"><a href="#cb83-1015" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb83-1016"><a href="#cb83-1016" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb83-1017"><a href="#cb83-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1018"><a href="#cb83-1018" aria-hidden="true" tabindex="-1"></a><span class="co"># Create conceptual data for visualization</span></span>
<span id="cb83-1019"><a href="#cb83-1019" aria-hidden="true" tabindex="-1"></a>variance_allocation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb83-1020"><a href="#cb83-1020" aria-hidden="true" tabindex="-1"></a>  <span class="at">Type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Type I"</span>, <span class="st">"Type II"</span>, <span class="st">"Type III"</span>), <span class="at">each =</span> <span class="dv">3</span>),</span>
<span id="cb83-1021"><a href="#cb83-1021" aria-hidden="true" tabindex="-1"></a>  <span class="at">Component =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Coffee Unique"</span>, <span class="st">"Shared"</span>, <span class="st">"Time Unique"</span>), <span class="dv">3</span>),</span>
<span id="cb83-1022"><a href="#cb83-1022" aria-hidden="true" tabindex="-1"></a>  <span class="at">Allocation =</span> <span class="fu">c</span>(</span>
<span id="cb83-1023"><a href="#cb83-1023" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Type I: Coffee gets unique + shared</span></span>
<span id="cb83-1024"><a href="#cb83-1024" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">0</span>,  <span class="co"># Coffee tested first gets all shared</span></span>
<span id="cb83-1025"><a href="#cb83-1025" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Type II: Each gets only unique</span></span>
<span id="cb83-1026"><a href="#cb83-1026" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span>, <span class="dv">50</span>, <span class="dv">100</span>,  <span class="co"># Shared split conceptually</span></span>
<span id="cb83-1027"><a href="#cb83-1027" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Type III: Most conservative</span></span>
<span id="cb83-1028"><a href="#cb83-1028" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">100</span>   <span class="co"># Neither gets shared</span></span>
<span id="cb83-1029"><a href="#cb83-1029" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb83-1030"><a href="#cb83-1030" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-1031"><a href="#cb83-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1032"><a href="#cb83-1032" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(variance_allocation, <span class="fu">aes</span>(<span class="at">x =</span> Component, <span class="at">y =</span> Allocation, <span class="at">fill =</span> Type)) <span class="sc">+</span></span>
<span id="cb83-1033"><a href="#cb83-1033" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb83-1034"><a href="#cb83-1034" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Conceptual Variance Allocation by ANOVA Type"</span>,</span>
<span id="cb83-1035"><a href="#cb83-1035" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"How each type 'claims' variance in unbalanced designs"</span>,</span>
<span id="cb83-1036"><a href="#cb83-1036" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Variance Allocated (%)"</span>,</span>
<span id="cb83-1037"><a href="#cb83-1037" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Variance Component"</span>) <span class="sc">+</span></span>
<span id="cb83-1038"><a href="#cb83-1038" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb83-1039"><a href="#cb83-1039" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>)</span>
<span id="cb83-1040"><a href="#cb83-1040" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-1041"><a href="#cb83-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1042"><a href="#cb83-1042" aria-hidden="true" tabindex="-1"></a>Final Recommendations Table</span>
<span id="cb83-1045"><a href="#cb83-1045" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-1046"><a href="#cb83-1046" aria-hidden="true" tabindex="-1"></a>final_recommendations <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb83-1047"><a href="#cb83-1047" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Research Question</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb83-1048"><a href="#cb83-1048" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Do factors A and B affect the outcome?"</span>,</span>
<span id="cb83-1049"><a href="#cb83-1049" aria-hidden="true" tabindex="-1"></a>    <span class="st">"What is the unique contribution of A?"</span>,</span>
<span id="cb83-1050"><a href="#cb83-1050" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Does A matter after controlling for everything?"</span>,</span>
<span id="cb83-1051"><a href="#cb83-1051" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Following a causal chain A→B→C"</span>,</span>
<span id="cb83-1052"><a href="#cb83-1052" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Interaction is significant"</span></span>
<span id="cb83-1053"><a href="#cb83-1053" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb83-1054"><a href="#cb83-1054" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Best Type</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb83-1055"><a href="#cb83-1055" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Type II"</span>,</span>
<span id="cb83-1056"><a href="#cb83-1056" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Type II"</span>,</span>
<span id="cb83-1057"><a href="#cb83-1057" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Type III"</span>,</span>
<span id="cb83-1058"><a href="#cb83-1058" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Type I"</span>,</span>
<span id="cb83-1059"><a href="#cb83-1059" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Type III"</span></span>
<span id="cb83-1060"><a href="#cb83-1060" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb83-1061"><a href="#cb83-1061" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Why</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb83-1062"><a href="#cb83-1062" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tests main effects properly without assuming interaction"</span>,</span>
<span id="cb83-1063"><a href="#cb83-1063" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Type II isolates unique variance of each factor"</span>,</span>
<span id="cb83-1064"><a href="#cb83-1064" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Type III is most conservative, controls for all"</span>,</span>
<span id="cb83-1065"><a href="#cb83-1065" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Type I respects the sequential nature"</span>,</span>
<span id="cb83-1066"><a href="#cb83-1066" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Type III tests main effects in presence of interaction"</span></span>
<span id="cb83-1067"><a href="#cb83-1067" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb83-1068"><a href="#cb83-1068" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb83-1069"><a href="#cb83-1069" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-1070"><a href="#cb83-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1071"><a href="#cb83-1071" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(final_recommendations,</span>
<span id="cb83-1072"><a href="#cb83-1072" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Final Recommendations for ANOVA Type Selection"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-1073"><a href="#cb83-1073" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>))</span>
<span id="cb83-1074"><a href="#cb83-1074" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-1075"><a href="#cb83-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1076"><a href="#cb83-1076" aria-hidden="true" tabindex="-1"></a>**Remember this Above All**  </span>
<span id="cb83-1077"><a href="#cb83-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1078"><a href="#cb83-1078" aria-hidden="true" tabindex="-1"></a>::::{.callout-important}</span>
<span id="cb83-1079"><a href="#cb83-1079" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Golden Rule of ANOVA Types  </span></span>
<span id="cb83-1080"><a href="#cb83-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1081"><a href="#cb83-1081" aria-hidden="true" tabindex="-1"></a>**If your design is balanced, rejoice!** All types give the same answer.  </span>
<span id="cb83-1082"><a href="#cb83-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1083"><a href="#cb83-1083" aria-hidden="true" tabindex="-1"></a>**If your design is unbalanced:**  </span>
<span id="cb83-1084"><a href="#cb83-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1085"><a href="#cb83-1085" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>1. Check if interaction is significant</span>
<span id="cb83-1086"><a href="#cb83-1086" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>2. If NO interaction → Use Type II</span>
<span id="cb83-1087"><a href="#cb83-1087" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>3. If YES interaction → Use Type III</span>
<span id="cb83-1088"><a href="#cb83-1088" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>4. If natural hierarchy → Consider Type I</span>
<span id="cb83-1089"><a href="#cb83-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1090"><a href="#cb83-1090" aria-hidden="true" tabindex="-1"></a>**Always report:** Which type you used and why!</span>
<span id="cb83-1091"><a href="#cb83-1091" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb83-1092"><a href="#cb83-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1093"><a href="#cb83-1093" aria-hidden="true" tabindex="-1"></a><span class="fu">## Appendix: R Package Requirements</span></span>
<span id="cb83-1094"><a href="#cb83-1094" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb83-1095"><a href="#cb83-1095" aria-hidden="true" tabindex="-1"></a><span class="co"># Required packages for this tutorial</span></span>
<span id="cb83-1096"><a href="#cb83-1096" aria-hidden="true" tabindex="-1"></a>required_packages <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb83-1097"><a href="#cb83-1097" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tidyverse"</span>,     <span class="co"># Data manipulation and visualization</span></span>
<span id="cb83-1098"><a href="#cb83-1098" aria-hidden="true" tabindex="-1"></a>  <span class="st">"car"</span>,           <span class="co"># For Type II and III ANOVA</span></span>
<span id="cb83-1099"><a href="#cb83-1099" aria-hidden="true" tabindex="-1"></a>  <span class="st">"emmeans"</span>,       <span class="co"># Estimated marginal means</span></span>
<span id="cb83-1100"><a href="#cb83-1100" aria-hidden="true" tabindex="-1"></a>  <span class="st">"knitr"</span>,         <span class="co"># For tables</span></span>
<span id="cb83-1101"><a href="#cb83-1101" aria-hidden="true" tabindex="-1"></a>  <span class="st">"kableExtra"</span>,    <span class="co"># Enhanced tables</span></span>
<span id="cb83-1102"><a href="#cb83-1102" aria-hidden="true" tabindex="-1"></a>  <span class="st">"patchwork"</span>,     <span class="co"># Combining plots</span></span>
<span id="cb83-1103"><a href="#cb83-1103" aria-hidden="true" tabindex="-1"></a>  <span class="st">"corrplot"</span>,      <span class="co"># Correlation plots</span></span>
<span id="cb83-1104"><a href="#cb83-1104" aria-hidden="true" tabindex="-1"></a>  <span class="st">"rstatix"</span>        <span class="co"># Additional statistical tests</span></span>
<span id="cb83-1105"><a href="#cb83-1105" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-1106"><a href="#cb83-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1107"><a href="#cb83-1107" aria-hidden="true" tabindex="-1"></a><span class="co"># Install if needed</span></span>
<span id="cb83-1108"><a href="#cb83-1108" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(required_packages)</span>
<span id="cb83-1109"><a href="#cb83-1109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>