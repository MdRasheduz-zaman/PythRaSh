<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="dcterms.date" content="2025-04-26">
<title>pythrash - Basic R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link rel="stylesheet" href="../../_include/styles.css">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">PythRaSh</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-r" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">R</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-r">
<li>
    <a class="dropdown-item" href="../../ch/rbasics/git.html" rel="" target="">
 <span class="dropdown-text">git</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/rbasics/firststeps.html" rel="" target="">
 <span class="dropdown-text">Basic R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/rbasics/tidyverse.html" rel="" target="">
 <span class="dropdown-text">The tidyverse</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/rbasics/correlation_regression.html" rel="" target="">
 <span class="dropdown-text">Advanced R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/rbasics/baddata.html" rel="" target="">
 <span class="dropdown-text">Data Wrangling</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-python" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Python</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-python">
<li>
    <a class="dropdown-item" href="../../ch/python/basics.html" rel="" target="">
 <span class="dropdown-text">Basics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/python/panda.html" rel="" target="">
 <span class="dropdown-text">Advanced Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/python/MLA.html" rel="" target="">
 <span class="dropdown-text">Machine Learning Algorithms</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/python/AI.html" rel="" target="">
 <span class="dropdown-text">AI</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-linux-and-clt" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Linux and CLT</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-linux-and-clt">
<li>
    <a class="dropdown-item" href="../../ch/linux-and-ctl/basics.html" rel="" target="">
 <span class="dropdown-text">Linux Basics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/linux-and-ctl/advanced.html" rel="" target="">
 <span class="dropdown-text">Advanced Command Line</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-probability-and-statistics" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Probability and Statistics</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-probability-and-statistics">
<li>
    <a class="dropdown-item" href="../../ch/prob_stat/prob_basic.html" rel="" target="">
 <span class="dropdown-text">Probability Basics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/prob_stat/stat.html" rel="" target="">
 <span class="dropdown-text">Statistics</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-genomics" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Genomics</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-genomics">
<li>
    <a class="dropdown-item" href="../../ch/genomics/basics.html" rel="" target="">
 <span class="dropdown-text">Genomics Basics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/genomics/advanced.html" rel="" target="">
 <span class="dropdown-text">Advanced Genomics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/genomics/pipeline.html" rel="" target="">
 <span class="dropdown-text">Pipelines</span></a>
  </li>  
    </ul>
</li>
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-blogs" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Blogs</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-blogs">
<li>
    <a class="dropdown-item" href="../../ch/blogs/en/index.html" rel="" target="">
 <span class="dropdown-text">English</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ch/blogs/bn/index.html" rel="" target="">
 <span class="dropdown-text">Bangla</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/MdRasheduz-zaman" rel="" target="">
 <span class="menu-text">Contact</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/MdRasheduz-zaman/PythRaSh" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#l2-data-representation" id="toc-l2-data-representation" class="nav-link active" data-scroll-target="#l2-data-representation">L2: Data Representation</a>
  <ul class="collapse">
<li><a href="#using-r-as-a-calculator" id="toc-using-r-as-a-calculator" class="nav-link" data-scroll-target="#using-r-as-a-calculator">Using R as a Calculator</a></li>
  <li>
<a href="#variables" id="toc-variables" class="nav-link" data-scroll-target="#variables">Variables</a>
  <ul class="collapse">
<li><a href="#integer-and-modulus-division-again" id="toc-integer-and-modulus-division-again" class="nav-link" data-scroll-target="#integer-and-modulus-division-again">Integer and Modulus division again</a></li>
  </ul>
</li>
  <li><a href="#rounding" id="toc-rounding" class="nav-link" data-scroll-target="#rounding">Rounding</a></li>
  <li><a href="#logical-operations" id="toc-logical-operations" class="nav-link" data-scroll-target="#logical-operations">Logical Operations</a></li>
  <li><a href="#help-and-documentation" id="toc-help-and-documentation" class="nav-link" data-scroll-target="#help-and-documentation">Help and Documentation</a></li>
  <li>
<a href="#working-with-vectors" id="toc-working-with-vectors" class="nav-link" data-scroll-target="#working-with-vectors">Working with Vectors</a>
  <ul class="collapse">
<li><a href="#vector-operations" id="toc-vector-operations" class="nav-link" data-scroll-target="#vector-operations">Vector Operations</a></li>
  </ul>
</li>
  <li>
<a href="#data-frame" id="toc-data-frame" class="nav-link" data-scroll-target="#data-frame">Data Frame</a>
  <ul class="collapse">
<li><a href="#gene-expression-table" id="toc-gene-expression-table" class="nav-link" data-scroll-target="#gene-expression-table">Gene Expression Table</a></li>
  </ul>
</li>
  <li>
<a href="#homeworks" id="toc-homeworks" class="nav-link" data-scroll-target="#homeworks">Homeworks</a>
  <ul class="collapse">
<li><a href="#deadline" id="toc-deadline" class="nav-link" data-scroll-target="#deadline">Deadline</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#l3-data-transformation" id="toc-l3-data-transformation" class="nav-link" data-scroll-target="#l3-data-transformation">L3: Data Transformation</a>
  <ul class="collapse">
<li>
<a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">Getting Started</a>
  <ul class="collapse">
<li><a href="#installation-of-r-markdown" id="toc-installation-of-r-markdown" class="nav-link" data-scroll-target="#installation-of-r-markdown">Installation of R Markdown</a></li>
  <li><a href="#basic-setup-for-todays-session" id="toc-basic-setup-for-todays-session" class="nav-link" data-scroll-target="#basic-setup-for-todays-session">Basic Setup for Today’s Session</a></li>
  <li><a href="#building-on-last-hw" id="toc-building-on-last-hw" class="nav-link" data-scroll-target="#building-on-last-hw">Building on Last HW:</a></li>
  <li><a href="#preamble-on-random-variables-rv" id="toc-preamble-on-random-variables-rv" class="nav-link" data-scroll-target="#preamble-on-random-variables-rv">Preamble on random variables (RV):</a></li>
  <li><a href="#basic-stuffs-atomic-vector" id="toc-basic-stuffs-atomic-vector" class="nav-link" data-scroll-target="#basic-stuffs-atomic-vector">Basic Stuffs: Atomic Vector</a></li>
  <li><a href="#basic-stuffs-matrices" id="toc-basic-stuffs-matrices" class="nav-link" data-scroll-target="#basic-stuffs-matrices">Basic Stuffs: Matrices</a></li>
  <li><a href="#basic-stuffs-list" id="toc-basic-stuffs-list" class="nav-link" data-scroll-target="#basic-stuffs-list">Basic Stuffs: List</a></li>
  </ul>
</li>
  <li>
<a href="#factor-variables" id="toc-factor-variables" class="nav-link" data-scroll-target="#factor-variables">Factor Variables</a>
  <ul class="collapse">
<li><a href="#creating-factors" id="toc-creating-factors" class="nav-link" data-scroll-target="#creating-factors">Creating Factors</a></li>
  <li><a href="#factor-operations" id="toc-factor-operations" class="nav-link" data-scroll-target="#factor-operations">Factor Operations</a></li>
  </ul>
</li>
  <li>
<a href="#subsetting-data" id="toc-subsetting-data" class="nav-link" data-scroll-target="#subsetting-data">Subsetting Data</a>
  <ul class="collapse">
<li><a href="#vectors" id="toc-vectors" class="nav-link" data-scroll-target="#vectors">Vectors</a></li>
  <li><a href="#data-frames" id="toc-data-frames" class="nav-link" data-scroll-target="#data-frames">Data Frames</a></li>
  <li><a href="#row-names-in-data-frames" id="toc-row-names-in-data-frames" class="nav-link" data-scroll-target="#row-names-in-data-frames">Row Names in Data Frames</a></li>
  </ul>
</li>
  <li>
<a href="#handling-missingwrong-values" id="toc-handling-missingwrong-values" class="nav-link" data-scroll-target="#handling-missingwrong-values">Handling Missing/Wrong Values</a>
  <ul class="collapse">
<li><a href="#identifying-issues" id="toc-identifying-issues" class="nav-link" data-scroll-target="#identifying-issues">Identifying Issues</a></li>
  <li><a href="#fixing-data" id="toc-fixing-data" class="nav-link" data-scroll-target="#fixing-data">Fixing Data</a></li>
  </ul>
</li>
  <li>
<a href="#data-transformation" id="toc-data-transformation" class="nav-link" data-scroll-target="#data-transformation">Data Transformation</a>
  <ul class="collapse">
<li><a href="#introduction-to-outliers" id="toc-introduction-to-outliers" class="nav-link" data-scroll-target="#introduction-to-outliers">Introduction to Outliers</a></li>
  <li><a href="#identifying-outliers" id="toc-identifying-outliers" class="nav-link" data-scroll-target="#identifying-outliers">Identifying Outliers</a></li>
  <li><a href="#transforming-vectors" id="toc-transforming-vectors" class="nav-link" data-scroll-target="#transforming-vectors">Transforming Vectors</a></li>
  <li><a href="#logical-expressions" id="toc-logical-expressions" class="nav-link" data-scroll-target="#logical-expressions">Logical Expressions</a></li>
  <li><a href="#logical-operators" id="toc-logical-operators" class="nav-link" data-scroll-target="#logical-operators">Logical Operators</a></li>
  <li><a href="#logical-functions" id="toc-logical-functions" class="nav-link" data-scroll-target="#logical-functions">Logical Functions</a></li>
  <li><a href="#conditionals" id="toc-conditionals" class="nav-link" data-scroll-target="#conditionals">Conditionals</a></li>
  </ul>
</li>
  <li><a href="#practical-session" id="toc-practical-session" class="nav-link" data-scroll-target="#practical-session">Practical Session</a></li>
  <li><a href="#summary-of-todays-lesson" id="toc-summary-of-todays-lesson" class="nav-link" data-scroll-target="#summary-of-todays-lesson">Summary of Today’s Lesson</a></li>
  <li><a href="#homework" id="toc-homework" class="nav-link" data-scroll-target="#homework">Homework</a></li>
  </ul>
</li>
  </ul><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="firststeps.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Basic R</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Md Rasheduzzaman </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.fli.de/de/institute/institut-fuer-infektionsmedizin-imed/">
            FLI Insel Riems
            </a>
          </p>
        <p class="affiliation">
            <a href="https://github.com/MdRasheduz-zaman">
            &amp; Freelancer
            </a>
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Last updated</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 26, 2025</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Content summary</div>
    Data types, variables, vectors, data frame, functions
  </div>
</div>

</header><style>
  .content {
    text-align: justify !important;
  }
  p {
    text-align: justify !important;
  }
  .quarto-body {
    text-align: justify !important;
  }
</style>
<section id="l2-data-representation" class="level1"><h1>L2: Data Representation</h1>
<section id="using-r-as-a-calculator" class="level2"><h2 class="anchored" data-anchor-id="using-r-as-a-calculator">Using R as a Calculator</h2>
<p>Let’s do some basic calculation.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">5</span><span class="op">+</span><span class="fl">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 8</code></pre>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">3</span><span class="op">+</span><span class="fl">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 5</code></pre>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">3</span><span class="op">-</span><span class="fl">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 1</code></pre>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">3</span><span class="op">*</span><span class="fl">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 6</code></pre>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">3</span><span class="op">/</span><span class="fl">2</span> <span class="co">#normal division</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 1.5</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">7</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%/%</a></span> <span class="fl">2</span> <span class="co">#integer division, only the quotient</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 3</code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">5</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span> <span class="fl">3</span> <span class="co">#modulus division, the remainder</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 2</code></pre>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="fl">10</span><span class="op">-</span><span class="fl">5</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">2</span><span class="op">+</span><span class="fl">4</span><span class="op">)</span> <span class="co">#use of parentheses</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 30</code></pre>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">10</span><span class="op">-</span><span class="fl">5</span><span class="op">*</span><span class="fl">2</span><span class="op">+</span><span class="fl">4</span> <span class="co">#Noticed BODMAS?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 4</code></pre>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="fl">10</span><span class="op">-</span><span class="fl">5</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">2</span><span class="op">+</span><span class="fl">4</span><span class="op">)</span> <span class="co">#Noticed BODMAS</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 30</code></pre>
</div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">7</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">3</span><span class="op">)</span>; <span class="fl">7</span><span class="op">/</span><span class="fl">1</span><span class="op">+</span><span class="fl">3</span> <span class="co">#multi-line codes, separated with semi-colon</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 1.75</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 10</code></pre>
</div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">1</span><span class="op">+</span><span class="fl">2</span>; <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>; <span class="fl">1</span><span class="op">/</span><span class="fl">10</span> <span class="co">#more multi-line codes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 0.1</code></pre>
</div>
</div>
</section><section id="variables" class="level2"><h2 class="anchored" data-anchor-id="variables">Variables</h2>
<p>Variables are variable. We have freedom to name them as we wish. But make any variable name meaningful and identifiable.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">5</span> <span class="co">#assign value 5 to a </span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="va">a</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 5</code></pre>
</div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">b</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 10</code></pre>
</div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">+</span> <span class="fl">10</span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="va">b</span> <span class="op">+</span> <span class="fl">15</span></span>
<span><span class="va">a</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 15</code></pre>
</div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">a</span><span class="op">^</span><span class="fl">2</span> <span class="co">#a squared</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 225</code></pre>
</div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">a</span><span class="op">**</span><span class="fl">2</span> <span class="co">#a squared again, in a different way.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 225</code></pre>
</div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">a</span><span class="op">^</span><span class="fl">3</span> <span class="co">#a qubed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 3375</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>&lt;-</code> and <code>=</code> are used to assign values. It is not mathematical equality. <code>b &lt;- b + 15</code> might make better sense than <code>b = b + 15</code>.</p>
</div>
</div>
<section id="integer-and-modulus-division-again" class="level3"><h3 class="anchored" data-anchor-id="integer-and-modulus-division-again">Integer and Modulus division again</h3>
<p>Do some more practice.</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">7</span><span class="op">/</span><span class="fl">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 2.333333</code></pre>
</div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">7</span><span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%/%</a></span><span class="fl">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 2</code></pre>
</div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">7</span><span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span><span class="fl">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 1</code></pre>
</div>
</div>
</section></section><section id="rounding" class="level2"><h2 class="anchored" data-anchor-id="rounding">Rounding</h2>
<p>Some important functions we apply on numerical values</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">9</span><span class="op">/</span><span class="fl">4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 2</code></pre>
</div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 3</code></pre>
</div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 2</code></pre>
</div>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span><span class="op">)</span> <span class="co">#round till 2 decimal points</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 2.25</code></pre>
</div>
</div>
</section><section id="logical-operations" class="level2"><h2 class="anchored" data-anchor-id="logical-operations">Logical Operations</h2>
<p>Get to know TRUE/FALSE in R.</p>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">a</span> <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="fl">7</span></span>
<span><span class="va">c</span> <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="va">d</span> <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="va">a</span> <span class="op">==</span> <span class="va">b</span> <span class="co">#is a equal to b? Ans: No/FALSE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">a</span> <span class="op">!=</span> <span class="va">b</span> <span class="co">#is a not equal to b? Ans: Yes/TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">a</span> <span class="op">&gt;</span> <span class="va">b</span> <span class="co">#is a greater than b? Ans: FALSE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;</span> <span class="va">b</span> <span class="co">#is a less than b? Ans: TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">a</span> <span class="op">&gt;=</span> <span class="va">b</span> <span class="co">#is a greater than or equal to b? Ans: FALSE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;=</span> <span class="va">b</span> <span class="co">#is a less than or equal to b? Ans: TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;</span> <span class="va">b</span> <span class="op">|</span> <span class="va">d</span> <span class="op">&gt;</span> <span class="va">b</span> <span class="co">#is a less than b OR d greater than b?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#It's answer will be TRUE OR FALSE --&gt; So, TRUE</span></span>
<span><span class="va">a</span> <span class="op">&lt;</span> <span class="va">b</span> <span class="op">&amp;</span> <span class="va">c</span> <span class="op">&gt;</span> <span class="va">d</span> <span class="co">#is a less than b AND a greater than b? It's answer will be TRUE AND TRUE --&gt; So, TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;</span> <span class="va">b</span> <span class="op">&amp;</span> <span class="va">d</span> <span class="op">&gt;</span> <span class="va">c</span> <span class="co">#is a less than b AND a greater than b? It's answer will be TRUE AND FALSE --&gt; So, FALSE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] FALSE</code></pre>
</div>
</div>
</section><section id="help-and-documentation" class="level2"><h2 class="anchored" data-anchor-id="help-and-documentation">Help and Documentation</h2>
<p>But how to know more about a function? The package/library developer have written helpful documentation for us.</p>
<div class="cell">
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">?</span><span class="va">log</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/example.html">example</a></span><span class="op">(</span><span class="va">log</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>
log&gt; log(exp(3))
[1] 3

log&gt; log10(1e7) # = 7
[1] 7

log&gt; x &lt;- 10^-(1+2*1:9)

log&gt; cbind(deparse.level=2, # to get nice column names
log+       x, log(1+x), log1p(x), exp(x)-1, expm1(x))
          x   log(1 + x)     log1p(x)   exp(x) - 1     expm1(x)
 [1,] 1e-03 9.995003e-04 9.995003e-04 1.000500e-03 1.000500e-03
 [2,] 1e-05 9.999950e-06 9.999950e-06 1.000005e-05 1.000005e-05
 [3,] 1e-07 1.000000e-07 1.000000e-07 1.000000e-07 1.000000e-07
 [4,] 1e-09 1.000000e-09 1.000000e-09 1.000000e-09 1.000000e-09
 [5,] 1e-11 1.000000e-11 1.000000e-11 1.000000e-11 1.000000e-11
 [6,] 1e-13 9.992007e-14 1.000000e-13 9.992007e-14 1.000000e-13
 [7,] 1e-15 1.110223e-15 1.000000e-15 1.110223e-15 1.000000e-15
 [8,] 1e-17 0.000000e+00 1.000000e-17 0.000000e+00 1.000000e-17
 [9,] 1e-19 0.000000e+00 1.000000e-19 0.000000e+00 1.000000e-19</code></pre>
</div>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">?</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="working-with-vectors" class="level2"><h2 class="anchored" data-anchor-id="working-with-vectors">Working with Vectors</h2>
<p>What is a vector? See the example and think.</p>
<div class="cell">
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span> <span class="co">#c means concatenate</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="co">#consecutively, from 1 through 5. A short-hand notation using :</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">9</span>, <span class="fl">12</span>, <span class="fl">15</span>, <span class="fl">20</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 5</code></pre>
</div>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mode.html">mode</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] "numeric"</code></pre>
</div>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">is</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] "numeric" "vector" </code></pre>
</div>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="co">#first entry in vector y</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 1</code></pre>
</div>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="co">#2nd to 5th entries in vector y</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 2 3 4 5</code></pre>
</div>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">DNA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span><span class="op">)</span> <span class="co">#character vector. Notice the quotation marks.</span></span>
<span><span class="va">dec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10.0</span>, <span class="fl">20.5</span>, <span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">80.9</span>, <span class="fl">90</span>, <span class="fl">100.7</span>, <span class="fl">50</span>, <span class="fl">40</span>, <span class="fl">45</span>, <span class="fl">48</span>, <span class="fl">56</span>, <span class="fl">55</span><span class="op">)</span> <span class="co">#vector of floats. All numbers became floats, it's called coercion</span></span>
<span><span class="va">dec</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">7</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">dec</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="co">#1st to 3rd and then 7th till the end of vector `dec`. Output as a vector.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code> [1]  10.0  20.5  30.0 100.7  50.0  40.0  45.0  48.0  56.0  55.0</code></pre>
</div>
</div>
<section id="vector-operations" class="level3"><h3 class="anchored" data-anchor-id="vector-operations">Vector Operations</h3>
<p>Notice the element-wise or index-wise mathematical operations (<code>+</code>, <code>/</code>, <code><a href="https://rdrr.io/r/base/Log.html">log2()</a></code>, <code><a href="https://rdrr.io/r/base/Round.html">round()</a></code>, etc.). Noticed?</p>
<div class="cell">
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">:</span><span class="fl">11</span></span>
<span><span class="co">#x and y are of same length</span></span>
<span><span class="va">x</span> <span class="op">+</span> <span class="va">y</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code> [1]  3  5  7  9 11 13 15 17 19 21</code></pre>
</div>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">y</span> <span class="op">/</span> <span class="va">x</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code> [1] 2.000000 1.500000 1.333333 1.250000 1.200000 1.166667 1.142857 1.125000
 [9] 1.111111 1.100000</code></pre>
</div>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code> [1] 0.000000 1.000000 1.584963 2.000000 2.321928 2.584963 2.807355 3.000000
 [9] 3.169925 3.321928</code></pre>
</div>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span> <span class="co">#log2 of all the values of `x`, 1 digit after decimal to round.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code> [1] 0.0 1.0 1.6 2.0 2.3 2.6 2.8 3.0 3.2 3.3</code></pre>
</div>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span> <span class="co">#same logic</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code> [1] 0.000 1.000 1.585 2.000 2.322 2.585 2.807 3.000 3.170 3.322</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Nested functions work inside out. Think again about <code>round(log2(x), 1)</code> and you will see it. At first, it is making <code>log2</code> of vector <code>x</code> and then it is rounding the log2 values to one digit after decimal. Got it?</p>
</div>
</div>
</section></section><section id="data-frame" class="level2"><h2 class="anchored" data-anchor-id="data-frame">Data Frame</h2>
<p>Now, it’s time to use vectors to make data sets…..</p>
<div class="cell">
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mina"</span>, <span class="st">"Raju"</span>, <span class="st">"Mithu"</span>, <span class="st">"Lali"</span><span class="op">)</span></span>
<span><span class="va">gender</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Female"</span>, <span class="st">"Male"</span>, <span class="st">"Female"</span>, <span class="st">"Female"</span><span class="op">)</span></span>
<span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">12</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">is_human</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">cartoon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">names</span>, <span class="va">gender</span>, <span class="va">age</span>, <span class="va">is_human</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="va">cartoon</span>, <span class="st">"cartoon.csv"</span>, sep <span class="op">=</span> <span class="st">","</span>, col.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"cartoon.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="co">#`dim` means dimension. so, rows * columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 4 4</code></pre>
</div>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="co">#structure of `df`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>'data.frame':   4 obs. of  4 variables:
 $ names   : chr  "Mina" "Raju" "Mithu" "Lali"
 $ gender  : chr  "Female" "Male" "Female" "Female"
 $ age     : int  15 12 2 3
 $ is_human: logi  TRUE TRUE FALSE FALSE</code></pre>
</div>
</div>
<p>We made the vectors first, and the used them to make the <code>cartton</code> data frame or table. We learned how to export the data frame using write.table function. Also, we learned to import or read back the table using <code>read.table</code> function. What are the <code>sep</code>, <code>col.names</code>, <code>header</code> arguments there? Why do we need them? Think. Try thinking of different properties of a data set.</p>
<section id="gene-expression-table" class="level3"><h3 class="anchored" data-anchor-id="gene-expression-table">Gene Expression Table</h3>
<div class="cell">
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gene_expr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"TP53"</span>, <span class="st">"BRCA1"</span>, <span class="st">"MYC"</span>, <span class="st">"EGFR"</span>, <span class="st">"GAPDH"</span>, <span class="st">"CDC2"</span><span class="op">)</span>,</span>
<span>  sample1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8.2</span>, <span class="fl">6.1</span>, <span class="fl">9.5</span>, <span class="fl">7.0</span>, <span class="fl">10.0</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>  Sample2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5.9</span>, <span class="fl">3.9</span>, <span class="fl">7.2</span>, <span class="fl">4.8</span>, <span class="fl">7.9</span>, <span class="fl">9</span><span class="op">)</span>,</span>
<span>  Sample3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8.25</span>, <span class="fl">6.15</span>, <span class="fl">9.6</span>, <span class="fl">7.1</span>, <span class="fl">10.1</span>, <span class="fl">11.9</span><span class="op">)</span>,</span>
<span>  pathways <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Apoptosis"</span>, <span class="st">"DNA Repair"</span>, <span class="st">"Cell Cycle"</span>, <span class="st">"Signaling"</span>, <span class="st">"Housekeeping"</span>, <span class="st">"Cell Division"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="va">gene_expr</span>, <span class="st">"gene_expr.csv"</span>, sep <span class="op">=</span> <span class="st">","</span>, col.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">gene_set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"gene_expr.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Here, we directly used the vectors as different columns while making the data frame. Did you notice that? Also, the syntax is different here. We can’t assign the vectors with the assignment operator (means we can’t use <code>&lt;-</code> sign. We have to use the <code>=</code> sign). Try using the <code>&lt;-</code> sign. Did you notice the column names?</p>
</div>
</div>
</section></section><section id="homeworks" class="level2"><h2 class="anchored" data-anchor-id="homeworks">Homeworks</h2>
<ol type="1">
<li>Compute the difference between this year (2025) and the year you started at the university and divide this by the difference between this year and the year you were born. Multiply this with 100 to get the percentage of your life you have spent at the university.<br>
</li>
<li>Make different kinds of variables and vectors with the data types we learned together.<br>
</li>
<li>What are the properties of a data frame?<br>
Hint: Open an excel/csv/txt file you have and try to “generalize”.<br>
</li>
<li>Can you make logical questions on the 2 small data sets we used? Try. It will help you understanding the logical operations we tried on variables. Now we are going to apply them on vectors (columns) on the data sets. For example, in the <code>cartoon</code> data set, we can ask/try to subset the data set filtering for females only, or for both females and age greater than 2 years.<br>
</li>
<li>If you are writing or practicing coding in R, write comment for each line on what it is doing. It will help to chunk it better into your brain.<br>
</li>
<li>Push the script and/or your answers to the questions (with your solutions) to one of your GitHub repo (and send me the repo link).</li>
</ol>
<section id="deadline" class="level3"><h3 class="anchored" data-anchor-id="deadline">Deadline</h3>
<p><strong>Friday, 10pm BD Time.</strong></p>
</section></section></section><section id="l3-data-transformation" class="level1"><h1>L3: Data Transformation</h1>
<p>Firstly, how did you solve the problems?<br><br> Give me your personal Mindmap. Please, send it in the chat!</p>
<section id="getting-started" class="level2"><h2 class="anchored" data-anchor-id="getting-started">Getting Started</h2>
<section id="installation-of-r-markdown" class="level3"><h3 class="anchored" data-anchor-id="installation-of-r-markdown">Installation of R Markdown</h3>
<p>We will use <code>rmarkdown</code> to have the flexibility of writing codes like the one you are reading now. If you haven’t installed the <code>rmarkdown</code> package yet, you can do so with:</p>
<div class="cell">
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Install rmarkdown package</span></span>
<span><span class="co">#install.packages("rmarkdown")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/rmarkdown">rmarkdown</a></span><span class="op">)</span></span>
<span><span class="co"># Other useful packages we might use</span></span>
<span><span class="co">#install.packages("dplyr")    # Data manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#install.packages("readr")    # Reading CSV files</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Remove the hash sign before the <code>install.packages("rmarkdown")</code>, <code>install.packages("dplyr")</code>, <code>install.packages("readr")</code> if the library loading fails. That means the package is not there to be loaded. We need to download/install first.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="https://r4ds.had.co.nz">Do you remember this book by Hadley Wickham?</a>. Try to follow it to get the hold on the basic R syntax and lexicon</p>
</div>
</div>
</section><section id="basic-setup-for-todays-session" class="level3"><h3 class="anchored" data-anchor-id="basic-setup-for-todays-session">Basic Setup for Today’s Session</h3>
<div class="cell">
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Clear environment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check working directory</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set working directory if needed</span></span>
<span><span class="co"># setwd("path/to/your/directory")  # Uncomment and modify as needed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="building-on-last-hw" class="level3"><h3 class="anchored" data-anchor-id="building-on-last-hw">Building on Last HW:</h3>
<div class="cell">
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cartoon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mina"</span>, <span class="st">"Raju"</span>, <span class="st">"Mithu"</span>, <span class="st">"Lali"</span><span class="op">)</span>,</span>
<span>  gender <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Female"</span>, <span class="st">"Male"</span>, <span class="st">"Female"</span>, <span class="st">"Female"</span><span class="op">)</span>,</span>
<span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">12</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  is_human <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">cartoon</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>  names gender age is_human
1  Mina Female  15     TRUE
2  Raju   Male  12     TRUE
3 Mithu Female   2    FALSE
4  Lali Female   3    FALSE</code></pre>
</div>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">cartoon</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 4 4</code></pre>
</div>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">cartoon</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>'data.frame':   4 obs. of  4 variables:
 $ names   : chr  "Mina" "Raju" "Mithu" "Lali"
 $ gender  : chr  "Female" "Male" "Female" "Female"
 $ age     : num  15 12 2 3
 $ is_human: logi  TRUE TRUE FALSE FALSE</code></pre>
</div>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">cartoon</span><span class="op">$</span><span class="va">names</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 4</code></pre>
</div>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">##subseting</span></span>
<span><span class="va">cartoon</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="co">#row 1-2, column 2-3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>  gender age
1 Female  15
2   Male  12</code></pre>
</div>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cartoon</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span> <span class="co">#row 1-3, column 1-3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>  names gender age
1  Mina Female  15
3 Mithu Female   2</code></pre>
</div>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#condition for selecting only male characters</span></span>
<span><span class="va">male_df</span> <span class="op">&lt;-</span> <span class="va">cartoon</span><span class="op">[</span><span class="va">cartoon</span><span class="op">$</span><span class="va">gender</span> <span class="op">==</span> <span class="st">"Male"</span>, <span class="op">]</span></span>
<span><span class="va">male_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>  names gender age is_human
2  Raju   Male  12     TRUE</code></pre>
</div>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#condition for selecting female characters with age more than 2 years</span></span>
<span><span class="va">female_age</span> <span class="op">&lt;-</span> <span class="va">cartoon</span><span class="op">[</span><span class="va">cartoon</span><span class="op">$</span><span class="va">gender</span> <span class="op">==</span> <span class="st">"Female"</span> <span class="op">&amp;</span> <span class="va">cartoon</span><span class="op">$</span><span class="va">age</span> <span class="op">&gt;</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span><span class="va">female_age</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>  names gender age is_human
1  Mina Female  15     TRUE
4  Lali Female   3    FALSE</code></pre>
</div>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">female_age</span><span class="op">$</span><span class="va">age</span><span class="op">)</span> <span class="co">#sum of age of female_age dataset</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 18</code></pre>
</div>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">cartoon</span><span class="op">$</span><span class="va">age</span><span class="op">)</span> <span class="co">#standard deviation of age of main cartoon dataset</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 6.480741</code></pre>
</div>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">cartoon</span><span class="op">$</span><span class="va">age</span><span class="op">)</span> <span class="co">#mean of age of main cartoon dataset</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 8</code></pre>
</div>
</div>
<p><a href="https://github.com/atiyashehreen/hw_repo3/blob/main/propertiesofdataframe.txt">Check your colleague’s repo for the Q3</a>.</p>
<p><strong>Logical Operators</strong></p>
<table class="table">
<thead><tr class="header">
<th>Operator</th>
<th>Meaning</th>
<th>Example</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>==</code></td>
<td>Equal to</td>
<td><code>x == 5</code></td>
</tr>
<tr class="even">
<td><code>!=</code></td>
<td>Not equal</td>
<td><code>x != 5</code></td>
</tr>
<tr class="odd">
<td><code>&lt;</code></td>
<td>Less than</td>
<td><code>x &lt; 5</code></td>
</tr>
<tr class="even">
<td><code>&gt;</code></td>
<td>Greater than</td>
<td><code>x &gt; 5</code></td>
</tr>
<tr class="odd">
<td><code>&lt;=</code></td>
<td>Less or equal</td>
<td><code>x &lt;= 5</code></td>
</tr>
<tr class="even">
<td><code>&gt;=</code></td>
<td>Greater or equal</td>
<td><code>x &gt;= 5</code></td>
</tr>
<tr class="odd">
<td><code>!</code></td>
<td>Not</td>
<td><code>!(x &lt; 5)</code></td>
</tr>
<tr class="even">
<td><code>|</code></td>
<td>OR</td>
<td><code>x &lt; 5 | x &gt; 10</code></td>
</tr>
<tr class="odd">
<td><code>&amp;</code></td>
<td>AND</td>
<td><code>x &gt; 5 &amp; x &lt; 10</code></td>
</tr>
</tbody>
</table></section><section id="preamble-on-random-variables-rv" class="level3"><h3 class="anchored" data-anchor-id="preamble-on-random-variables-rv">Preamble on random variables (RV):</h3>
<p>RV is so fundamental of an idea to interpret and do better in any kind of data analyses. But what is it? Let’s imagine this scenario first. You got 30 mice to do an experiment to check anti-diabetic effect of a plant extract. You randomly assigned them into 3 groups. <code>control</code>, <code>treat1</code> (meaning insulin receivers), and <code>treat2</code> (meaning your plant extract receivers). Then you kept testing and measuring. You have mean glucose level of every mouse and show whether the mean value of <code>treat1</code> is equal to <code>treat2</code> or not. So, are you done? Not really. Be fastidious about the mice. What if you got some other 30 mice? Are they the same? Will their mean glucose level be the same? No, right. We would end up with different mean value. We call this type of quantities RV. Mean, Standard deviation, median, variance, etc. all are RVs. Do you see the logic? That’s why we put this constraint and look for p-value, confidence interval (or CI), etc. by (null) hypothesis testing and sample distribution analyses. We will get into these stuffs later. But let’s check what I meant. Also ponder about <code>sample</code> vs <code>population</code>.</p>
<p>Let’s download the data first.</p>
<div class="cell">
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Download small example dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/femaleControlsPopulation.csv"</span>,</span>
<span>              destfile <span class="op">=</span> <span class="st">"mice.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load data</span></span>
<span><span class="va">mice</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"mice.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s check now.</p>
<div class="cell">
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">mice</span><span class="op">$</span><span class="va">Bodyweight</span>,<span class="fl">12</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">control</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 23.0125</code></pre>
</div>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">control1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">mice</span><span class="op">$</span><span class="va">Bodyweight</span>,<span class="fl">12</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">control1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 25.3375</code></pre>
</div>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">control2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">mice</span><span class="op">$</span><span class="va">Bodyweight</span>,<span class="fl">12</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">control2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 26.93667</code></pre>
</div>
</div>
<p>Do you see the difference in the mean value now?</p>
</section><section id="basic-stuffs-atomic-vector" class="level3"><h3 class="anchored" data-anchor-id="basic-stuffs-atomic-vector">Basic Stuffs: Atomic Vector</h3>
<div class="cell">
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">atomic_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>Human<span class="op">=</span><span class="fl">0.5</span>, Mouse<span class="op">=</span><span class="fl">0.33</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It is fast, but has limited access methods.</p>
<p>How to access elements here?</p>
<div class="cell">
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">atomic_vec</span><span class="op">[</span><span class="st">"Human"</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Human 
  0.5 </code></pre>
</div>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">atomic_vec</span><span class="op">[</span><span class="st">"Mouse"</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Mouse 
 0.33 </code></pre>
</div>
</div>
</section><section id="basic-stuffs-matrices" class="level3"><h3 class="anchored" data-anchor-id="basic-stuffs-matrices">Basic Stuffs: Matrices</h3>
<p>Matrices are essential for biologists working with expression data, distance matrices, and other numerical data. ONLY NUMERICAL DATA.</p>
<div class="cell">
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a gene expression matrix: rows=genes, columns=samples</span></span>
<span><span class="va">expr_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">12.3</span>, <span class="fl">8.7</span>, <span class="fl">15.2</span>, <span class="fl">6.8</span>,</span>
<span>    <span class="fl">9.5</span>, <span class="fl">11.2</span>, <span class="fl">13.7</span>, <span class="fl">7.4</span>,</span>
<span>    <span class="fl">5.6</span>, <span class="fl">6.8</span>, <span class="fl">7.9</span>, <span class="fl">6.5</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">4</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add dimension names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">expr_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BRCA1"</span>, <span class="st">"TP53"</span>, <span class="st">"GAPDH"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">expr_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Control_1"</span>, <span class="st">"Control_2"</span>, <span class="st">"Treatment_1"</span>, <span class="st">"Treatment_2"</span><span class="op">)</span></span>
<span><span class="va">expr_matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>      Control_1 Control_2 Treatment_1 Treatment_2
BRCA1      12.3       8.7        15.2         6.8
TP53        9.5      11.2        13.7         7.4
GAPDH       5.6       6.8         7.9         6.5</code></pre>
</div>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Matrix dimensions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">expr_matrix</span><span class="op">)</span>       <span class="co"># Returns rows and columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 3 4</code></pre>
</div>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">expr_matrix</span><span class="op">)</span>      <span class="co"># Number of rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 3</code></pre>
</div>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">expr_matrix</span><span class="op">)</span>      <span class="co"># Number of columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 4</code></pre>
</div>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Matrix subsetting</span></span>
<span><span class="va">expr_matrix</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span>       <span class="co"># One gene, all samples</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>  Control_1   Control_2 Treatment_1 Treatment_2 
        9.5        11.2        13.7         7.4 </code></pre>
</div>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">expr_matrix</span><span class="op">[</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>     <span class="co"># All genes, treatment samples only</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>      Treatment_1 Treatment_2
BRCA1        15.2         6.8
TP53         13.7         7.4
GAPDH         7.9         6.5</code></pre>
</div>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">expr_matrix</span><span class="op">[</span><span class="st">"TP53"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Control_1"</span>, <span class="st">"Treatment_1"</span><span class="op">)</span><span class="op">]</span>  <span class="co"># Specific gene and samples</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>  Control_1 Treatment_1 
        9.5        13.7 </code></pre>
</div>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Matrix calculations (useful for bioinformatics)</span></span>
<span><span class="co"># Mean expression per gene</span></span>
<span><span class="va">gene_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="va">expr_matrix</span><span class="op">)</span></span>
<span><span class="va">gene_means</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>BRCA1  TP53 GAPDH 
10.75 10.45  6.70 </code></pre>
</div>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Mean expression per sample</span></span>
<span><span class="va">sample_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span><span class="op">(</span><span class="va">expr_matrix</span><span class="op">)</span></span>
<span><span class="va">sample_means</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>  Control_1   Control_2 Treatment_1 Treatment_2 
   9.133333    8.900000   12.266667    6.900000 </code></pre>
</div>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate fold change (Treatment vs Control)</span></span>
<span><span class="va">control_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="va">expr_matrix</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">treatment_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="va">expr_matrix</span><span class="op">[</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">fold_change</span> <span class="op">&lt;-</span> <span class="va">treatment_means</span> <span class="op">/</span> <span class="va">control_means</span></span>
<span><span class="va">fold_change</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>   BRCA1     TP53    GAPDH 
1.047619 1.019324 1.161290 </code></pre>
</div>
<div class="sourceCode" id="cb158"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Matrix visualization</span></span>
<span><span class="co"># Heatmap of expression data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html">heatmap</a></span><span class="op">(</span><span class="va">expr_matrix</span>, </span>
<span>        Colv <span class="op">=</span> <span class="cn">NA</span>,         <span class="co"># Don't cluster columns</span></span>
<span>        scale <span class="op">=</span> <span class="st">"row"</span>,     <span class="co"># Scale by row (gene)</span></span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">heat.colors</a></span><span class="op">(</span><span class="fl">16</span><span class="op">)</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Gene Expression Heatmap"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="firststeps_files/figure-html/matrices-1.png" class="img-fluid" width="1650"></p>
</div>
</div>
</section><section id="basic-stuffs-list" class="level3"><h3 class="anchored" data-anchor-id="basic-stuffs-list">Basic Stuffs: List</h3>
<p>Lists are the most flexible data structure in R - they can hold any combination of data types, including other lists! This makes them essential for biological data analysis where we often deal with mixed data types.</p>
<div class="cell">
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># A list storing different types of genomic data</span></span>
<span><span class="va">genomics_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  gene_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"TP53"</span>, <span class="st">"BRCA1"</span>, <span class="st">"MYC"</span><span class="op">)</span>,               <span class="co"># Character vector</span></span>
<span>  expression <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">3.4</span>, <span class="fl">5.6</span>, <span class="fl">7.8</span>, <span class="fl">9.1</span>, <span class="fl">2.3</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,    <span class="co"># Numeric matrix</span></span>
<span>  is_cancer_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>,                 <span class="co"># Logical vector</span></span>
<span>  metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>                                       <span class="co"># Nested list!</span></span>
<span>    lab <span class="op">=</span> <span class="st">"CRG"</span>,</span>
<span>    date <span class="op">=</span> <span class="st">"2023-05-01"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>How to Access Elements of a List?</p>
<div class="cell">
<div class="sourceCode" id="cb160"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Method 1: Double brackets [[ ]] for single element</span></span>
<span><span class="va">genomics_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>  <span class="co"># Returns gene_names vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] "TP53"  "BRCA1" "MYC"  </code></pre>
</div>
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Method 2: $ operator with names (when elements are named)</span></span>
<span><span class="va">genomics_data</span><span class="op">$</span><span class="va">expression</span>  <span class="co"># Returns the matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>     [,1] [,2]
[1,]  1.2  7.8
[2,]  3.4  9.1
[3,]  5.6  2.3</code></pre>
</div>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Method 3: Single bracket [ ] returns a sublist</span></span>
<span><span class="va">genomics_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>  <span class="co"># Returns list with first two elements</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>$gene_names
[1] "TP53"  "BRCA1" "MYC"  

$expression
     [,1] [,2]
[1,]  1.2  7.8
[2,]  3.4  9.1
[3,]  5.6  2.3</code></pre>
</div>
</div>
<p>Key Difference from Vectors:</p>
<div class="cell">
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compare to your prop.table() example:</span></span>
<span><span class="va">atomic_vec</span><span class="op">[</span><span class="st">"Human"</span><span class="op">]</span>    <span class="co"># Returns named numeric (vector)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Human 
  0.5 </code></pre>
</div>
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">atomic_vec</span><span class="op">[</span><span class="st">"Mouse"</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Mouse 
 0.33 </code></pre>
</div>
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">genomics_data</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="co"># Returns list containing the vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>$gene_names
[1] "TP53"  "BRCA1" "MYC"  </code></pre>
</div>
</div>
<p>Why Biologists Need Lists?<br><code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>, <code><a href="https://rdrr.io/r/stats/prcomp.html">prcomp()</a></code> functions, RNAseq analysis packages produces list. So, we need to learn how to handle lists.</p>
<p>See these examples:</p>
<p>A. Storing BLAST results</p>
<div class="cell">
<div class="sourceCode" id="cb172"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">blast_hits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  query_id <span class="op">=</span> <span class="st">"GeneX"</span>,</span>
<span>  hit_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NP_123"</span>, <span class="st">"NP_456"</span><span class="op">)</span>,</span>
<span>  e_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1e-50</span>, <span class="fl">3e-12</span><span class="op">)</span>,</span>
<span>  alignment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ATG..."</span>, <span class="st">"CTA..."</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>B. Handling Mixed Data</p>
<div class="cell">
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">patient_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="st">"P1001"</span>,</span>
<span>  tests <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"WBC"</span>, <span class="st">"RBC"</span><span class="op">)</span>,</span>
<span>    value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4.5</span>, <span class="fl">5.1</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  has_mutation <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Common List Operations</p>
<div class="cell">
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Add new element</span></span>
<span><span class="va">genomics_data</span><span class="op">$</span><span class="va">sequencer</span> <span class="op">&lt;-</span> <span class="st">"Illumina"</span></span>
<span></span>
<span><span class="co"># Remove element</span></span>
<span><span class="va">genomics_data</span><span class="op">$</span><span class="va">is_cancer_gene</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="co"># Check structure (critical for complex lists)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">genomics_data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>List of 4
 $ gene_names: chr [1:3] "TP53" "BRCA1" "MYC"
 $ expression: num [1:3, 1:2] 1.2 3.4 5.6 7.8 9.1 2.3
 $ metadata  :List of 2
  ..$ lab : chr "CRG"
  ..$ date: chr "2023-05-01"
 $ sequencer : chr "Illumina"</code></pre>
</div>
</div>
<p>By the way, how would you add more patients?</p>
<div class="cell">
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Add new patient</span></span>
<span><span class="va">patient_data</span><span class="op">$</span><span class="va">P1002</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="st">"P1002"</span>,</span>
<span>  tests <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"WBC"</span>, <span class="st">"RBC"</span>, <span class="st">"Platelets"</span><span class="op">)</span>,</span>
<span>    value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6.2</span>, <span class="fl">4.8</span>, <span class="fl">150</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  has_mutation <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Access specific patient</span></span>
<span><span class="va">patient_data</span><span class="op">$</span><span class="va">P1001</span><span class="op">$</span><span class="va">tests</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>NULL</code></pre>
</div>
</div>
<p>For Batch Processing:</p>
<div class="cell">
<div class="sourceCode" id="cb178"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">patients</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    id <span class="op">=</span> <span class="st">"P1001"</span>,</span>
<span>    tests <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"WBC"</span>, <span class="st">"RBC"</span><span class="op">)</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4.5</span>, <span class="fl">5.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    has_mutation <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    id <span class="op">=</span> <span class="st">"P1002"</span>,</span>
<span>    tests <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"WBC"</span>, <span class="st">"RBC"</span>, <span class="st">"Platelets"</span><span class="op">)</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6.2</span>, <span class="fl">4.8</span>, <span class="fl">150</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    has_mutation <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Access 2nd patient's WBC value</span></span>
<span><span class="va">patients</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">tests</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">patients</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">tests</span><span class="op">$</span><span class="va">test</span> <span class="op">==</span> <span class="st">"WBC"</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 6.2</code></pre>
</div>
</div>
<p>Converting Between Structures</p>
<div class="cell">
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># List → Vector</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">genomics_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>  gene_names1   gene_names2   gene_names3   expression1   expression2 
       "TP53"       "BRCA1"         "MYC"         "1.2"         "3.4" 
  expression3   expression4   expression5   expression6  metadata.lab 
        "5.6"         "7.8"         "9.1"         "2.3"         "CRG" 
metadata.date 
 "2023-05-01" </code></pre>
</div>
</div>
<p>Visualization</p>
<div class="cell">
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Base R plot from list data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">genomics_data</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>        names.arg <span class="op">=</span> <span class="va">genomics_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This code won’t work if you run. <code>unlist(genomics_data[2]</code> creates a vector of length 6 from our 3*2 matrix but <code>genomics_data[[1]]</code> has 3 things inside the <code>gene_names</code> vector. Debug like this:</p>
<div class="cell">
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">genomics_data</span><span class="op">$</span><span class="va">expression</span><span class="op">)</span>  <span class="co"># e.g., 2 rows x 2 cols</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 3 2</code></pre>
</div>
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">genomics_data</span><span class="op">$</span><span class="va">gene_names</span><span class="op">)</span> <span class="co"># e.g., 3 genes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 3</code></pre>
</div>
</div>
<p>A. Gene-Centric (Mean Expression)</p>
<div class="cell">
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="va">genomics_data</span><span class="op">$</span><span class="va">expression</span><span class="op">)</span>,</span>
<span>        names.arg <span class="op">=</span> <span class="va">genomics_data</span><span class="op">$</span><span class="va">gene_names</span>,</span>
<span>        col <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Mean Expression"</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Average Gene Expression"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="firststeps_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="1650"></p>
</div>
</div>
<p>B. Sample-Centric (All Measurements)</p>
<div class="cell">
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">genomics_data</span><span class="op">$</span><span class="va">expression</span>,</span>
<span>        beside <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        names.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Sample_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">genomics_data</span><span class="op">$</span><span class="va">expression</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        legend.text <span class="op">=</span> <span class="va">genomics_data</span><span class="op">$</span><span class="va">gene_names</span>,</span>
<span>        args.legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"topright"</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"green"</span><span class="op">)</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Expression Across Samples"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="firststeps_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="1650"></p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This matches real-world scenarios:</p>
<p>RNA-seq: Rows=genes, cols=samples</p>
<p>rowMeans() = average expression per gene</p>
<p>beside=TRUE =&gt; compare samples within genes</p>
<p>Proteomics: Rows=proteins, cols=replicates</p>
<p>Same principles apply</p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate stats</span></span>
<span><span class="va">gene_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="va">genomics_data</span><span class="op">$</span><span class="va">expression</span><span class="op">)</span></span>
<span><span class="va">gene_sds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">genomics_data</span><span class="op">$</span><span class="va">expression</span>, <span class="fl">1</span>, <span class="va">sd</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot with error bars</span></span>
<span><span class="va">bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">gene_means</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">gene_means</span> <span class="op">+</span> <span class="va">gene_sds</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span><span class="op">(</span><span class="va">bp</span>, <span class="va">gene_means</span> <span class="op">-</span> <span class="va">gene_sds</span>, <span class="va">bp</span>, <span class="va">gene_means</span> <span class="op">+</span> <span class="va">gene_sds</span>, </span>
<span>       angle <span class="op">=</span> <span class="fl">90</span>, code <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="firststeps_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="1650"></p>
</div>
</div>
<p><strong>Task: Create a list containing:</strong></p>
<ol type="i">
<li><p>A character vector of 3 gene names</p></li>
<li><p>A numeric matrix of expression values</p></li>
<li><p>A logical vector indicating pathway membership</p></li>
<li><p>A nested list with lab metadata</p></li>
</ol></section></section><section id="factor-variables" class="level2"><h2 class="anchored" data-anchor-id="factor-variables">Factor Variables</h2>
<p>Important for categorical data</p>
<section id="creating-factors" class="level3"><h3 class="anchored" data-anchor-id="creating-factors">Creating Factors</h3>
<p>Factors are used to represent categorical data in R. They are particularly important for biological data like genotypes, phenotypes, and experimental conditions.</p>
<div class="cell">
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Simple factor: DNA sample origins</span></span>
<span><span class="va">origins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Human"</span>, <span class="st">"Mouse"</span>, <span class="st">"Human"</span>, <span class="st">"Zebrafish"</span>, <span class="st">"Mouse"</span>, <span class="st">"Human"</span><span class="op">)</span></span>
<span><span class="va">origins_factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">origins</span><span class="op">)</span></span>
<span><span class="va">origins_factor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] Human     Mouse     Human     Zebrafish Mouse     Human    
Levels: Human Mouse Zebrafish</code></pre>
</div>
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Check levels (categories)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">origins_factor</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] "Human"     "Mouse"     "Zebrafish"</code></pre>
</div>
<div class="sourceCode" id="cb194"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a factor with predefined levels</span></span>
<span><span class="va">treatment_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Low_dose"</span>, <span class="st">"High_dose"</span>, <span class="st">"Control"</span>, <span class="st">"Low_dose"</span><span class="op">)</span>,</span>
<span>                         levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Low_dose"</span>, <span class="st">"High_dose"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">treatment_groups</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] Control   Low_dose  High_dose Control   Low_dose 
Levels: Control Low_dose High_dose</code></pre>
</div>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Ordered factors (important for severity, stages, etc.)</span></span>
<span><span class="va">disease_severity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mild"</span>, <span class="st">"Severe"</span>, <span class="st">"Moderate"</span>, <span class="st">"Mild"</span>, <span class="st">"Critical"</span><span class="op">)</span>,</span>
<span>                         levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mild"</span>, <span class="st">"Moderate"</span>, <span class="st">"Severe"</span>, <span class="st">"Critical"</span><span class="op">)</span>,</span>
<span>                         ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">disease_severity</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] Mild     Severe   Moderate Mild     Critical
Levels: Mild &lt; Moderate &lt; Severe &lt; Critical</code></pre>
</div>
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compare with ordered factors</span></span>
<span><span class="va">disease_severity</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">disease_severity</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>  <span class="co"># Is Mild less severe than Severe?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] TRUE</code></pre>
</div>
</div>
</section><section id="factor-operations" class="level3"><h3 class="anchored" data-anchor-id="factor-operations">Factor Operations</h3>
<div class="cell">
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Count frequencies</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">origins_factor</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>origins_factor
    Human     Mouse Zebrafish 
        3         2         1 </code></pre>
</div>
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate proportions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">origins_factor</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>origins_factor
    Human     Mouse Zebrafish 
0.5000000 0.3333333 0.1666667 </code></pre>
</div>
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Change reference level (important for statistical models)</span></span>
<span><span class="va">origins_factor_relevel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html">relevel</a></span><span class="op">(</span><span class="va">origins_factor</span>, ref <span class="op">=</span> <span class="st">"Mouse"</span><span class="op">)</span></span>
<span><span class="va">origins_factor_relevel</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] Human     Mouse     Human     Zebrafish Mouse     Human    
Levels: Mouse Human Zebrafish</code></pre>
</div>
<div class="sourceCode" id="cb206"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Convert to character</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">origins_factor</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] "Human"     "Mouse"     "Human"     "Zebrafish" "Mouse"     "Human"    </code></pre>
</div>
<div class="sourceCode" id="cb208"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Plot factors - Basic barplot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">origins_factor</span><span class="op">)</span>, </span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"red"</span><span class="op">)</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Sample Origins"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="firststeps_files/figure-html/factor-operations-1.png" class="img-fluid" width="1650"></p>
</div>
</div>
<p>More advanced plot with factors:</p>
<div class="cell">
<div class="sourceCode" id="cb209"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gene_expr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5.2</span>, <span class="fl">7.8</span>, <span class="fl">4.5</span>, <span class="fl">12.3</span>, <span class="fl">8.1</span>, <span class="fl">3.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">gene_expr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">origins</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Boxplot by factor</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">gene_expr</span> <span class="op">~</span> <span class="va">origins</span>, </span>
<span>        col <span class="op">=</span> <span class="st">"lightblue"</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Gene Expression by Sample Origin"</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"Origin"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"Expression Level"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="firststeps_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="1650"></p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Keep noticing the output formats. Sometimes the output is just a number, sometimes a vector or table or list, etc. Check <code>prop.table(table(origins_factor))</code>. How is it?</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Got it?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><code>prop &lt;- prop.table(table(origins_factor))</code> – is a named numeric vector (atomic vector). <code>prop$Human</code> or similar won’t work. Check this way:<br><code>prop</code><br><code>prop["Human"]; prop["Mouse"]; prop["Zebrafish"]</code></p>
<p>Or make it a data frame (df) first, then try to use normal way of handling df.</p>
</div>
</div>
</div>
<p>Accessing the Output:</p>
<div class="cell">
<div class="sourceCode" id="cb210"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">prop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">origins_factor</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">prop</span> <span class="co">#What do you see? A data frame? No difference?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>origins_factor
    Human     Mouse Zebrafish 
0.5000000 0.3333333 0.1666667 </code></pre>
</div>
<div class="sourceCode" id="cb212"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">prop</span><span class="op">[</span><span class="st">"Human"</span><span class="op">]</span>; <span class="va">prop</span><span class="op">[</span><span class="st">"Mouse"</span><span class="op">]</span>; <span class="va">prop</span><span class="op">[</span><span class="st">"Zebrafish"</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Human 
  0.5 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>    Mouse 
0.3333333 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Zebrafish 
0.1666667 </code></pre>
</div>
</div>
</section></section><section id="subsetting-data" class="level2"><h2 class="anchored" data-anchor-id="subsetting-data">Subsetting Data</h2>
<section id="vectors" class="level3"><h3 class="anchored" data-anchor-id="vectors">Vectors</h3>
<div class="cell">
<div class="sourceCode" id="cb216"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a vector</span></span>
<span><span class="va">expression_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3.2</span>, <span class="fl">4.5</span>, <span class="fl">2.1</span>, <span class="fl">6.7</span>, <span class="fl">5.9</span>, <span class="fl">3.3</span>, <span class="fl">7.8</span>, <span class="fl">2.9</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">expression_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Sample_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">expression_data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Sample_1 Sample_2 Sample_3 Sample_4 Sample_5 Sample_6 Sample_7 Sample_8 
     3.2      4.5      2.1      6.7      5.9      3.3      7.8      2.9 </code></pre>
</div>
<div class="sourceCode" id="cb218"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Subset by position</span></span>
<span><span class="va">expression_data</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>             <span class="co"># Single element</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Sample_3 
     2.1 </code></pre>
</div>
<div class="sourceCode" id="cb220"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">expression_data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span>    <span class="co"># Multiple elements</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Sample_1 Sample_3 Sample_5 
     3.2      2.1      5.9 </code></pre>
</div>
<div class="sourceCode" id="cb222"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">expression_data</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>           <span class="co"># Range</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Sample_2 Sample_3 Sample_4 Sample_5 
     4.5      2.1      6.7      5.9 </code></pre>
</div>
<div class="sourceCode" id="cb224"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Subset by name</span></span>
<span><span class="va">expression_data</span><span class="op">[</span><span class="st">"Sample_6"</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Sample_6 
     3.3 </code></pre>
</div>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">expression_data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sample_1"</span>, <span class="st">"Sample_8"</span><span class="op">)</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Sample_1 Sample_8 
     3.2      2.9 </code></pre>
</div>
<div class="sourceCode" id="cb228"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Subset by condition</span></span>
<span><span class="va">expression_data</span><span class="op">[</span><span class="va">expression_data</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">]</span>              <span class="co"># Values &gt; 5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Sample_4 Sample_5 Sample_7 
     6.7      5.9      7.8 </code></pre>
</div>
<div class="sourceCode" id="cb230"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">expression_data</span><span class="op">[</span><span class="va">expression_data</span> <span class="op">&gt;=</span> <span class="fl">3</span> <span class="op">&amp;</span> <span class="va">expression_data</span> <span class="op">&lt;=</span> <span class="fl">6</span><span class="op">]</span>  <span class="co"># Values between 3 and 6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Sample_1 Sample_2 Sample_5 Sample_6 
     3.2      4.5      5.9      3.3 </code></pre>
</div>
</div>
</section><section id="data-frames" class="level3"><h3 class="anchored" data-anchor-id="data-frames">Data Frames</h3>
<div class="cell">
<div class="sourceCode" id="cb232"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a data frame</span></span>
<span><span class="va">gene_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  gene_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BRCA1"</span>, <span class="st">"TP53"</span>, <span class="st">"MYC"</span>, <span class="st">"EGFR"</span>, <span class="st">"GAPDH"</span><span class="op">)</span>,</span>
<span>  expression <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8.2</span>, <span class="fl">6.1</span>, <span class="fl">9.5</span>, <span class="fl">7.0</span>, <span class="fl">10.0</span><span class="op">)</span>,</span>
<span>  mutation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Yes"</span>, <span class="st">"No"</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>, <span class="st">"No"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  pathway <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"DNA Repair"</span>, <span class="st">"Apoptosis"</span>, <span class="st">"Cell Cycle"</span>, <span class="st">"Signaling"</span>, <span class="st">"Metabolism"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">gene_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>  gene_id expression mutation    pathway
1   BRCA1        8.2      Yes DNA Repair
2    TP53        6.1       No  Apoptosis
3     MYC        9.5      Yes Cell Cycle
4    EGFR        7.0       No  Signaling
5   GAPDH       10.0       No Metabolism</code></pre>
</div>
<div class="sourceCode" id="cb234"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Subsetting by row index</span></span>
<span><span class="va">gene_df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="op">]</span>         <span class="co"># First three rows, all columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>  gene_id expression mutation    pathway
1   BRCA1        8.2      Yes DNA Repair
2    TP53        6.1       No  Apoptosis
3     MYC        9.5      Yes Cell Cycle</code></pre>
</div>
<div class="sourceCode" id="cb236"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Subsetting by column index</span></span>
<span><span class="va">gene_df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span>     <span class="co"># All rows, first two columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>  gene_id expression
1   BRCA1        8.2
2    TP53        6.1
3     MYC        9.5
4    EGFR        7.0
5   GAPDH       10.0</code></pre>
</div>
<div class="sourceCode" id="cb238"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Subsetting by column name</span></span>
<span><span class="va">gene_df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gene_id"</span>, <span class="st">"mutation"</span><span class="op">)</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>  gene_id mutation
1   BRCA1      Yes
2    TP53       No
3     MYC      Yes
4    EGFR       No
5   GAPDH       No</code></pre>
</div>
<div class="sourceCode" id="cb240"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Using the $ operator</span></span>
<span><span class="va">gene_df</span><span class="op">$</span><span class="va">expression</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1]  8.2  6.1  9.5  7.0 10.0</code></pre>
</div>
<div class="sourceCode" id="cb242"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gene_df</span><span class="op">$</span><span class="va">mutation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] Yes No  Yes No  No 
Levels: No Yes</code></pre>
</div>
<div class="sourceCode" id="cb244"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Subsetting by condition</span></span>
<span><span class="va">gene_df</span><span class="op">[</span><span class="va">gene_df</span><span class="op">$</span><span class="va">expression</span> <span class="op">&gt;</span> <span class="fl">8</span>, <span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>  gene_id expression mutation    pathway
1   BRCA1        8.2      Yes DNA Repair
3     MYC        9.5      Yes Cell Cycle
5   GAPDH       10.0       No Metabolism</code></pre>
</div>
<div class="sourceCode" id="cb246"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gene_df</span><span class="op">[</span><span class="va">gene_df</span><span class="op">$</span><span class="va">mutation</span> <span class="op">==</span> <span class="st">"Yes"</span>, <span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>  gene_id expression mutation    pathway
1   BRCA1        8.2      Yes DNA Repair
3     MYC        9.5      Yes Cell Cycle</code></pre>
</div>
<div class="sourceCode" id="cb248"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Multiple conditions</span></span>
<span><span class="va">gene_df</span><span class="op">[</span><span class="va">gene_df</span><span class="op">$</span><span class="va">expression</span> <span class="op">&gt;</span> <span class="fl">7</span> <span class="op">&amp;</span> <span class="va">gene_df</span><span class="op">$</span><span class="va">mutation</span> <span class="op">==</span> <span class="st">"No"</span>, <span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>  gene_id expression mutation    pathway
5   GAPDH         10       No Metabolism</code></pre>
</div>
</div>
<p><strong>Logical Operators</strong></p>
<table class="table">
<thead><tr class="header">
<th>Operator</th>
<th>Meaning</th>
<th>Example</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>==</code></td>
<td>Equal to</td>
<td><code>x == 5</code></td>
</tr>
<tr class="even">
<td><code>!=</code></td>
<td>Not equal</td>
<td><code>x != 5</code></td>
</tr>
<tr class="odd">
<td><code>&lt;</code></td>
<td>Less than</td>
<td><code>x &lt; 5</code></td>
</tr>
<tr class="even">
<td><code>&gt;</code></td>
<td>Greater than</td>
<td><code>x &gt; 5</code></td>
</tr>
<tr class="odd">
<td><code>&lt;=</code></td>
<td>Less or equal</td>
<td><code>x &lt;= 5</code></td>
</tr>
<tr class="even">
<td><code>&gt;=</code></td>
<td>Greater or equal</td>
<td><code>x &gt;= 5</code></td>
</tr>
<tr class="odd">
<td><code>!</code></td>
<td>Not</td>
<td><code>!(x &lt; 5)</code></td>
</tr>
<tr class="even">
<td><code>|</code></td>
<td>OR</td>
<td><code>x &lt; 5 | x &gt; 10</code></td>
</tr>
<tr class="odd">
<td><code>&amp;</code></td>
<td>AND</td>
<td><code>x &gt; 5 &amp; x &lt; 10</code></td>
</tr>
</tbody>
</table></section><section id="row-names-in-data-frames" class="level3"><h3 class="anchored" data-anchor-id="row-names-in-data-frames">Row Names in Data Frames</h3>
<p>Row names are particularly important in bioinformatics where genes, proteins, or samples are often used as identifiers.</p>
<div class="cell">
<div class="sourceCode" id="cb250"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Setting row names for gene_df</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">gene_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">gene_df</span><span class="op">$</span><span class="va">gene_id</span></span>
<span><span class="va">gene_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>      gene_id expression mutation    pathway
BRCA1   BRCA1        8.2      Yes DNA Repair
TP53     TP53        6.1       No  Apoptosis
MYC       MYC        9.5      Yes Cell Cycle
EGFR     EGFR        7.0       No  Signaling
GAPDH   GAPDH       10.0       No Metabolism</code></pre>
</div>
</div>
<p><br> We can now drop the gene_id column, if required.</p>
<div class="cell">
<div class="sourceCode" id="cb252"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gene_df_clean</span> <span class="op">&lt;-</span> <span class="va">gene_df</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>  <span class="co"># Remove the first column</span></span>
<span><span class="va">gene_df_clean</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>      expression mutation    pathway
BRCA1        8.2      Yes DNA Repair
TP53         6.1       No  Apoptosis
MYC          9.5      Yes Cell Cycle
EGFR         7.0       No  Signaling
GAPDH       10.0       No Metabolism</code></pre>
</div>
<div class="sourceCode" id="cb254"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Access rows by name</span></span>
<span><span class="va">gene_df_clean</span><span class="op">[</span><span class="st">"TP53"</span>, <span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>     expression mutation   pathway
TP53        6.1       No Apoptosis</code></pre>
</div>
<div class="sourceCode" id="cb256"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Check if row names are unique</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">gene_df_clean</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode" id="cb258"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Handle potential duplicated row names</span></span>
<span><span class="co"># NOTE: R doesn't allow duplicate row names by default</span></span>
<span><span class="va">dup_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  expression <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5.2</span>, <span class="fl">6.3</span>, <span class="fl">5.2</span>, <span class="fl">8.1</span><span class="op">)</span>,</span>
<span>  mutation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Yes"</span>, <span class="st">"No"</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This would cause an error:</span></span>
<span><span class="co"># rownames(dup_genes) &lt;- c("BRCA1", "BRCA1", "TP53", "EGFR")</span></span>
<span></span>
<span><span class="co"># Instead, we can preemptively make them unique:</span></span>
<span><span class="va">proposed_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BRCA1"</span>, <span class="st">"BRCA1"</span>, <span class="st">"TP53"</span>, <span class="st">"EGFR"</span><span class="op">)</span></span>
<span><span class="va">unique_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/make.unique.html">make.unique</a></span><span class="op">(</span><span class="va">proposed_names</span><span class="op">)</span></span>
<span><span class="va">unique_names</span>  <span class="co"># Show the generated unique names</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] "BRCA1"   "BRCA1.1" "TP53"    "EGFR"   </code></pre>
</div>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Now we can safely assign them</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">dup_genes</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">unique_names</span></span>
<span><span class="va">dup_genes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>        expression mutation
BRCA1          5.2      Yes
BRCA1.1        6.3       No
TP53           5.2      Yes
EGFR           8.1       No</code></pre>
</div>
</div>
</section></section><section id="handling-missingwrong-values" class="level2"><h2 class="anchored" data-anchor-id="handling-missingwrong-values">Handling Missing/Wrong Values</h2>
<section id="identifying-issues" class="level3"><h3 class="anchored" data-anchor-id="identifying-issues">Identifying Issues</h3>
<div class="cell">
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create data with missing values</span></span>
<span><span class="va">clinical_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  patient_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,</span>
<span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">99</span>, <span class="fl">30</span>, <span class="op">-</span><span class="fl">5</span>, <span class="fl">40</span><span class="op">)</span>,    <span class="co"># -5 is wrong, 99 is suspect</span></span>
<span>  bp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">120</span>, <span class="cn">NA</span>, <span class="fl">115</span>, <span class="fl">125</span>, <span class="fl">118</span><span class="op">)</span>,  <span class="co"># NA is missing</span></span>
<span>  weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">65</span>, <span class="fl">70</span>, <span class="cn">NA</span>, <span class="fl">68</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>   <span class="co"># -1 is wrong</span></span>
<span><span class="op">)</span></span>
<span><span class="va">clinical_data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>  patient_id age  bp weight
1          1  25 120     65
2          2  99  NA     70
3          3  30 115     NA
4          4  -5 125     68
5          5  40 118     -1</code></pre>
</div>
<div class="sourceCode" id="cb264"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Check for missing values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">clinical_data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>     patient_id   age    bp weight
[1,]      FALSE FALSE FALSE  FALSE
[2,]      FALSE FALSE  TRUE  FALSE
[3,]      FALSE FALSE FALSE   TRUE
[4,]      FALSE FALSE FALSE  FALSE
[5,]      FALSE FALSE FALSE  FALSE</code></pre>
</div>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">clinical_data</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Count NAs by column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>patient_id        age         bp     weight 
         0          0          1          1 </code></pre>
</div>
<div class="sourceCode" id="cb268"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Check for impossible values</span></span>
<span><span class="va">clinical_data</span><span class="op">$</span><span class="va">age</span> <span class="op">&lt;</span> <span class="fl">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] FALSE FALSE FALSE  TRUE FALSE</code></pre>
</div>
<div class="sourceCode" id="cb270"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clinical_data</span><span class="op">$</span><span class="va">weight</span> <span class="op">&lt;</span> <span class="fl">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] FALSE FALSE    NA FALSE  TRUE</code></pre>
</div>
<div class="sourceCode" id="cb272"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Find indices of problematic values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">clinical_data</span><span class="op">$</span><span class="va">age</span> <span class="op">&lt;</span> <span class="fl">0</span> <span class="op">|</span> <span class="va">clinical_data</span><span class="op">$</span><span class="va">age</span> <span class="op">&gt;</span> <span class="fl">90</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 2 4</code></pre>
</div>
</div>
</section><section id="fixing-data" class="level3"><h3 class="anchored" data-anchor-id="fixing-data">Fixing Data</h3>
<div class="cell">
<div class="sourceCode" id="cb274"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Replace impossible values with NA</span></span>
<span><span class="va">clinical_data</span><span class="op">$</span><span class="va">age</span><span class="op">[</span><span class="va">clinical_data</span><span class="op">$</span><span class="va">age</span> <span class="op">&lt;</span> <span class="fl">0</span> <span class="op">|</span> <span class="va">clinical_data</span><span class="op">$</span><span class="va">age</span> <span class="op">&gt;</span> <span class="fl">90</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">clinical_data</span><span class="op">$</span><span class="va">weight</span><span class="op">[</span><span class="va">clinical_data</span><span class="op">$</span><span class="va">weight</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">clinical_data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>  patient_id age  bp weight
1          1  25 120     65
2          2  NA  NA     70
3          3  30 115     NA
4          4  NA 125     68
5          5  40 118     NA</code></pre>
</div>
<div class="sourceCode" id="cb276"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Replace NAs with mean (common in biological data)</span></span>
<span><span class="va">clinical_data</span><span class="op">$</span><span class="va">bp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">clinical_data</span><span class="op">$</span><span class="va">bp</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">clinical_data</span><span class="op">$</span><span class="va">bp</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">clinical_data</span><span class="op">$</span><span class="va">weight</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">clinical_data</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">clinical_data</span><span class="op">$</span><span class="va">weight</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">clinical_data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>  patient_id age    bp   weight
1          1  25 120.0 65.00000
2          2  NA 119.5 70.00000
3          3  30 115.0 67.66667
4          4  NA 125.0 68.00000
5          5  40 118.0 67.66667</code></pre>
</div>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Replace NAs with median (better for skewed data)</span></span>
<span><span class="va">clinical_data</span><span class="op">$</span><span class="va">age</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">clinical_data</span><span class="op">$</span><span class="va">age</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">clinical_data</span><span class="op">$</span><span class="va">age</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">clinical_data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>  patient_id age    bp   weight
1          1  25 120.0 65.00000
2          2  30 119.5 70.00000
3          3  30 115.0 67.66667
4          4  30 125.0 68.00000
5          5  40 118.0 67.66667</code></pre>
</div>
</div>
</section></section><section id="data-transformation" class="level2"><h2 class="anchored" data-anchor-id="data-transformation">Data Transformation</h2>
<section id="introduction-to-outliers" class="level3"><h3 class="anchored" data-anchor-id="introduction-to-outliers">Introduction to Outliers</h3>
<p>Outliers can significantly affect statistical analyses, especially in biological data where sample variation can be high.</p>
<div class="cell">
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create data with outliers</span></span>
<span><span class="va">expression_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2.3</span>, <span class="fl">2.7</span>, <span class="fl">3.1</span>, <span class="fl">2.9</span>, <span class="fl">2.5</span>, <span class="fl">3.0</span>, <span class="fl">15.2</span>, <span class="fl">2.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">expression_levels</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"Expression Levels with Outlier"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Expression"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="firststeps_files/figure-html/outliers-1.png" class="img-fluid" width="1650"></p>
</div>
</div>
</section><section id="identifying-outliers" class="level3"><h3 class="anchored" data-anchor-id="identifying-outliers">Identifying Outliers</h3>
<div class="cell">
<div class="sourceCode" id="cb281"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Statistical approach: Values beyond 1.5*IQR</span></span>
<span><span class="va">data_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">expression_levels</span><span class="op">)</span></span>
<span><span class="va">data_summary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  2.300   2.650   2.850   4.312   3.025  15.200 </code></pre>
</div>
<div class="sourceCode" id="cb283"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">IQR_value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/IQR.html">IQR</a></span><span class="op">(</span><span class="va">expression_levels</span><span class="op">)</span></span>
<span><span class="va">upper_bound</span> <span class="op">&lt;-</span> <span class="va">data_summary</span><span class="op">[</span><span class="st">"3rd Qu."</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> <span class="va">IQR_value</span></span>
<span><span class="va">lower_bound</span> <span class="op">&lt;-</span> <span class="va">data_summary</span><span class="op">[</span><span class="st">"1st Qu."</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> <span class="va">IQR_value</span></span>
<span></span>
<span><span class="co"># Find outliers</span></span>
<span><span class="va">outliers</span> <span class="op">&lt;-</span> <span class="va">expression_levels</span><span class="op">[</span><span class="va">expression_levels</span> <span class="op">&gt;</span> <span class="va">upper_bound</span> <span class="op">|</span> </span>
<span>                             <span class="va">expression_levels</span> <span class="op">&lt;</span> <span class="va">lower_bound</span><span class="op">]</span></span>
<span><span class="va">outliers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] 15.2</code></pre>
</div>
</div>
</section><section id="transforming-vectors" class="level3"><h3 class="anchored" data-anchor-id="transforming-vectors">Transforming Vectors</h3>
<p>Mathematical transformations can normalize data, reduce outlier effects, and make data more suitable for statistical analyses.</p>
<div class="cell">
<div class="sourceCode" id="cb285"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Original data</span></span>
<span><span class="va">gene_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">42</span>, <span class="fl">87</span>, <span class="fl">115</span>, <span class="fl">320</span>, <span class="fl">560</span>, <span class="fl">1120</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">gene_exp</span>, main <span class="op">=</span> <span class="st">"Original Expression Values"</span>, xlab <span class="op">=</span> <span class="st">"Expression"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="firststeps_files/figure-html/transformations-1.png" class="img-fluid" width="1650"></p>
</div>
<div class="sourceCode" id="cb286"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Log transformation (common in gene expression analysis)</span></span>
<span><span class="va">log_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="va">gene_exp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">log_exp</span>, main <span class="op">=</span> <span class="st">"Log2 Transformed Expression"</span>, xlab <span class="op">=</span> <span class="st">"Log2 Expression"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="firststeps_files/figure-html/transformations-2.png" class="img-fluid" width="1650"></p>
</div>
<div class="sourceCode" id="cb287"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Square root transformation (less aggressive than log)</span></span>
<span><span class="va">sqrt_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">gene_exp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">sqrt_exp</span>, main <span class="op">=</span> <span class="st">"Square Root Transformed Expression"</span>, xlab <span class="op">=</span> <span class="st">"Sqrt Expression"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="firststeps_files/figure-html/transformations-3.png" class="img-fluid" width="1650"></p>
</div>
<div class="sourceCode" id="cb288"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Z-score normalization (standardization)</span></span>
<span><span class="va">z_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">gene_exp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">z_exp</span>, main <span class="op">=</span> <span class="st">"Z-score Normalized Expression"</span>, xlab <span class="op">=</span> <span class="st">"Z-score"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="firststeps_files/figure-html/transformations-4.png" class="img-fluid" width="1650"></p>
</div>
<div class="sourceCode" id="cb289"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compare transformations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">gene_exp</span>, main <span class="op">=</span> <span class="st">"Original"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">log_exp</span>, main <span class="op">=</span> <span class="st">"Log2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">sqrt_exp</span>, main <span class="op">=</span> <span class="st">"Square Root"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">z_exp</span>, main <span class="op">=</span> <span class="st">"Z-score"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="firststeps_files/figure-html/transformations-5.png" class="img-fluid" width="1650"></p>
</div>
<div class="sourceCode" id="cb290"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Reset plotting layout</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="logical-expressions" class="level3"><h3 class="anchored" data-anchor-id="logical-expressions">Logical Expressions</h3>
<div class="cell">
<div class="sourceCode" id="cb291"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create gene expression vector</span></span>
<span><span class="va">exp_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5.2</span>, <span class="fl">3.8</span>, <span class="fl">7.1</span>, <span class="fl">2.9</span>, <span class="fl">6.5</span>, <span class="fl">8.0</span>, <span class="fl">4.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">exp_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Gene_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Basic comparisons</span></span>
<span><span class="va">exp_data</span> <span class="op">&gt;</span> <span class="fl">5</span>    <span class="co"># Which genes have expression &gt; 5?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Gene_1 Gene_2 Gene_3 Gene_4 Gene_5 Gene_6 Gene_7 
  TRUE  FALSE   TRUE  FALSE   TRUE   TRUE  FALSE </code></pre>
</div>
<div class="sourceCode" id="cb293"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">exp_data</span> <span class="op">&lt;=</span> <span class="fl">4</span>   <span class="co"># Which genes have expression &lt;= 4?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Gene_1 Gene_2 Gene_3 Gene_4 Gene_5 Gene_6 Gene_7 
 FALSE   TRUE  FALSE   TRUE  FALSE  FALSE  FALSE </code></pre>
</div>
<div class="sourceCode" id="cb295"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Store results in logical vector</span></span>
<span><span class="va">high_exp</span> <span class="op">&lt;-</span> <span class="va">exp_data</span> <span class="op">&gt;</span> <span class="fl">6</span></span>
<span><span class="va">high_exp</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Gene_1 Gene_2 Gene_3 Gene_4 Gene_5 Gene_6 Gene_7 
 FALSE  FALSE   TRUE  FALSE   TRUE   TRUE  FALSE </code></pre>
</div>
<div class="sourceCode" id="cb297"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Use logical vectors for subsetting</span></span>
<span><span class="va">exp_data</span><span class="op">[</span><span class="va">high_exp</span><span class="op">]</span>  <span class="co"># Get high expression values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Gene_3 Gene_5 Gene_6 
   7.1    6.5    8.0 </code></pre>
</div>
</div>
</section><section id="logical-operators" class="level3"><h3 class="anchored" data-anchor-id="logical-operators">Logical Operators</h3>
<div class="cell">
<div class="sourceCode" id="cb299"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Combining conditions with AND (&amp;)</span></span>
<span><span class="va">exp_data</span> <span class="op">&gt;</span> <span class="fl">4</span> <span class="op">&amp;</span> <span class="va">exp_data</span> <span class="op">&lt;</span> <span class="fl">7</span>  <span class="co"># Expression between 4 and 7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Gene_1 Gene_2 Gene_3 Gene_4 Gene_5 Gene_6 Gene_7 
  TRUE  FALSE  FALSE  FALSE   TRUE  FALSE   TRUE </code></pre>
</div>
<div class="sourceCode" id="cb301"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Combining conditions with OR (|)</span></span>
<span><span class="va">exp_data</span> <span class="op">&lt;</span> <span class="fl">4</span> <span class="op">|</span> <span class="va">exp_data</span> <span class="op">&gt;</span> <span class="fl">7</span>  <span class="co"># Expression less than 4 OR greater than 7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Gene_1 Gene_2 Gene_3 Gene_4 Gene_5 Gene_6 Gene_7 
 FALSE   TRUE   TRUE   TRUE  FALSE   TRUE  FALSE </code></pre>
</div>
<div class="sourceCode" id="cb303"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Using NOT (!)</span></span>
<span><span class="op">!</span><span class="va">high_exp</span>  <span class="co"># Not high expression</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Gene_1 Gene_2 Gene_3 Gene_4 Gene_5 Gene_6 Gene_7 
  TRUE   TRUE  FALSE   TRUE  FALSE  FALSE   TRUE </code></pre>
</div>
<div class="sourceCode" id="cb305"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Subsetting with combined conditions</span></span>
<span><span class="va">exp_data</span><span class="op">[</span><span class="va">exp_data</span> <span class="op">&gt;</span> <span class="fl">4</span> <span class="op">&amp;</span> <span class="va">exp_data</span> <span class="op">&lt;</span> <span class="fl">7</span><span class="op">]</span>  <span class="co"># Get values between 4 and 7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Gene_1 Gene_5 Gene_7 
   5.2    6.5    4.3 </code></pre>
</div>
</div>
</section><section id="logical-functions" class="level3"><h3 class="anchored" data-anchor-id="logical-functions">Logical Functions</h3>
<div class="cell">
<div class="sourceCode" id="cb307"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># all() - Are all values TRUE?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">exp_data</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>  <span class="co"># Are all expressions positive?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode" id="cb309"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># any() - Is at least one value TRUE?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">exp_data</span> <span class="op">&gt;</span> <span class="fl">7</span><span class="op">)</span>  <span class="co"># Is any expression greater than 7?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode" id="cb311"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># which() - Get indices of TRUE values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">exp_data</span> <span class="op">&gt;</span> <span class="fl">6</span><span class="op">)</span>  <span class="co"># Which elements have expressions &gt; 6?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>Gene_3 Gene_5 Gene_6 
     3      5      6 </code></pre>
</div>
<div class="sourceCode" id="cb313"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># %in% operator - Test for membership</span></span>
<span><span class="va">test_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Gene_1"</span>, <span class="st">"Gene_5"</span>, <span class="st">"Gene_9"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">exp_data</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">test_genes</span>  <span class="co"># Which names match test_genes?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1]  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE</code></pre>
</div>
</div>
</section><section id="conditionals" class="level3"><h3 class="anchored" data-anchor-id="conditionals">Conditionals</h3>
<div class="cell">
<div class="sourceCode" id="cb315"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># if-else statement</span></span>
<span><span class="va">gene_value</span> <span class="op">&lt;-</span> <span class="fl">6.8</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="va">gene_value</span> <span class="op">&gt;</span> <span class="fl">6</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"High expression\n"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">gene_value</span> <span class="op">&gt;</span> <span class="fl">4</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Medium expression\n"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Low expression\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>High expression</code></pre>
</div>
<div class="sourceCode" id="cb317"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ifelse() for vectors</span></span>
<span><span class="va">expression_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">5.8</span>, <span class="fl">7.2</span>, <span class="fl">3.1</span>, <span class="fl">6.9</span><span class="op">)</span></span>
<span><span class="va">expression_category</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">expression_levels</span> <span class="op">&gt;</span> <span class="fl">6</span>, </span>
<span>                             <span class="st">"High"</span>, </span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">expression_levels</span> <span class="op">&gt;</span> <span class="fl">4</span>, <span class="st">"Medium"</span>, <span class="st">"Low"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">expression_category</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="custom-output"><code>[1] "Low"    "Medium" "High"   "Low"    "High"  </code></pre>
</div>
</div>
</section></section><section id="practical-session" class="level2"><h2 class="anchored" data-anchor-id="practical-session">Practical Session</h2>
<p>Check out this repo: <code>https://github.com/genomicsclass/dagdata/</code></p>
<div class="cell">
<div class="sourceCode" id="cb319"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Download small example dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span><span class="st">"https://github.com/genomicsclass/dagdata/raw/master/inst/extdata/msleep_ggplot2.csv"</span>,</span>
<span>              destfile <span class="op">=</span> <span class="st">"msleep_data.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load data</span></span>
<span><span class="va">msleep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"msleep_data.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>In-class Tasks:</strong></p>
<ol type="1">
<li>Convert ‘vore’ column to factor and plot its distribution.<br>
</li>
<li>Create a matrix of sleep data columns and add row names.<br>
</li>
<li>Find and handle any missing values.<br>
</li>
<li>Calculate mean sleep time by diet category (vore).<br>
</li>
<li>Identify outliers in sleep_total.</li>
</ol></section><section id="summary-of-todays-lesson" class="level2"><h2 class="anchored" data-anchor-id="summary-of-todays-lesson">Summary of Today’s Lesson</h2>
<p>In today’s class, we covered:</p>
<ol type="1">
<li>
<p><strong>Factor Variables</strong>: Essential for categorical data in biology (genotypes, treatments, etc.)</p>
<ul>
<li>Creation, levels, ordering, and visualization</li>
</ul>
</li>
<li>
<p><strong>Subsetting Techniques</strong>: Critical for data extraction and analysis</p>
<ul>
<li>Vector and data frame subsetting with various methods</li>
<li>Using row names effectively for biological identifiers</li>
</ul>
</li>
<li>
<p><strong>Matrix Operations</strong>: Fundamental for expression data</p>
<ul>
<li>Creation, manipulation, and biological applications</li>
<li>Calculating fold changes and other common operations</li>
</ul>
</li>
<li>
<p><strong>Missing Values</strong>: Practical approaches for real-world biological data</p>
<ul>
<li>Identification and appropriate replacement methods</li>
</ul>
</li>
<li>
<p><strong>Data Transformation</strong>: Making data suitable for statistical analysis</p>
<ul>
<li>Log, square root, and z-score transformations</li>
<li>Outlier identification and handling</li>
</ul>
</li>
<li>
<p><strong>Logical Operations</strong>: For data filtering and decision making</p>
<ul>
<li>Conditions, combinations, and applications</li>
</ul>
<p>These skills form the foundation for the more advanced visualization techniques we’ll cover in future lessons.</p>
</li>
<li><p>We will know more about conditionals, R packages to handle data and visualization in a better and efficient way.</p></li>
<li>
<p><strong>List</strong>: Fundamental for many biological data and packages’ output.</p>
<ul>
<li>Properties, accessing, and applications</li>
</ul>
</li>
</ol></section><section id="homework" class="level2"><h2 class="anchored" data-anchor-id="homework">Homework</h2>
<ol type="1">
<li>
<strong>Matrix Operations</strong>:
<ul>
<li>Create a gene expression matrix with 8 genes and 4 conditions</li>
<li>Calculate the mean expression for each gene</li>
<li>Calculate fold change between condition 4 and condition 1</li>
<li>Create a heatmap of your matrix</li>
</ul>
</li>
<li>
<strong>Factor Analysis</strong>:
<ul>
<li>Using the <code>iris</code> dataset, convert Species to an ordered factor</li>
<li>Create boxplots showing Sepal.Length by Species</li>
<li>Calculate mean petal length for each species level</li>
</ul>
</li>
<li>
<strong>Data Cleaning Challenge</strong>:
<ul>
<li>In the downloaded <code>msleep_data.csv</code>:
<ul>
<li>Identify all columns with missing values</li>
<li>Replace missing values appropriately</li>
<li>Create a new categorical variable “sleep_duration” with levels “Short”, “Medium”, “Long”</li>
</ul>
</li>
</ul>
</li>
<li>
<strong>List challenge</strong>:
<ul>
<li>Make your own lists</li>
<li>Replicate all the tasks we did</li>
<li>You may ask AI to give you beginner-level questions but don’t ask to solve the questions programmatically. Tell AI not to provide answers.</li>
</ul>
</li>
<li>
<strong>Complete Documentation</strong>:
<ul>
<li>Write all code in R Markdown</li>
<li>Include comments explaining your approach</li>
<li>Push to GitHub</li>
</ul>
</li>
</ol>
<section id="due-date-friday-10pm-bd-time" class="level4"><h4 class="anchored" data-anchor-id="due-date-friday-10pm-bd-time">Due date: Friday 10pm BD Time</h4>


<!-- -->

</section></section></section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{rasheduzzaman2025,
  author = {Md Rasheduzzaman},
  title = {Basic {R}},
  date = {2025-04-26},
  langid = {en},
  abstract = {Data types, variables, vectors, data frame, functions}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-rasheduzzaman2025" class="csl-entry quarto-appendix-citeas" role="listitem">
Md Rasheduzzaman. 2025. <span>“Basic R.”</span> April 26, 2025.
</div></div></section></div></main><!-- /main --><hr>
<div style="margin-top: 2em;">
  <p style="font-weight: 500; font-size: 1.1em;">
    💬 Have thoughts or questions? Join the discussion below using your GitHub account!
  </p>
  <p style="font-size: 0.95em; color: #666;">
    You can <strong>edit or delete</strong> your own comments. Reactions like 👍 ❤️ 🚀 are also supported.
  </p>
</div>

<div id="giscus_thread" style="margin-top: 1.5em;"></div>

<script src="https://giscus.app/client.js" data-repo="MdRasheduz-zaman/PythRaSh" data-repo-id="R_kgDOOZN9Xw" data-category-id="DIC_kwDOOZN9X84CpE6N" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="en" data-loading="lazy" crossorigin="anonymous" async="">
</script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb320" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb320-2"><a href="#cb320-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Basic R"</span></span>
<span id="cb320-3"><a href="#cb320-3" aria-hidden="true" tabindex="-1"></a><span class="an">abstract:</span><span class="co"> "Data types, variables, vectors, data frame, functions"</span></span>
<span id="cb320-4"><a href="#cb320-4" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb320-5"><a href="#cb320-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-6"><a href="#cb320-6" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;style&gt;</span></span>
<span id="cb320-7"><a href="#cb320-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">.content</span> {</span>
<span id="cb320-8"><a href="#cb320-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">text-align</span>: <span class="dv">justify</span> <span class="at">!important</span><span class="op">;</span></span>
<span id="cb320-9"><a href="#cb320-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb320-10"><a href="#cb320-10" aria-hidden="true" tabindex="-1"></a>  p {</span>
<span id="cb320-11"><a href="#cb320-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">text-align</span>: <span class="dv">justify</span> <span class="at">!important</span><span class="op">;</span></span>
<span id="cb320-12"><a href="#cb320-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb320-13"><a href="#cb320-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">.quarto-body</span> {</span>
<span id="cb320-14"><a href="#cb320-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">text-align</span>: <span class="dv">justify</span> <span class="at">!important</span><span class="op">;</span></span>
<span id="cb320-15"><a href="#cb320-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb320-16"><a href="#cb320-16" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/style&gt;</span></span>
<span id="cb320-17"><a href="#cb320-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-20"><a href="#cb320-20" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb320-21"><a href="#cb320-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb320-22"><a href="#cb320-22" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"src/helpersrc.R"</span>))</span>
<span id="cb320-23"><a href="#cb320-23" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-24"><a href="#cb320-24" aria-hidden="true" tabindex="-1"></a><span class="fu"># L2: Data Representation  </span></span>
<span id="cb320-25"><a href="#cb320-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-26"><a href="#cb320-26" aria-hidden="true" tabindex="-1"></a><span class="fu">## Using R as a Calculator  </span></span>
<span id="cb320-27"><a href="#cb320-27" aria-hidden="true" tabindex="-1"></a>Let's do some basic calculation.  </span>
<span id="cb320-30"><a href="#cb320-30" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb320-31"><a href="#cb320-31" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="sc">+</span><span class="dv">3</span></span>
<span id="cb320-32"><a href="#cb320-32" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="sc">+</span><span class="dv">2</span></span>
<span id="cb320-33"><a href="#cb320-33" aria-hidden="true" tabindex="-1"></a><span class="dv">3-2</span></span>
<span id="cb320-34"><a href="#cb320-34" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="sc">*</span><span class="dv">2</span></span>
<span id="cb320-35"><a href="#cb320-35" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span> <span class="co">#normal division</span></span>
<span id="cb320-36"><a href="#cb320-36" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span> <span class="sc">%/%</span> <span class="dv">2</span> <span class="co">#integer division, only the quotient</span></span>
<span id="cb320-37"><a href="#cb320-37" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="sc">%%</span> <span class="dv">3</span> <span class="co">#modulus division, the remainder</span></span>
<span id="cb320-38"><a href="#cb320-38" aria-hidden="true" tabindex="-1"></a>(<span class="dv">10-5</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">4</span>) <span class="co">#use of parentheses</span></span>
<span id="cb320-39"><a href="#cb320-39" aria-hidden="true" tabindex="-1"></a><span class="dv">10-5</span><span class="sc">*</span><span class="dv">2</span><span class="sc">+</span><span class="dv">4</span> <span class="co">#Noticed BODMAS?</span></span>
<span id="cb320-40"><a href="#cb320-40" aria-hidden="true" tabindex="-1"></a>(<span class="dv">10-5</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">4</span>) <span class="co">#Noticed BODMAS</span></span>
<span id="cb320-41"><a href="#cb320-41" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="dv">3</span>); <span class="dv">7</span><span class="sc">/</span><span class="dv">1</span><span class="sc">+</span><span class="dv">3</span> <span class="co">#multi-line codes, separated with semi-colon</span></span>
<span id="cb320-42"><a href="#cb320-42" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">+</span><span class="dv">2</span>; <span class="fu">log</span>(<span class="dv">1</span>); <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span> <span class="co">#more multi-line codes</span></span>
<span id="cb320-43"><a href="#cb320-43" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-44"><a href="#cb320-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-45"><a href="#cb320-45" aria-hidden="true" tabindex="-1"></a><span class="fu">## Variables  </span></span>
<span id="cb320-46"><a href="#cb320-46" aria-hidden="true" tabindex="-1"></a>Variables are variable. We have freedom to name them as we wish. But make any variable name meaningful and identifiable.  </span>
<span id="cb320-49"><a href="#cb320-49" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb320-50"><a href="#cb320-50" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co">#assign value 5 to a </span></span>
<span id="cb320-51"><a href="#cb320-51" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb320-52"><a href="#cb320-52" aria-hidden="true" tabindex="-1"></a>a</span>
<span id="cb320-53"><a href="#cb320-53" aria-hidden="true" tabindex="-1"></a>b</span>
<span id="cb320-54"><a href="#cb320-54" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> a <span class="sc">+</span> <span class="dv">10</span></span>
<span id="cb320-55"><a href="#cb320-55" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> b <span class="sc">+</span> <span class="dv">15</span></span>
<span id="cb320-56"><a href="#cb320-56" aria-hidden="true" tabindex="-1"></a>a</span>
<span id="cb320-57"><a href="#cb320-57" aria-hidden="true" tabindex="-1"></a>a<span class="sc">^</span><span class="dv">2</span> <span class="co">#a squared</span></span>
<span id="cb320-58"><a href="#cb320-58" aria-hidden="true" tabindex="-1"></a>a<span class="sc">**</span><span class="dv">2</span> <span class="co">#a squared again, in a different way.</span></span>
<span id="cb320-59"><a href="#cb320-59" aria-hidden="true" tabindex="-1"></a>a<span class="sc">^</span><span class="dv">3</span> <span class="co">#a qubed</span></span>
<span id="cb320-60"><a href="#cb320-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-61"><a href="#cb320-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-62"><a href="#cb320-62" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb320-63"><a href="#cb320-63" aria-hidden="true" tabindex="-1"></a><span class="in">`&lt;-`</span> and <span class="in">`=`</span> are used to assign values. It is not mathematical equality. <span class="in">`b &lt;- b + 15`</span> might make better sense than <span class="in">`b = b + 15`</span>.</span>
<span id="cb320-64"><a href="#cb320-64" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb320-65"><a href="#cb320-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-66"><a href="#cb320-66" aria-hidden="true" tabindex="-1"></a><span class="fu">### Integer and Modulus division again  </span></span>
<span id="cb320-67"><a href="#cb320-67" aria-hidden="true" tabindex="-1"></a>Do some more practice.  </span>
<span id="cb320-70"><a href="#cb320-70" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb320-71"><a href="#cb320-71" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span><span class="sc">/</span><span class="dv">3</span></span>
<span id="cb320-72"><a href="#cb320-72" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span><span class="sc">%/%</span><span class="dv">3</span></span>
<span id="cb320-73"><a href="#cb320-73" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span><span class="sc">%%</span><span class="dv">3</span></span>
<span id="cb320-74"><a href="#cb320-74" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-75"><a href="#cb320-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-76"><a href="#cb320-76" aria-hidden="true" tabindex="-1"></a><span class="fu">## Rounding  </span></span>
<span id="cb320-77"><a href="#cb320-77" aria-hidden="true" tabindex="-1"></a>Some important functions we apply on numerical values  </span>
<span id="cb320-80"><a href="#cb320-80" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb320-81"><a href="#cb320-81" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">9</span><span class="sc">/</span><span class="dv">4</span></span>
<span id="cb320-82"><a href="#cb320-82" aria-hidden="true" tabindex="-1"></a><span class="fu">floor</span>(x)</span>
<span id="cb320-83"><a href="#cb320-83" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(x)</span>
<span id="cb320-84"><a href="#cb320-84" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(x)</span>
<span id="cb320-85"><a href="#cb320-85" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(x, <span class="dv">2</span>) <span class="co">#round till 2 decimal points</span></span>
<span id="cb320-86"><a href="#cb320-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-87"><a href="#cb320-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-88"><a href="#cb320-88" aria-hidden="true" tabindex="-1"></a><span class="fu">## Logical Operations  </span></span>
<span id="cb320-89"><a href="#cb320-89" aria-hidden="true" tabindex="-1"></a>Get to know TRUE/FALSE in R.  </span>
<span id="cb320-92"><a href="#cb320-92" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb320-93"><a href="#cb320-93" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb320-94"><a href="#cb320-94" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">7</span></span>
<span id="cb320-95"><a href="#cb320-95" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb320-96"><a href="#cb320-96" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb320-97"><a href="#cb320-97" aria-hidden="true" tabindex="-1"></a>a <span class="sc">==</span> b <span class="co">#is a equal to b? Ans: No/FALSE</span></span>
<span id="cb320-98"><a href="#cb320-98" aria-hidden="true" tabindex="-1"></a>a <span class="sc">!=</span> b <span class="co">#is a not equal to b? Ans: Yes/TRUE</span></span>
<span id="cb320-99"><a href="#cb320-99" aria-hidden="true" tabindex="-1"></a>a <span class="sc">&gt;</span> b <span class="co">#is a greater than b? Ans: FALSE</span></span>
<span id="cb320-100"><a href="#cb320-100" aria-hidden="true" tabindex="-1"></a>a <span class="sc">&lt;</span> b <span class="co">#is a less than b? Ans: TRUE</span></span>
<span id="cb320-101"><a href="#cb320-101" aria-hidden="true" tabindex="-1"></a>a <span class="sc">&gt;=</span> b <span class="co">#is a greater than or equal to b? Ans: FALSE</span></span>
<span id="cb320-102"><a href="#cb320-102" aria-hidden="true" tabindex="-1"></a>a <span class="sc">&lt;=</span> b <span class="co">#is a less than or equal to b? Ans: TRUE</span></span>
<span id="cb320-103"><a href="#cb320-103" aria-hidden="true" tabindex="-1"></a>a <span class="sc">&lt;</span> b <span class="sc">|</span> d <span class="sc">&gt;</span> b <span class="co">#is a less than b OR d greater than b?</span></span>
<span id="cb320-104"><a href="#cb320-104" aria-hidden="true" tabindex="-1"></a><span class="co">#It's answer will be TRUE OR FALSE --&gt; So, TRUE</span></span>
<span id="cb320-105"><a href="#cb320-105" aria-hidden="true" tabindex="-1"></a>a <span class="sc">&lt;</span> b <span class="sc">&amp;</span> c <span class="sc">&gt;</span> d <span class="co">#is a less than b AND a greater than b? It's answer will be TRUE AND TRUE --&gt; So, TRUE</span></span>
<span id="cb320-106"><a href="#cb320-106" aria-hidden="true" tabindex="-1"></a>a <span class="sc">&lt;</span> b <span class="sc">&amp;</span> d <span class="sc">&gt;</span> c <span class="co">#is a less than b AND a greater than b? It's answer will be TRUE AND FALSE --&gt; So, FALSE</span></span>
<span id="cb320-107"><a href="#cb320-107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-108"><a href="#cb320-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-109"><a href="#cb320-109" aria-hidden="true" tabindex="-1"></a><span class="fu">## Help and Documentation  </span></span>
<span id="cb320-110"><a href="#cb320-110" aria-hidden="true" tabindex="-1"></a>But how to know more about a function? The package/library developer have written helpful documentation for us.  </span>
<span id="cb320-113"><a href="#cb320-113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb320-114"><a href="#cb320-114" aria-hidden="true" tabindex="-1"></a>?log</span>
<span id="cb320-115"><a href="#cb320-115" aria-hidden="true" tabindex="-1"></a><span class="fu">example</span>(log)</span>
<span id="cb320-116"><a href="#cb320-116" aria-hidden="true" tabindex="-1"></a>?<span class="fu">log</span>()</span>
<span id="cb320-117"><a href="#cb320-117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-118"><a href="#cb320-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-119"><a href="#cb320-119" aria-hidden="true" tabindex="-1"></a><span class="fu">## Working with Vectors  </span></span>
<span id="cb320-120"><a href="#cb320-120" aria-hidden="true" tabindex="-1"></a>What is a vector? See the example and think.  </span>
<span id="cb320-123"><a href="#cb320-123" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb320-124"><a href="#cb320-124" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>) <span class="co">#c means concatenate</span></span>
<span id="cb320-125"><a href="#cb320-125" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span> <span class="co">#consecutively, from 1 through 5. A short-hand notation using :</span></span>
<span id="cb320-126"><a href="#cb320-126" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">20</span>)</span>
<span id="cb320-127"><a href="#cb320-127" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(x)</span>
<span id="cb320-128"><a href="#cb320-128" aria-hidden="true" tabindex="-1"></a><span class="fu">mode</span>(x)</span>
<span id="cb320-129"><a href="#cb320-129" aria-hidden="true" tabindex="-1"></a><span class="fu">is</span>(x)</span>
<span id="cb320-130"><a href="#cb320-130" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="co">#first entry in vector y</span></span>
<span id="cb320-131"><a href="#cb320-131" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>] <span class="co">#2nd to 5th entries in vector y</span></span>
<span id="cb320-132"><a href="#cb320-132" aria-hidden="true" tabindex="-1"></a>DNA <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>) <span class="co">#character vector. Notice the quotation marks.</span></span>
<span id="cb320-133"><a href="#cb320-133" aria-hidden="true" tabindex="-1"></a>dec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">10.0</span>, <span class="fl">20.5</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="fl">80.9</span>, <span class="dv">90</span>, <span class="fl">100.7</span>, <span class="dv">50</span>, <span class="dv">40</span>, <span class="dv">45</span>, <span class="dv">48</span>, <span class="dv">56</span>, <span class="dv">55</span>) <span class="co">#vector of floats. All numbers became floats, it's called coercion</span></span>
<span id="cb320-134"><a href="#cb320-134" aria-hidden="true" tabindex="-1"></a>dec[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">7</span><span class="sc">:</span><span class="fu">length</span>(dec))] <span class="co">#1st to 3rd and then 7th till the end of vector `dec`. Output as a vector.</span></span>
<span id="cb320-135"><a href="#cb320-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-136"><a href="#cb320-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-137"><a href="#cb320-137" aria-hidden="true" tabindex="-1"></a><span class="fu">### Vector Operations  </span></span>
<span id="cb320-138"><a href="#cb320-138" aria-hidden="true" tabindex="-1"></a>Notice the element-wise or index-wise mathematical operations (<span class="in">`+`</span>, <span class="in">`/`</span>, <span class="in">`log2()`</span>, <span class="in">`round()`</span>, etc.). Noticed?  </span>
<span id="cb320-141"><a href="#cb320-141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb320-142"><a href="#cb320-142" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb320-143"><a href="#cb320-143" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">11</span></span>
<span id="cb320-144"><a href="#cb320-144" aria-hidden="true" tabindex="-1"></a><span class="co">#x and y are of same length</span></span>
<span id="cb320-145"><a href="#cb320-145" aria-hidden="true" tabindex="-1"></a>x <span class="sc">+</span> y</span>
<span id="cb320-146"><a href="#cb320-146" aria-hidden="true" tabindex="-1"></a>y <span class="sc">/</span> x</span>
<span id="cb320-147"><a href="#cb320-147" aria-hidden="true" tabindex="-1"></a><span class="fu">log2</span>(x)</span>
<span id="cb320-148"><a href="#cb320-148" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">log2</span>(x), <span class="dv">1</span>) <span class="co">#log2 of all the values of `x`, 1 digit after decimal to round.</span></span>
<span id="cb320-149"><a href="#cb320-149" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">log2</span>(x), <span class="dv">3</span>) <span class="co">#same logic</span></span>
<span id="cb320-150"><a href="#cb320-150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-151"><a href="#cb320-151" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-152"><a href="#cb320-152" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb320-153"><a href="#cb320-153" aria-hidden="true" tabindex="-1"></a>Nested functions work inside out. Think again about <span class="in">`round(log2(x), 1)`</span> and you will see it. At first, it is making <span class="in">`log2`</span> of vector <span class="in">`x`</span> and then it is rounding the log2 values to one digit after decimal. Got it?</span>
<span id="cb320-154"><a href="#cb320-154" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb320-155"><a href="#cb320-155" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-156"><a href="#cb320-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-157"><a href="#cb320-157" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Frame  </span></span>
<span id="cb320-158"><a href="#cb320-158" aria-hidden="true" tabindex="-1"></a>Now, it's time to use vectors to make data sets.....   </span>
<span id="cb320-161"><a href="#cb320-161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb320-162"><a href="#cb320-162" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Mina"</span>, <span class="st">"Raju"</span>, <span class="st">"Mithu"</span>, <span class="st">"Lali"</span>)</span>
<span id="cb320-163"><a href="#cb320-163" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>, <span class="st">"Female"</span>, <span class="st">"Female"</span>)</span>
<span id="cb320-164"><a href="#cb320-164" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">12</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb320-165"><a href="#cb320-165" aria-hidden="true" tabindex="-1"></a>is_human <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb320-166"><a href="#cb320-166" aria-hidden="true" tabindex="-1"></a>cartoon <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(names, gender, age, is_human)</span>
<span id="cb320-167"><a href="#cb320-167" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(cartoon, <span class="st">"cartoon.csv"</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">col.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb320-168"><a href="#cb320-168" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"cartoon.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>)</span>
<span id="cb320-169"><a href="#cb320-169" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(df) <span class="co">#`dim` means dimension. so, rows * columns</span></span>
<span id="cb320-170"><a href="#cb320-170" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df) <span class="co">#structure of `df`</span></span>
<span id="cb320-171"><a href="#cb320-171" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-172"><a href="#cb320-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-173"><a href="#cb320-173" aria-hidden="true" tabindex="-1"></a>We made the vectors first, and the used them to make the <span class="in">`cartton`</span> data frame or table. We learned how to export the data frame using write.table function. Also, we learned to import or read back the table using <span class="in">`read.table`</span> function. What are the <span class="in">`sep`</span>, <span class="in">`col.names`</span>, <span class="in">`header`</span> arguments there? Why do we need them? Think. Try thinking of different properties of a data set.</span>
<span id="cb320-174"><a href="#cb320-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-175"><a href="#cb320-175" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gene Expression Table  </span></span>
<span id="cb320-176"><a href="#cb320-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-179"><a href="#cb320-179" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb320-180"><a href="#cb320-180" aria-hidden="true" tabindex="-1"></a>gene_expr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb320-181"><a href="#cb320-181" aria-hidden="true" tabindex="-1"></a>  <span class="at">genes =</span> <span class="fu">c</span>(<span class="st">"TP53"</span>, <span class="st">"BRCA1"</span>, <span class="st">"MYC"</span>, <span class="st">"EGFR"</span>, <span class="st">"GAPDH"</span>, <span class="st">"CDC2"</span>),</span>
<span id="cb320-182"><a href="#cb320-182" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample1 =</span> <span class="fu">c</span>(<span class="fl">8.2</span>, <span class="fl">6.1</span>, <span class="fl">9.5</span>, <span class="fl">7.0</span>, <span class="fl">10.0</span>, <span class="dv">12</span>),</span>
<span id="cb320-183"><a href="#cb320-183" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sample2 =</span> <span class="fu">c</span>(<span class="fl">5.9</span>, <span class="fl">3.9</span>, <span class="fl">7.2</span>, <span class="fl">4.8</span>, <span class="fl">7.9</span>, <span class="dv">9</span>),</span>
<span id="cb320-184"><a href="#cb320-184" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sample3 =</span> <span class="fu">c</span>(<span class="fl">8.25</span>, <span class="fl">6.15</span>, <span class="fl">9.6</span>, <span class="fl">7.1</span>, <span class="fl">10.1</span>, <span class="fl">11.9</span>),</span>
<span id="cb320-185"><a href="#cb320-185" aria-hidden="true" tabindex="-1"></a>  <span class="at">pathways =</span> <span class="fu">c</span>(<span class="st">"Apoptosis"</span>, <span class="st">"DNA Repair"</span>, <span class="st">"Cell Cycle"</span>, <span class="st">"Signaling"</span>, <span class="st">"Housekeeping"</span>, <span class="st">"Cell Division"</span>)</span>
<span id="cb320-186"><a href="#cb320-186" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb320-187"><a href="#cb320-187" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(gene_expr, <span class="st">"gene_expr.csv"</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">col.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb320-188"><a href="#cb320-188" aria-hidden="true" tabindex="-1"></a>gene_set <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"gene_expr.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>)</span>
<span id="cb320-189"><a href="#cb320-189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-190"><a href="#cb320-190" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-191"><a href="#cb320-191" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb320-192"><a href="#cb320-192" aria-hidden="true" tabindex="-1"></a>Here, we directly used the vectors as different columns while making the data frame. Did you notice that? Also, the syntax is different here. We can't assign the vectors with the assignment operator (means we can't use <span class="in">`&lt;-`</span> sign. We have to use the <span class="in">`=`</span> sign). Try using the <span class="in">`&lt;-`</span> sign. Did you notice the column names?</span>
<span id="cb320-193"><a href="#cb320-193" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb320-194"><a href="#cb320-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-195"><a href="#cb320-195" aria-hidden="true" tabindex="-1"></a><span class="fu">## Homeworks  </span></span>
<span id="cb320-196"><a href="#cb320-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-197"><a href="#cb320-197" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Compute the difference between this year (2025) and the year you started at the university and divide this by the difference between this year and the year you were born. Multiply this with 100 to get the percentage of your life you have spent at the university.\</span>
<span id="cb320-198"><a href="#cb320-198" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Make different kinds of variables and vectors with the data types we learned together.\</span>
<span id="cb320-199"><a href="#cb320-199" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>What are the properties of a data frame?\</span>
<span id="cb320-200"><a href="#cb320-200" aria-hidden="true" tabindex="-1"></a>    Hint: Open an excel/csv/txt file you have and try to "generalize".\</span>
<span id="cb320-201"><a href="#cb320-201" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Can you make logical questions on the 2 small data sets we used? Try. It will help you understanding the logical operations we tried on variables. Now we are going to apply them on vectors (columns) on the data sets. For example, in the <span class="in">`cartoon`</span> data set, we can ask/try to subset the data set filtering for females only, or for both females and age greater than 2 years.\</span>
<span id="cb320-202"><a href="#cb320-202" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>If you are writing or practicing coding in R, write comment for each line on what it is doing. It will help to chunk it better into your brain.\</span>
<span id="cb320-203"><a href="#cb320-203" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Push the script and/or your answers to the questions (with your solutions) to one of your GitHub repo (and send me the repo link).</span>
<span id="cb320-204"><a href="#cb320-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-205"><a href="#cb320-205" aria-hidden="true" tabindex="-1"></a><span class="fu">### Deadline</span></span>
<span id="cb320-206"><a href="#cb320-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-207"><a href="#cb320-207" aria-hidden="true" tabindex="-1"></a>**Friday, 10pm BD Time.**</span>
<span id="cb320-208"><a href="#cb320-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-209"><a href="#cb320-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-210"><a href="#cb320-210" aria-hidden="true" tabindex="-1"></a><span class="fu"># L3: Data Transformation  </span></span>
<span id="cb320-211"><a href="#cb320-211" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-212"><a href="#cb320-212" aria-hidden="true" tabindex="-1"></a>Firstly, how did you solve the problems?  </span>
<span id="cb320-213"><a href="#cb320-213" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb320-214"><a href="#cb320-214" aria-hidden="true" tabindex="-1"></a>Give me your personal Mindmap. Please, send it in the chat!  </span>
<span id="cb320-215"><a href="#cb320-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-216"><a href="#cb320-216" aria-hidden="true" tabindex="-1"></a><span class="fu">## Getting Started  </span></span>
<span id="cb320-217"><a href="#cb320-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-218"><a href="#cb320-218" aria-hidden="true" tabindex="-1"></a><span class="fu">### Installation of R Markdown</span></span>
<span id="cb320-219"><a href="#cb320-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-220"><a href="#cb320-220" aria-hidden="true" tabindex="-1"></a>We will use <span class="in">`rmarkdown`</span> to have the flexibility of writing codes like the one you are reading now. If you haven't installed the <span class="in">`rmarkdown`</span> package yet, you can do so with:</span>
<span id="cb320-221"><a href="#cb320-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-222"><a href="#cb320-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r install-packages, eval=FALSE}</span></span>
<span id="cb320-223"><a href="#cb320-223" aria-hidden="true" tabindex="-1"></a><span class="co"># Install rmarkdown package</span></span>
<span id="cb320-224"><a href="#cb320-224" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("rmarkdown")</span></span>
<span id="cb320-225"><a href="#cb320-225" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rmarkdown)</span>
<span id="cb320-226"><a href="#cb320-226" aria-hidden="true" tabindex="-1"></a><span class="co"># Other useful packages we might use</span></span>
<span id="cb320-227"><a href="#cb320-227" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("dplyr")    # Data manipulation</span></span>
<span id="cb320-228"><a href="#cb320-228" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb320-229"><a href="#cb320-229" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("readr")    # Reading CSV files</span></span>
<span id="cb320-230"><a href="#cb320-230" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb320-231"><a href="#cb320-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-232"><a href="#cb320-232" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-233"><a href="#cb320-233" aria-hidden="true" tabindex="-1"></a>Remove the hash sign before the <span class="in">`install.packages("rmarkdown")`</span>, <span class="in">`install.packages("dplyr") `</span>, <span class="in">`install.packages("readr")`</span> if the library loading fails. That means the package is not there to be loaded. We need to download/install first.  </span>
<span id="cb320-234"><a href="#cb320-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-235"><a href="#cb320-235" aria-hidden="true" tabindex="-1"></a>:::callout-note  </span>
<span id="cb320-236"><a href="#cb320-236" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Do you remember this book by Hadley Wickham?</span><span class="co">](https://r4ds.had.co.nz)</span>. Try to follow it to get the hold on the basic R syntax and lexicon   </span>
<span id="cb320-237"><a href="#cb320-237" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb320-238"><a href="#cb320-238" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-239"><a href="#cb320-239" aria-hidden="true" tabindex="-1"></a><span class="fu">### Basic Setup for Today's Session  </span></span>
<span id="cb320-240"><a href="#cb320-240" aria-hidden="true" tabindex="-1"></a><span class="in">```{r initial-setup, eval=FALSE}</span></span>
<span id="cb320-241"><a href="#cb320-241" aria-hidden="true" tabindex="-1"></a><span class="co"># Clear environment</span></span>
<span id="cb320-242"><a href="#cb320-242" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb320-243"><a href="#cb320-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-244"><a href="#cb320-244" aria-hidden="true" tabindex="-1"></a><span class="co"># Check working directory</span></span>
<span id="cb320-245"><a href="#cb320-245" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span>
<span id="cb320-246"><a href="#cb320-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-247"><a href="#cb320-247" aria-hidden="true" tabindex="-1"></a><span class="co"># Set working directory if needed</span></span>
<span id="cb320-248"><a href="#cb320-248" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("path/to/your/directory")  # Uncomment and modify as needed</span></span>
<span id="cb320-249"><a href="#cb320-249" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-250"><a href="#cb320-250" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-251"><a href="#cb320-251" aria-hidden="true" tabindex="-1"></a><span class="fu">### Building on Last HW:  </span></span>
<span id="cb320-254"><a href="#cb320-254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb320-255"><a href="#cb320-255" aria-hidden="true" tabindex="-1"></a>cartoon <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb320-256"><a href="#cb320-256" aria-hidden="true" tabindex="-1"></a>  <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Mina"</span>, <span class="st">"Raju"</span>, <span class="st">"Mithu"</span>, <span class="st">"Lali"</span>),</span>
<span id="cb320-257"><a href="#cb320-257" aria-hidden="true" tabindex="-1"></a>  <span class="at">gender =</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>, <span class="st">"Female"</span>, <span class="st">"Female"</span>),</span>
<span id="cb320-258"><a href="#cb320-258" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">12</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb320-259"><a href="#cb320-259" aria-hidden="true" tabindex="-1"></a>  <span class="at">is_human =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb320-260"><a href="#cb320-260" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb320-261"><a href="#cb320-261" aria-hidden="true" tabindex="-1"></a>cartoon</span>
<span id="cb320-262"><a href="#cb320-262" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cartoon)</span>
<span id="cb320-263"><a href="#cb320-263" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(cartoon)</span>
<span id="cb320-264"><a href="#cb320-264" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(cartoon<span class="sc">$</span>names)</span>
<span id="cb320-265"><a href="#cb320-265" aria-hidden="true" tabindex="-1"></a><span class="do">##subseting</span></span>
<span id="cb320-266"><a href="#cb320-266" aria-hidden="true" tabindex="-1"></a>cartoon[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="co">#row 1-2, column 2-3</span></span>
<span id="cb320-267"><a href="#cb320-267" aria-hidden="true" tabindex="-1"></a>cartoon[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)] <span class="co">#row 1-3, column 1-3</span></span>
<span id="cb320-268"><a href="#cb320-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-269"><a href="#cb320-269" aria-hidden="true" tabindex="-1"></a><span class="co">#condition for selecting only male characters</span></span>
<span id="cb320-270"><a href="#cb320-270" aria-hidden="true" tabindex="-1"></a>male_df <span class="ot">&lt;-</span> cartoon[cartoon<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">"Male"</span>, ]</span>
<span id="cb320-271"><a href="#cb320-271" aria-hidden="true" tabindex="-1"></a>male_df</span>
<span id="cb320-272"><a href="#cb320-272" aria-hidden="true" tabindex="-1"></a><span class="co">#condition for selecting female characters with age more than 2 years</span></span>
<span id="cb320-273"><a href="#cb320-273" aria-hidden="true" tabindex="-1"></a>female_age <span class="ot">&lt;-</span> cartoon[cartoon<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">"Female"</span> <span class="sc">&amp;</span> cartoon<span class="sc">$</span>age <span class="sc">&gt;</span> <span class="dv">2</span>, ]</span>
<span id="cb320-274"><a href="#cb320-274" aria-hidden="true" tabindex="-1"></a>female_age</span>
<span id="cb320-275"><a href="#cb320-275" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(female_age<span class="sc">$</span>age) <span class="co">#sum of age of female_age dataset</span></span>
<span id="cb320-276"><a href="#cb320-276" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(cartoon<span class="sc">$</span>age) <span class="co">#standard deviation of age of main cartoon dataset</span></span>
<span id="cb320-277"><a href="#cb320-277" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(cartoon<span class="sc">$</span>age) <span class="co">#mean of age of main cartoon dataset</span></span>
<span id="cb320-278"><a href="#cb320-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-279"><a href="#cb320-279" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-280"><a href="#cb320-280" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Check your colleague's repo for the Q3</span><span class="co">](https://github.com/atiyashehreen/hw_repo3/blob/main/propertiesofdataframe.txt)</span>.  </span>
<span id="cb320-281"><a href="#cb320-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-282"><a href="#cb320-282" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-283"><a href="#cb320-283" aria-hidden="true" tabindex="-1"></a>**Logical Operators**</span>
<span id="cb320-284"><a href="#cb320-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-285"><a href="#cb320-285" aria-hidden="true" tabindex="-1"></a>| Operator | Meaning          | Example       |</span>
<span id="cb320-286"><a href="#cb320-286" aria-hidden="true" tabindex="-1"></a>|----------|------------------|---------------|</span>
<span id="cb320-287"><a href="#cb320-287" aria-hidden="true" tabindex="-1"></a>| <span class="in">`==`</span>     | Equal to         | <span class="in">`x == 5`</span>      |</span>
<span id="cb320-288"><a href="#cb320-288" aria-hidden="true" tabindex="-1"></a>| <span class="in">`!=`</span>     | Not equal        | <span class="in">`x != 5`</span>      |</span>
<span id="cb320-289"><a href="#cb320-289" aria-hidden="true" tabindex="-1"></a>| <span class="in">`&lt;`</span>      | Less than        | <span class="in">`x &lt; 5`</span>       |</span>
<span id="cb320-290"><a href="#cb320-290" aria-hidden="true" tabindex="-1"></a>| <span class="in">`&gt;`</span>      | Greater than     | <span class="in">`x &gt; 5`</span>       |</span>
<span id="cb320-291"><a href="#cb320-291" aria-hidden="true" tabindex="-1"></a>| <span class="in">`&lt;=`</span>     | Less or equal    | <span class="in">`x &lt;= 5`</span>      |</span>
<span id="cb320-292"><a href="#cb320-292" aria-hidden="true" tabindex="-1"></a>| <span class="in">`&gt;=`</span>     | Greater or equal | <span class="in">`x &gt;= 5`</span>      |</span>
<span id="cb320-293"><a href="#cb320-293" aria-hidden="true" tabindex="-1"></a>| <span class="in">`!`</span>      | Not              | <span class="in">`!(x &lt; 5)`</span>    |</span>
<span id="cb320-294"><a href="#cb320-294" aria-hidden="true" tabindex="-1"></a>| <span class="in">`|`</span>      | OR               | <span class="in">`x &lt; 5 | x &gt; 10`</span> |</span>
<span id="cb320-295"><a href="#cb320-295" aria-hidden="true" tabindex="-1"></a>| <span class="in">`&amp;`</span>      | AND              | <span class="in">`x &gt; 5 &amp; x &lt; 10`</span> |</span>
<span id="cb320-296"><a href="#cb320-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-297"><a href="#cb320-297" aria-hidden="true" tabindex="-1"></a><span class="fu">### Preamble on random variables (RV):  </span></span>
<span id="cb320-298"><a href="#cb320-298" aria-hidden="true" tabindex="-1"></a>RV is so fundamental of an idea to interpret and do better in any kind of data analyses. But what is it? Let's imagine this scenario first. You got 30 mice to do an experiment to check anti-diabetic effect of a plant extract. You randomly assigned them into 3 groups. <span class="in">`control`</span>, <span class="in">`treat1`</span> (meaning insulin receivers), and <span class="in">`treat2`</span> (meaning your plant extract receivers). Then you kept testing and measuring. You have mean glucose level of every mouse and show whether the mean value of <span class="in">`treat1`</span> is equal to <span class="in">`treat2`</span> or not. So, are you done? Not really. Be fastidious about the mice. What if you got some other 30 mice? Are they the same? Will their mean glucose level be the same? No, right. We would end up with different mean value. We call this type of quantities RV. Mean, Standard deviation, median, variance, etc. all are RVs. Do you see the logic? That's why we put this constraint and look for p-value, confidence interval (or CI), etc. by (null) hypothesis testing and sample distribution analyses. We will get into these stuffs later. But let's check what I meant. Also ponder about <span class="in">`sample`</span> vs <span class="in">`population`</span>.  </span>
<span id="cb320-299"><a href="#cb320-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-300"><a href="#cb320-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-301"><a href="#cb320-301" aria-hidden="true" tabindex="-1"></a>Let's download the data first.  </span>
<span id="cb320-302"><a href="#cb320-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-303"><a href="#cb320-303" aria-hidden="true" tabindex="-1"></a><span class="in">```{r RV}</span></span>
<span id="cb320-304"><a href="#cb320-304" aria-hidden="true" tabindex="-1"></a><span class="co"># Download small example dataset</span></span>
<span id="cb320-305"><a href="#cb320-305" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">"https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/femaleControlsPopulation.csv"</span>,</span>
<span id="cb320-306"><a href="#cb320-306" aria-hidden="true" tabindex="-1"></a>              <span class="at">destfile =</span> <span class="st">"mice.csv"</span>)</span>
<span id="cb320-307"><a href="#cb320-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-308"><a href="#cb320-308" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb320-309"><a href="#cb320-309" aria-hidden="true" tabindex="-1"></a>mice <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"mice.csv"</span>)</span>
<span id="cb320-310"><a href="#cb320-310" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-311"><a href="#cb320-311" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-312"><a href="#cb320-312" aria-hidden="true" tabindex="-1"></a>Let's check now.  </span>
<span id="cb320-313"><a href="#cb320-313" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rv-check}</span></span>
<span id="cb320-314"><a href="#cb320-314" aria-hidden="true" tabindex="-1"></a>control <span class="ot">&lt;-</span> <span class="fu">sample</span>(mice<span class="sc">$</span>Bodyweight,<span class="dv">12</span>)</span>
<span id="cb320-315"><a href="#cb320-315" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(control)</span>
<span id="cb320-316"><a href="#cb320-316" aria-hidden="true" tabindex="-1"></a>control1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(mice<span class="sc">$</span>Bodyweight,<span class="dv">12</span>)</span>
<span id="cb320-317"><a href="#cb320-317" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(control1)</span>
<span id="cb320-318"><a href="#cb320-318" aria-hidden="true" tabindex="-1"></a>control2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(mice<span class="sc">$</span>Bodyweight,<span class="dv">12</span>)</span>
<span id="cb320-319"><a href="#cb320-319" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(control2)</span>
<span id="cb320-320"><a href="#cb320-320" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-321"><a href="#cb320-321" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-322"><a href="#cb320-322" aria-hidden="true" tabindex="-1"></a>Do you see the difference in the mean value now?  </span>
<span id="cb320-323"><a href="#cb320-323" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-324"><a href="#cb320-324" aria-hidden="true" tabindex="-1"></a><span class="fu">### Basic Stuffs: Atomic Vector  </span></span>
<span id="cb320-325"><a href="#cb320-325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r atomic-vec}</span></span>
<span id="cb320-326"><a href="#cb320-326" aria-hidden="true" tabindex="-1"></a>atomic_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">Human=</span><span class="fl">0.5</span>, <span class="at">Mouse=</span><span class="fl">0.33</span>)</span>
<span id="cb320-327"><a href="#cb320-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-328"><a href="#cb320-328" aria-hidden="true" tabindex="-1"></a>It is fast, but has limited access methods.  </span>
<span id="cb320-329"><a href="#cb320-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-330"><a href="#cb320-330" aria-hidden="true" tabindex="-1"></a>How to access elements here?  </span>
<span id="cb320-333"><a href="#cb320-333" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb320-334"><a href="#cb320-334" aria-hidden="true" tabindex="-1"></a>atomic_vec[<span class="st">"Human"</span>]</span>
<span id="cb320-335"><a href="#cb320-335" aria-hidden="true" tabindex="-1"></a>atomic_vec[<span class="st">"Mouse"</span>]</span>
<span id="cb320-336"><a href="#cb320-336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-337"><a href="#cb320-337" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-338"><a href="#cb320-338" aria-hidden="true" tabindex="-1"></a><span class="fu">### Basic Stuffs: Matrices  </span></span>
<span id="cb320-339"><a href="#cb320-339" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-340"><a href="#cb320-340" aria-hidden="true" tabindex="-1"></a>Matrices are essential for biologists working with expression data, distance matrices, and other numerical data. ONLY NUMERICAL DATA.</span>
<span id="cb320-341"><a href="#cb320-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-342"><a href="#cb320-342" aria-hidden="true" tabindex="-1"></a><span class="in">```{r matrices}</span></span>
<span id="cb320-343"><a href="#cb320-343" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a gene expression matrix: rows=genes, columns=samples</span></span>
<span id="cb320-344"><a href="#cb320-344" aria-hidden="true" tabindex="-1"></a>expr_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb320-345"><a href="#cb320-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">12.3</span>, <span class="fl">8.7</span>, <span class="fl">15.2</span>, <span class="fl">6.8</span>,</span>
<span id="cb320-346"><a href="#cb320-346" aria-hidden="true" tabindex="-1"></a>    <span class="fl">9.5</span>, <span class="fl">11.2</span>, <span class="fl">13.7</span>, <span class="fl">7.4</span>,</span>
<span id="cb320-347"><a href="#cb320-347" aria-hidden="true" tabindex="-1"></a>    <span class="fl">5.6</span>, <span class="fl">6.8</span>, <span class="fl">7.9</span>, <span class="fl">6.5</span>),</span>
<span id="cb320-348"><a href="#cb320-348" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb320-349"><a href="#cb320-349" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb320-350"><a href="#cb320-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-351"><a href="#cb320-351" aria-hidden="true" tabindex="-1"></a><span class="co"># Add dimension names</span></span>
<span id="cb320-352"><a href="#cb320-352" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(expr_matrix) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BRCA1"</span>, <span class="st">"TP53"</span>, <span class="st">"GAPDH"</span>)</span>
<span id="cb320-353"><a href="#cb320-353" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(expr_matrix) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Control_1"</span>, <span class="st">"Control_2"</span>, <span class="st">"Treatment_1"</span>, <span class="st">"Treatment_2"</span>)</span>
<span id="cb320-354"><a href="#cb320-354" aria-hidden="true" tabindex="-1"></a>expr_matrix</span>
<span id="cb320-355"><a href="#cb320-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-356"><a href="#cb320-356" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix dimensions</span></span>
<span id="cb320-357"><a href="#cb320-357" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(expr_matrix)       <span class="co"># Returns rows and columns</span></span>
<span id="cb320-358"><a href="#cb320-358" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(expr_matrix)      <span class="co"># Number of rows</span></span>
<span id="cb320-359"><a href="#cb320-359" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(expr_matrix)      <span class="co"># Number of columns</span></span>
<span id="cb320-360"><a href="#cb320-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-361"><a href="#cb320-361" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix subsetting</span></span>
<span id="cb320-362"><a href="#cb320-362" aria-hidden="true" tabindex="-1"></a>expr_matrix[<span class="dv">2</span>, ]       <span class="co"># One gene, all samples</span></span>
<span id="cb320-363"><a href="#cb320-363" aria-hidden="true" tabindex="-1"></a>expr_matrix[, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]     <span class="co"># All genes, treatment samples only</span></span>
<span id="cb320-364"><a href="#cb320-364" aria-hidden="true" tabindex="-1"></a>expr_matrix[<span class="st">"TP53"</span>, <span class="fu">c</span>(<span class="st">"Control_1"</span>, <span class="st">"Treatment_1"</span>)]  <span class="co"># Specific gene and samples</span></span>
<span id="cb320-365"><a href="#cb320-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-366"><a href="#cb320-366" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix calculations (useful for bioinformatics)</span></span>
<span id="cb320-367"><a href="#cb320-367" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean expression per gene</span></span>
<span id="cb320-368"><a href="#cb320-368" aria-hidden="true" tabindex="-1"></a>gene_means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(expr_matrix)</span>
<span id="cb320-369"><a href="#cb320-369" aria-hidden="true" tabindex="-1"></a>gene_means</span>
<span id="cb320-370"><a href="#cb320-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-371"><a href="#cb320-371" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean expression per sample</span></span>
<span id="cb320-372"><a href="#cb320-372" aria-hidden="true" tabindex="-1"></a>sample_means <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(expr_matrix)</span>
<span id="cb320-373"><a href="#cb320-373" aria-hidden="true" tabindex="-1"></a>sample_means</span>
<span id="cb320-374"><a href="#cb320-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-375"><a href="#cb320-375" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate fold change (Treatment vs Control)</span></span>
<span id="cb320-376"><a href="#cb320-376" aria-hidden="true" tabindex="-1"></a>control_means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(expr_matrix[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb320-377"><a href="#cb320-377" aria-hidden="true" tabindex="-1"></a>treatment_means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(expr_matrix[, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb320-378"><a href="#cb320-378" aria-hidden="true" tabindex="-1"></a>fold_change <span class="ot">&lt;-</span> treatment_means <span class="sc">/</span> control_means</span>
<span id="cb320-379"><a href="#cb320-379" aria-hidden="true" tabindex="-1"></a>fold_change</span>
<span id="cb320-380"><a href="#cb320-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-381"><a href="#cb320-381" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix visualization</span></span>
<span id="cb320-382"><a href="#cb320-382" aria-hidden="true" tabindex="-1"></a><span class="co"># Heatmap of expression data</span></span>
<span id="cb320-383"><a href="#cb320-383" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(expr_matrix, </span>
<span id="cb320-384"><a href="#cb320-384" aria-hidden="true" tabindex="-1"></a>        <span class="at">Colv =</span> <span class="cn">NA</span>,         <span class="co"># Don't cluster columns</span></span>
<span id="cb320-385"><a href="#cb320-385" aria-hidden="true" tabindex="-1"></a>        <span class="at">scale =</span> <span class="st">"row"</span>,     <span class="co"># Scale by row (gene)</span></span>
<span id="cb320-386"><a href="#cb320-386" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">heat.colors</span>(<span class="dv">16</span>),</span>
<span id="cb320-387"><a href="#cb320-387" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Gene Expression Heatmap"</span>)</span>
<span id="cb320-388"><a href="#cb320-388" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-389"><a href="#cb320-389" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-390"><a href="#cb320-390" aria-hidden="true" tabindex="-1"></a><span class="fu">### Basic Stuffs: List  </span></span>
<span id="cb320-391"><a href="#cb320-391" aria-hidden="true" tabindex="-1"></a>Lists are the most flexible data structure in R - they can hold any combination of data types, including other lists! This makes them essential for biological data analysis where we often deal with mixed data types.  </span>
<span id="cb320-392"><a href="#cb320-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-393"><a href="#cb320-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r list}</span></span>
<span id="cb320-394"><a href="#cb320-394" aria-hidden="true" tabindex="-1"></a><span class="co"># A list storing different types of genomic data</span></span>
<span id="cb320-395"><a href="#cb320-395" aria-hidden="true" tabindex="-1"></a>genomics_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb320-396"><a href="#cb320-396" aria-hidden="true" tabindex="-1"></a>  <span class="at">gene_names =</span> <span class="fu">c</span>(<span class="st">"TP53"</span>, <span class="st">"BRCA1"</span>, <span class="st">"MYC"</span>),               <span class="co"># Character vector</span></span>
<span id="cb320-397"><a href="#cb320-397" aria-hidden="true" tabindex="-1"></a>  <span class="at">expression =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">3.4</span>, <span class="fl">5.6</span>, <span class="fl">7.8</span>, <span class="fl">9.1</span>, <span class="fl">2.3</span>), <span class="at">nrow=</span><span class="dv">3</span>),    <span class="co"># Numeric matrix</span></span>
<span id="cb320-398"><a href="#cb320-398" aria-hidden="true" tabindex="-1"></a>  <span class="at">is_cancer_gene =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>),                 <span class="co"># Logical vector</span></span>
<span id="cb320-399"><a href="#cb320-399" aria-hidden="true" tabindex="-1"></a>  <span class="at">metadata =</span> <span class="fu">list</span>(                                       <span class="co"># Nested list!</span></span>
<span id="cb320-400"><a href="#cb320-400" aria-hidden="true" tabindex="-1"></a>    <span class="at">lab =</span> <span class="st">"CRG"</span>,</span>
<span id="cb320-401"><a href="#cb320-401" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="st">"2023-05-01"</span></span>
<span id="cb320-402"><a href="#cb320-402" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb320-403"><a href="#cb320-403" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb320-404"><a href="#cb320-404" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-405"><a href="#cb320-405" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-406"><a href="#cb320-406" aria-hidden="true" tabindex="-1"></a>How to Access Elements of a List?  </span>
<span id="cb320-407"><a href="#cb320-407" aria-hidden="true" tabindex="-1"></a><span class="in">```{r access-list}</span></span>
<span id="cb320-408"><a href="#cb320-408" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 1: Double brackets [[ ]] for single element</span></span>
<span id="cb320-409"><a href="#cb320-409" aria-hidden="true" tabindex="-1"></a>genomics_data[[<span class="dv">1</span>]]  <span class="co"># Returns gene_names vector</span></span>
<span id="cb320-410"><a href="#cb320-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-411"><a href="#cb320-411" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 2: $ operator with names (when elements are named)</span></span>
<span id="cb320-412"><a href="#cb320-412" aria-hidden="true" tabindex="-1"></a>genomics_data<span class="sc">$</span>expression  <span class="co"># Returns the matrix</span></span>
<span id="cb320-413"><a href="#cb320-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-414"><a href="#cb320-414" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 3: Single bracket [ ] returns a sublist</span></span>
<span id="cb320-415"><a href="#cb320-415" aria-hidden="true" tabindex="-1"></a>genomics_data[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]  <span class="co"># Returns list with first two elements</span></span>
<span id="cb320-416"><a href="#cb320-416" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-417"><a href="#cb320-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-418"><a href="#cb320-418" aria-hidden="true" tabindex="-1"></a>Key Difference from Vectors:  </span>
<span id="cb320-419"><a href="#cb320-419" aria-hidden="true" tabindex="-1"></a><span class="in">```{r vecVSlist}</span></span>
<span id="cb320-420"><a href="#cb320-420" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare to your prop.table() example:</span></span>
<span id="cb320-421"><a href="#cb320-421" aria-hidden="true" tabindex="-1"></a>atomic_vec[<span class="st">"Human"</span>]    <span class="co"># Returns named numeric (vector)</span></span>
<span id="cb320-422"><a href="#cb320-422" aria-hidden="true" tabindex="-1"></a>atomic_vec[<span class="st">"Mouse"</span>]</span>
<span id="cb320-423"><a href="#cb320-423" aria-hidden="true" tabindex="-1"></a>genomics_data[<span class="dv">1</span>] <span class="co"># Returns list containing the vector</span></span>
<span id="cb320-424"><a href="#cb320-424" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-425"><a href="#cb320-425" aria-hidden="true" tabindex="-1"></a>Why Biologists Need Lists?  </span>
<span id="cb320-426"><a href="#cb320-426" aria-hidden="true" tabindex="-1"></a><span class="in">`lm()`</span>, <span class="in">`prcomp()`</span> functions, RNAseq analysis packages produces list. So, we need to learn how to handle lists.  </span>
<span id="cb320-427"><a href="#cb320-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-428"><a href="#cb320-428" aria-hidden="true" tabindex="-1"></a>See these examples:  </span>
<span id="cb320-429"><a href="#cb320-429" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-430"><a href="#cb320-430" aria-hidden="true" tabindex="-1"></a>A. Storing BLAST results  </span>
<span id="cb320-431"><a href="#cb320-431" aria-hidden="true" tabindex="-1"></a><span class="in">```{r list-ex1}</span></span>
<span id="cb320-432"><a href="#cb320-432" aria-hidden="true" tabindex="-1"></a>blast_hits <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb320-433"><a href="#cb320-433" aria-hidden="true" tabindex="-1"></a>  <span class="at">query_id =</span> <span class="st">"GeneX"</span>,</span>
<span id="cb320-434"><a href="#cb320-434" aria-hidden="true" tabindex="-1"></a>  <span class="at">hit_ids =</span> <span class="fu">c</span>(<span class="st">"NP_123"</span>, <span class="st">"NP_456"</span>),</span>
<span id="cb320-435"><a href="#cb320-435" aria-hidden="true" tabindex="-1"></a>  <span class="at">e_values =</span> <span class="fu">c</span>(<span class="fl">1e-50</span>, <span class="fl">3e-12</span>),</span>
<span id="cb320-436"><a href="#cb320-436" aria-hidden="true" tabindex="-1"></a>  <span class="at">alignment =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">"ATG..."</span>, <span class="st">"CTA..."</span>), <span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb320-437"><a href="#cb320-437" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-438"><a href="#cb320-438" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-439"><a href="#cb320-439" aria-hidden="true" tabindex="-1"></a>B. Handling Mixed Data  </span>
<span id="cb320-440"><a href="#cb320-440" aria-hidden="true" tabindex="-1"></a><span class="in">```{r list-ex2}</span></span>
<span id="cb320-441"><a href="#cb320-441" aria-hidden="true" tabindex="-1"></a>patient_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb320-442"><a href="#cb320-442" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="st">"P1001"</span>,</span>
<span id="cb320-443"><a href="#cb320-443" aria-hidden="true" tabindex="-1"></a>  <span class="at">tests =</span> <span class="fu">data.frame</span>(</span>
<span id="cb320-444"><a href="#cb320-444" aria-hidden="true" tabindex="-1"></a>    <span class="at">test =</span> <span class="fu">c</span>(<span class="st">"WBC"</span>, <span class="st">"RBC"</span>),</span>
<span id="cb320-445"><a href="#cb320-445" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="fl">5.1</span>)</span>
<span id="cb320-446"><a href="#cb320-446" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb320-447"><a href="#cb320-447" aria-hidden="true" tabindex="-1"></a>  <span class="at">has_mutation =</span> <span class="cn">TRUE</span></span>
<span id="cb320-448"><a href="#cb320-448" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb320-449"><a href="#cb320-449" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-450"><a href="#cb320-450" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-451"><a href="#cb320-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-452"><a href="#cb320-452" aria-hidden="true" tabindex="-1"></a>Common List Operations  </span>
<span id="cb320-453"><a href="#cb320-453" aria-hidden="true" tabindex="-1"></a><span class="in">```{r list-op}</span></span>
<span id="cb320-454"><a href="#cb320-454" aria-hidden="true" tabindex="-1"></a><span class="co"># Add new element</span></span>
<span id="cb320-455"><a href="#cb320-455" aria-hidden="true" tabindex="-1"></a>genomics_data<span class="sc">$</span>sequencer <span class="ot">&lt;-</span> <span class="st">"Illumina"</span></span>
<span id="cb320-456"><a href="#cb320-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-457"><a href="#cb320-457" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove element</span></span>
<span id="cb320-458"><a href="#cb320-458" aria-hidden="true" tabindex="-1"></a>genomics_data<span class="sc">$</span>is_cancer_gene <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb320-459"><a href="#cb320-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-460"><a href="#cb320-460" aria-hidden="true" tabindex="-1"></a><span class="co"># Check structure (critical for complex lists)</span></span>
<span id="cb320-461"><a href="#cb320-461" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(genomics_data)</span>
<span id="cb320-462"><a href="#cb320-462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-463"><a href="#cb320-463" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-464"><a href="#cb320-464" aria-hidden="true" tabindex="-1"></a>By the way, how would you add more patients?  </span>
<span id="cb320-467"><a href="#cb320-467" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb320-468"><a href="#cb320-468" aria-hidden="true" tabindex="-1"></a><span class="co"># Add new patient</span></span>
<span id="cb320-469"><a href="#cb320-469" aria-hidden="true" tabindex="-1"></a>patient_data<span class="sc">$</span>P1002 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb320-470"><a href="#cb320-470" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="st">"P1002"</span>,</span>
<span id="cb320-471"><a href="#cb320-471" aria-hidden="true" tabindex="-1"></a>  <span class="at">tests =</span> <span class="fu">data.frame</span>(</span>
<span id="cb320-472"><a href="#cb320-472" aria-hidden="true" tabindex="-1"></a>    <span class="at">test =</span> <span class="fu">c</span>(<span class="st">"WBC"</span>, <span class="st">"RBC"</span>, <span class="st">"Platelets"</span>),</span>
<span id="cb320-473"><a href="#cb320-473" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">c</span>(<span class="fl">6.2</span>, <span class="fl">4.8</span>, <span class="dv">150</span>)</span>
<span id="cb320-474"><a href="#cb320-474" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb320-475"><a href="#cb320-475" aria-hidden="true" tabindex="-1"></a>  <span class="at">has_mutation =</span> <span class="cn">FALSE</span></span>
<span id="cb320-476"><a href="#cb320-476" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb320-477"><a href="#cb320-477" aria-hidden="true" tabindex="-1"></a><span class="co"># Access specific patient</span></span>
<span id="cb320-478"><a href="#cb320-478" aria-hidden="true" tabindex="-1"></a>patient_data<span class="sc">$</span>P1001<span class="sc">$</span>tests</span>
<span id="cb320-479"><a href="#cb320-479" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-480"><a href="#cb320-480" aria-hidden="true" tabindex="-1"></a>For Batch Processing:  </span>
<span id="cb320-483"><a href="#cb320-483" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb320-484"><a href="#cb320-484" aria-hidden="true" tabindex="-1"></a>patients <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb320-485"><a href="#cb320-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb320-486"><a href="#cb320-486" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="st">"P1001"</span>,</span>
<span id="cb320-487"><a href="#cb320-487" aria-hidden="true" tabindex="-1"></a>    <span class="at">tests =</span> <span class="fu">data.frame</span>(<span class="at">test =</span> <span class="fu">c</span>(<span class="st">"WBC"</span>, <span class="st">"RBC"</span>), <span class="at">value =</span> <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="fl">5.1</span>)),</span>
<span id="cb320-488"><a href="#cb320-488" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_mutation =</span> <span class="cn">TRUE</span></span>
<span id="cb320-489"><a href="#cb320-489" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb320-490"><a href="#cb320-490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb320-491"><a href="#cb320-491" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="st">"P1002"</span>,</span>
<span id="cb320-492"><a href="#cb320-492" aria-hidden="true" tabindex="-1"></a>    <span class="at">tests =</span> <span class="fu">data.frame</span>(<span class="at">test =</span> <span class="fu">c</span>(<span class="st">"WBC"</span>, <span class="st">"RBC"</span>, <span class="st">"Platelets"</span>), <span class="at">value =</span> <span class="fu">c</span>(<span class="fl">6.2</span>, <span class="fl">4.8</span>, <span class="dv">150</span>)),</span>
<span id="cb320-493"><a href="#cb320-493" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_mutation =</span> <span class="cn">FALSE</span></span>
<span id="cb320-494"><a href="#cb320-494" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb320-495"><a href="#cb320-495" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb320-496"><a href="#cb320-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-497"><a href="#cb320-497" aria-hidden="true" tabindex="-1"></a><span class="co"># Access 2nd patient's WBC value</span></span>
<span id="cb320-498"><a href="#cb320-498" aria-hidden="true" tabindex="-1"></a>patients[[<span class="dv">2</span>]]<span class="sc">$</span>tests<span class="sc">$</span>value[patients[[<span class="dv">2</span>]]<span class="sc">$</span>tests<span class="sc">$</span>test <span class="sc">==</span> <span class="st">"WBC"</span>]</span>
<span id="cb320-499"><a href="#cb320-499" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-500"><a href="#cb320-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-501"><a href="#cb320-501" aria-hidden="true" tabindex="-1"></a>Converting Between Structures  </span>
<span id="cb320-504"><a href="#cb320-504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb320-505"><a href="#cb320-505" aria-hidden="true" tabindex="-1"></a><span class="co"># List → Vector</span></span>
<span id="cb320-506"><a href="#cb320-506" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(genomics_data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb320-507"><a href="#cb320-507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-508"><a href="#cb320-508" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-509"><a href="#cb320-509" aria-hidden="true" tabindex="-1"></a>Visualization  </span>
<span id="cb320-510"><a href="#cb320-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-511"><a href="#cb320-511" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb320-512"><a href="#cb320-512" aria-hidden="true" tabindex="-1"></a><span class="co"># Base R plot from list data</span></span>
<span id="cb320-513"><a href="#cb320-513" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">unlist</span>(genomics_data[<span class="dv">2</span>]),</span>
<span id="cb320-514"><a href="#cb320-514" aria-hidden="true" tabindex="-1"></a>        <span class="at">names.arg =</span> genomics_data[[<span class="dv">1</span>]])</span>
<span id="cb320-515"><a href="#cb320-515" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-516"><a href="#cb320-516" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-517"><a href="#cb320-517" aria-hidden="true" tabindex="-1"></a>This code won't work if you run. <span class="in">`unlist(genomics_data[2]`</span> creates a vector of length 6 from our 3*2 matrix but <span class="in">`genomics_data[[1]]`</span> has 3 things inside the <span class="in">`gene_names`</span> vector. Debug like this:  </span>
<span id="cb320-520"><a href="#cb320-520" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb320-521"><a href="#cb320-521" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(genomics_data<span class="sc">$</span>expression)  <span class="co"># e.g., 2 rows x 2 cols</span></span>
<span id="cb320-522"><a href="#cb320-522" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(genomics_data<span class="sc">$</span>gene_names) <span class="co"># e.g., 3 genes</span></span>
<span id="cb320-523"><a href="#cb320-523" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-524"><a href="#cb320-524" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-525"><a href="#cb320-525" aria-hidden="true" tabindex="-1"></a>A. Gene-Centric (Mean Expression)  </span>
<span id="cb320-526"><a href="#cb320-526" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-529"><a href="#cb320-529" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb320-530"><a href="#cb320-530" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">rowMeans</span>(genomics_data<span class="sc">$</span>expression),</span>
<span id="cb320-531"><a href="#cb320-531" aria-hidden="true" tabindex="-1"></a>        <span class="at">names.arg =</span> genomics_data<span class="sc">$</span>gene_names,</span>
<span id="cb320-532"><a href="#cb320-532" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb320-533"><a href="#cb320-533" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Mean Expression"</span>,</span>
<span id="cb320-534"><a href="#cb320-534" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Average Gene Expression"</span>)</span>
<span id="cb320-535"><a href="#cb320-535" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-536"><a href="#cb320-536" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-537"><a href="#cb320-537" aria-hidden="true" tabindex="-1"></a>B. Sample-Centric (All Measurements) </span>
<span id="cb320-540"><a href="#cb320-540" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb320-541"><a href="#cb320-541" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(genomics_data<span class="sc">$</span>expression,</span>
<span id="cb320-542"><a href="#cb320-542" aria-hidden="true" tabindex="-1"></a>        <span class="at">beside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb320-543"><a href="#cb320-543" aria-hidden="true" tabindex="-1"></a>        <span class="at">names.arg =</span> <span class="fu">paste0</span>(<span class="st">"Sample_"</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(genomics_data<span class="sc">$</span>expression)),</span>
<span id="cb320-544"><a href="#cb320-544" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> genomics_data<span class="sc">$</span>gene_names,</span>
<span id="cb320-545"><a href="#cb320-545" aria-hidden="true" tabindex="-1"></a>        <span class="at">args.legend =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="st">"topright"</span>, <span class="at">bty =</span> <span class="st">"n"</span>),</span>
<span id="cb320-546"><a href="#cb320-546" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"green"</span>),</span>
<span id="cb320-547"><a href="#cb320-547" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Expression Across Samples"</span>)</span>
<span id="cb320-548"><a href="#cb320-548" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-549"><a href="#cb320-549" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-550"><a href="#cb320-550" aria-hidden="true" tabindex="-1"></a>:::callout-note</span>
<span id="cb320-551"><a href="#cb320-551" aria-hidden="true" tabindex="-1"></a>This matches real-world scenarios:</span>
<span id="cb320-552"><a href="#cb320-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-553"><a href="#cb320-553" aria-hidden="true" tabindex="-1"></a>RNA-seq: Rows=genes, cols=samples</span>
<span id="cb320-554"><a href="#cb320-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-555"><a href="#cb320-555" aria-hidden="true" tabindex="-1"></a>rowMeans() = average expression per gene</span>
<span id="cb320-556"><a href="#cb320-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-557"><a href="#cb320-557" aria-hidden="true" tabindex="-1"></a>beside=TRUE =&gt; compare samples within genes</span>
<span id="cb320-558"><a href="#cb320-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-559"><a href="#cb320-559" aria-hidden="true" tabindex="-1"></a>Proteomics: Rows=proteins, cols=replicates</span>
<span id="cb320-560"><a href="#cb320-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-561"><a href="#cb320-561" aria-hidden="true" tabindex="-1"></a>Same principles apply  </span>
<span id="cb320-562"><a href="#cb320-562" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb320-563"><a href="#cb320-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-566"><a href="#cb320-566" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb320-567"><a href="#cb320-567" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate stats</span></span>
<span id="cb320-568"><a href="#cb320-568" aria-hidden="true" tabindex="-1"></a>gene_means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(genomics_data<span class="sc">$</span>expression)</span>
<span id="cb320-569"><a href="#cb320-569" aria-hidden="true" tabindex="-1"></a>gene_sds <span class="ot">&lt;-</span> <span class="fu">apply</span>(genomics_data<span class="sc">$</span>expression, <span class="dv">1</span>, sd)</span>
<span id="cb320-570"><a href="#cb320-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-571"><a href="#cb320-571" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with error bars</span></span>
<span id="cb320-572"><a href="#cb320-572" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="fu">barplot</span>(gene_means, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(gene_means <span class="sc">+</span> gene_sds)))</span>
<span id="cb320-573"><a href="#cb320-573" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(bp, gene_means <span class="sc">-</span> gene_sds, bp, gene_means <span class="sc">+</span> gene_sds, </span>
<span id="cb320-574"><a href="#cb320-574" aria-hidden="true" tabindex="-1"></a>       <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">code =</span> <span class="dv">3</span>)</span>
<span id="cb320-575"><a href="#cb320-575" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-576"><a href="#cb320-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-577"><a href="#cb320-577" aria-hidden="true" tabindex="-1"></a>**Task: Create a list containing:**  </span>
<span id="cb320-578"><a href="#cb320-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-579"><a href="#cb320-579" aria-hidden="true" tabindex="-1"></a>i) A character vector of 3 gene names</span>
<span id="cb320-580"><a href="#cb320-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-581"><a href="#cb320-581" aria-hidden="true" tabindex="-1"></a>ii) A numeric matrix of expression values</span>
<span id="cb320-582"><a href="#cb320-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-583"><a href="#cb320-583" aria-hidden="true" tabindex="-1"></a>iii) A logical vector indicating pathway membership</span>
<span id="cb320-584"><a href="#cb320-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-585"><a href="#cb320-585" aria-hidden="true" tabindex="-1"></a>iv) A nested list with lab metadata</span>
<span id="cb320-586"><a href="#cb320-586" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-587"><a href="#cb320-587" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-588"><a href="#cb320-588" aria-hidden="true" tabindex="-1"></a><span class="fu">## Factor Variables  </span></span>
<span id="cb320-589"><a href="#cb320-589" aria-hidden="true" tabindex="-1"></a>Important for categorical data  </span>
<span id="cb320-590"><a href="#cb320-590" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-591"><a href="#cb320-591" aria-hidden="true" tabindex="-1"></a><span class="fu">### Creating Factors  </span></span>
<span id="cb320-592"><a href="#cb320-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-593"><a href="#cb320-593" aria-hidden="true" tabindex="-1"></a>Factors are used to represent categorical data in R. They are particularly important for biological data like genotypes, phenotypes, and experimental conditions.  </span>
<span id="cb320-594"><a href="#cb320-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-595"><a href="#cb320-595" aria-hidden="true" tabindex="-1"></a><span class="in">```{r creating-factors}</span></span>
<span id="cb320-596"><a href="#cb320-596" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple factor: DNA sample origins</span></span>
<span id="cb320-597"><a href="#cb320-597" aria-hidden="true" tabindex="-1"></a>origins <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Human"</span>, <span class="st">"Mouse"</span>, <span class="st">"Human"</span>, <span class="st">"Zebrafish"</span>, <span class="st">"Mouse"</span>, <span class="st">"Human"</span>)</span>
<span id="cb320-598"><a href="#cb320-598" aria-hidden="true" tabindex="-1"></a>origins_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(origins)</span>
<span id="cb320-599"><a href="#cb320-599" aria-hidden="true" tabindex="-1"></a>origins_factor</span>
<span id="cb320-600"><a href="#cb320-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-601"><a href="#cb320-601" aria-hidden="true" tabindex="-1"></a><span class="co"># Check levels (categories)</span></span>
<span id="cb320-602"><a href="#cb320-602" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(origins_factor)</span>
<span id="cb320-603"><a href="#cb320-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-604"><a href="#cb320-604" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a factor with predefined levels</span></span>
<span id="cb320-605"><a href="#cb320-605" aria-hidden="true" tabindex="-1"></a>treatment_groups <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Low_dose"</span>, <span class="st">"High_dose"</span>, <span class="st">"Control"</span>, <span class="st">"Low_dose"</span>),</span>
<span id="cb320-606"><a href="#cb320-606" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Low_dose"</span>, <span class="st">"High_dose"</span>))</span>
<span id="cb320-607"><a href="#cb320-607" aria-hidden="true" tabindex="-1"></a>treatment_groups</span>
<span id="cb320-608"><a href="#cb320-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-609"><a href="#cb320-609" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordered factors (important for severity, stages, etc.)</span></span>
<span id="cb320-610"><a href="#cb320-610" aria-hidden="true" tabindex="-1"></a>disease_severity <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"Mild"</span>, <span class="st">"Severe"</span>, <span class="st">"Moderate"</span>, <span class="st">"Mild"</span>, <span class="st">"Critical"</span>),</span>
<span id="cb320-611"><a href="#cb320-611" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Mild"</span>, <span class="st">"Moderate"</span>, <span class="st">"Severe"</span>, <span class="st">"Critical"</span>),</span>
<span id="cb320-612"><a href="#cb320-612" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb320-613"><a href="#cb320-613" aria-hidden="true" tabindex="-1"></a>disease_severity</span>
<span id="cb320-614"><a href="#cb320-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-615"><a href="#cb320-615" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare with ordered factors</span></span>
<span id="cb320-616"><a href="#cb320-616" aria-hidden="true" tabindex="-1"></a>disease_severity[<span class="dv">1</span>] <span class="sc">&lt;</span> disease_severity[<span class="dv">2</span>]  <span class="co"># Is Mild less severe than Severe?</span></span>
<span id="cb320-617"><a href="#cb320-617" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-618"><a href="#cb320-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-619"><a href="#cb320-619" aria-hidden="true" tabindex="-1"></a><span class="fu">### Factor Operations  </span></span>
<span id="cb320-620"><a href="#cb320-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-621"><a href="#cb320-621" aria-hidden="true" tabindex="-1"></a><span class="in">```{r factor-operations}</span></span>
<span id="cb320-622"><a href="#cb320-622" aria-hidden="true" tabindex="-1"></a><span class="co"># Count frequencies</span></span>
<span id="cb320-623"><a href="#cb320-623" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(origins_factor)</span>
<span id="cb320-624"><a href="#cb320-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-625"><a href="#cb320-625" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate proportions</span></span>
<span id="cb320-626"><a href="#cb320-626" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(origins_factor))</span>
<span id="cb320-627"><a href="#cb320-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-628"><a href="#cb320-628" aria-hidden="true" tabindex="-1"></a><span class="co"># Change reference level (important for statistical models)</span></span>
<span id="cb320-629"><a href="#cb320-629" aria-hidden="true" tabindex="-1"></a>origins_factor_relevel <span class="ot">&lt;-</span> <span class="fu">relevel</span>(origins_factor, <span class="at">ref =</span> <span class="st">"Mouse"</span>)</span>
<span id="cb320-630"><a href="#cb320-630" aria-hidden="true" tabindex="-1"></a>origins_factor_relevel</span>
<span id="cb320-631"><a href="#cb320-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-632"><a href="#cb320-632" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to character</span></span>
<span id="cb320-633"><a href="#cb320-633" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(origins_factor)</span>
<span id="cb320-634"><a href="#cb320-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-635"><a href="#cb320-635" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot factors - Basic barplot</span></span>
<span id="cb320-636"><a href="#cb320-636" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(origins_factor), </span>
<span id="cb320-637"><a href="#cb320-637" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"red"</span>),</span>
<span id="cb320-638"><a href="#cb320-638" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Sample Origins"</span>,</span>
<span id="cb320-639"><a href="#cb320-639" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Count"</span>)</span>
<span id="cb320-640"><a href="#cb320-640" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-641"><a href="#cb320-641" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-642"><a href="#cb320-642" aria-hidden="true" tabindex="-1"></a>More advanced plot with factors:  </span>
<span id="cb320-643"><a href="#cb320-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-646"><a href="#cb320-646" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb320-647"><a href="#cb320-647" aria-hidden="true" tabindex="-1"></a>gene_expr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">5.2</span>, <span class="fl">7.8</span>, <span class="fl">4.5</span>, <span class="fl">12.3</span>, <span class="fl">8.1</span>, <span class="fl">3.7</span>)</span>
<span id="cb320-648"><a href="#cb320-648" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(gene_expr) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(origins)</span>
<span id="cb320-649"><a href="#cb320-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-650"><a href="#cb320-650" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot by factor</span></span>
<span id="cb320-651"><a href="#cb320-651" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(gene_expr <span class="sc">~</span> origins, </span>
<span id="cb320-652"><a href="#cb320-652" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb320-653"><a href="#cb320-653" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Gene Expression by Sample Origin"</span>, </span>
<span id="cb320-654"><a href="#cb320-654" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Origin"</span>, </span>
<span id="cb320-655"><a href="#cb320-655" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Expression Level"</span>)</span>
<span id="cb320-656"><a href="#cb320-656" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-657"><a href="#cb320-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-658"><a href="#cb320-658" aria-hidden="true" tabindex="-1"></a>:::callout-note</span>
<span id="cb320-659"><a href="#cb320-659" aria-hidden="true" tabindex="-1"></a>Keep noticing the output formats. Sometimes the output is just a number, sometimes a vector or table or list, etc. Check <span class="in">`prop.table(table(origins_factor))`</span>. How is it?</span>
<span id="cb320-660"><a href="#cb320-660" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb320-661"><a href="#cb320-661" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-662"><a href="#cb320-662" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb320-663"><a href="#cb320-663" aria-hidden="true" tabindex="-1"></a><span class="fu">## Got it?</span></span>
<span id="cb320-664"><a href="#cb320-664" aria-hidden="true" tabindex="-1"></a><span class="in">`prop &lt;- prop.table(table(origins_factor))`</span> -- is a named numeric vector (atomic vector). <span class="in">`prop$Human`</span> or similar won't work. Check this way:  </span>
<span id="cb320-665"><a href="#cb320-665" aria-hidden="true" tabindex="-1"></a><span class="in">`prop`</span>  </span>
<span id="cb320-666"><a href="#cb320-666" aria-hidden="true" tabindex="-1"></a><span class="in">`prop["Human"]; prop["Mouse"]; prop["Zebrafish"]`</span>  </span>
<span id="cb320-667"><a href="#cb320-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-668"><a href="#cb320-668" aria-hidden="true" tabindex="-1"></a>Or make it a data frame (df) first, then try to use normal way of handling df.</span>
<span id="cb320-669"><a href="#cb320-669" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb320-670"><a href="#cb320-670" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-671"><a href="#cb320-671" aria-hidden="true" tabindex="-1"></a>Accessing the Output:  </span>
<span id="cb320-674"><a href="#cb320-674" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb320-675"><a href="#cb320-675" aria-hidden="true" tabindex="-1"></a>prop <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(<span class="fu">table</span>(origins_factor))</span>
<span id="cb320-676"><a href="#cb320-676" aria-hidden="true" tabindex="-1"></a>prop <span class="co">#What do you see? A data frame? No difference?</span></span>
<span id="cb320-677"><a href="#cb320-677" aria-hidden="true" tabindex="-1"></a>prop[<span class="st">"Human"</span>]; prop[<span class="st">"Mouse"</span>]; prop[<span class="st">"Zebrafish"</span>]</span>
<span id="cb320-678"><a href="#cb320-678" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-679"><a href="#cb320-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-680"><a href="#cb320-680" aria-hidden="true" tabindex="-1"></a><span class="fu">## Subsetting Data  </span></span>
<span id="cb320-681"><a href="#cb320-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-682"><a href="#cb320-682" aria-hidden="true" tabindex="-1"></a><span class="fu">### Vectors  </span></span>
<span id="cb320-683"><a href="#cb320-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-684"><a href="#cb320-684" aria-hidden="true" tabindex="-1"></a><span class="in">```{r subsetting-vectors}</span></span>
<span id="cb320-685"><a href="#cb320-685" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a vector</span></span>
<span id="cb320-686"><a href="#cb320-686" aria-hidden="true" tabindex="-1"></a>expression_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">3.2</span>, <span class="fl">4.5</span>, <span class="fl">2.1</span>, <span class="fl">6.7</span>, <span class="fl">5.9</span>, <span class="fl">3.3</span>, <span class="fl">7.8</span>, <span class="fl">2.9</span>)</span>
<span id="cb320-687"><a href="#cb320-687" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(expression_data) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Sample_"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)</span>
<span id="cb320-688"><a href="#cb320-688" aria-hidden="true" tabindex="-1"></a>expression_data</span>
<span id="cb320-689"><a href="#cb320-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-690"><a href="#cb320-690" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset by position</span></span>
<span id="cb320-691"><a href="#cb320-691" aria-hidden="true" tabindex="-1"></a>expression_data[<span class="dv">3</span>]             <span class="co"># Single element</span></span>
<span id="cb320-692"><a href="#cb320-692" aria-hidden="true" tabindex="-1"></a>expression_data[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>)]    <span class="co"># Multiple elements</span></span>
<span id="cb320-693"><a href="#cb320-693" aria-hidden="true" tabindex="-1"></a>expression_data[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]           <span class="co"># Range</span></span>
<span id="cb320-694"><a href="#cb320-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-695"><a href="#cb320-695" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset by name</span></span>
<span id="cb320-696"><a href="#cb320-696" aria-hidden="true" tabindex="-1"></a>expression_data[<span class="st">"Sample_6"</span>]</span>
<span id="cb320-697"><a href="#cb320-697" aria-hidden="true" tabindex="-1"></a>expression_data[<span class="fu">c</span>(<span class="st">"Sample_1"</span>, <span class="st">"Sample_8"</span>)]</span>
<span id="cb320-698"><a href="#cb320-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-699"><a href="#cb320-699" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset by condition</span></span>
<span id="cb320-700"><a href="#cb320-700" aria-hidden="true" tabindex="-1"></a>expression_data[expression_data <span class="sc">&gt;</span> <span class="dv">5</span>]              <span class="co"># Values &gt; 5</span></span>
<span id="cb320-701"><a href="#cb320-701" aria-hidden="true" tabindex="-1"></a>expression_data[expression_data <span class="sc">&gt;=</span> <span class="dv">3</span> <span class="sc">&amp;</span> expression_data <span class="sc">&lt;=</span> <span class="dv">6</span>]  <span class="co"># Values between 3 and 6</span></span>
<span id="cb320-702"><a href="#cb320-702" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-703"><a href="#cb320-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-704"><a href="#cb320-704" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Frames</span></span>
<span id="cb320-705"><a href="#cb320-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-706"><a href="#cb320-706" aria-hidden="true" tabindex="-1"></a><span class="in">```{r subsetting-dataframes}</span></span>
<span id="cb320-707"><a href="#cb320-707" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame</span></span>
<span id="cb320-708"><a href="#cb320-708" aria-hidden="true" tabindex="-1"></a>gene_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb320-709"><a href="#cb320-709" aria-hidden="true" tabindex="-1"></a>  <span class="at">gene_id =</span> <span class="fu">c</span>(<span class="st">"BRCA1"</span>, <span class="st">"TP53"</span>, <span class="st">"MYC"</span>, <span class="st">"EGFR"</span>, <span class="st">"GAPDH"</span>),</span>
<span id="cb320-710"><a href="#cb320-710" aria-hidden="true" tabindex="-1"></a>  <span class="at">expression =</span> <span class="fu">c</span>(<span class="fl">8.2</span>, <span class="fl">6.1</span>, <span class="fl">9.5</span>, <span class="fl">7.0</span>, <span class="fl">10.0</span>),</span>
<span id="cb320-711"><a href="#cb320-711" aria-hidden="true" tabindex="-1"></a>  <span class="at">mutation =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>, <span class="st">"No"</span>)),</span>
<span id="cb320-712"><a href="#cb320-712" aria-hidden="true" tabindex="-1"></a>  <span class="at">pathway =</span> <span class="fu">c</span>(<span class="st">"DNA Repair"</span>, <span class="st">"Apoptosis"</span>, <span class="st">"Cell Cycle"</span>, <span class="st">"Signaling"</span>, <span class="st">"Metabolism"</span>)</span>
<span id="cb320-713"><a href="#cb320-713" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb320-714"><a href="#cb320-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-715"><a href="#cb320-715" aria-hidden="true" tabindex="-1"></a>gene_df</span>
<span id="cb320-716"><a href="#cb320-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-717"><a href="#cb320-717" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting by row index</span></span>
<span id="cb320-718"><a href="#cb320-718" aria-hidden="true" tabindex="-1"></a>gene_df[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, ]         <span class="co"># First three rows, all columns</span></span>
<span id="cb320-719"><a href="#cb320-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-720"><a href="#cb320-720" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting by column index</span></span>
<span id="cb320-721"><a href="#cb320-721" aria-hidden="true" tabindex="-1"></a>gene_df[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)]     <span class="co"># All rows, first two columns</span></span>
<span id="cb320-722"><a href="#cb320-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-723"><a href="#cb320-723" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting by column name</span></span>
<span id="cb320-724"><a href="#cb320-724" aria-hidden="true" tabindex="-1"></a>gene_df[, <span class="fu">c</span>(<span class="st">"gene_id"</span>, <span class="st">"mutation"</span>)]</span>
<span id="cb320-725"><a href="#cb320-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-726"><a href="#cb320-726" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the $ operator</span></span>
<span id="cb320-727"><a href="#cb320-727" aria-hidden="true" tabindex="-1"></a>gene_df<span class="sc">$</span>expression</span>
<span id="cb320-728"><a href="#cb320-728" aria-hidden="true" tabindex="-1"></a>gene_df<span class="sc">$</span>mutation</span>
<span id="cb320-729"><a href="#cb320-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-730"><a href="#cb320-730" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting by condition</span></span>
<span id="cb320-731"><a href="#cb320-731" aria-hidden="true" tabindex="-1"></a>gene_df[gene_df<span class="sc">$</span>expression <span class="sc">&gt;</span> <span class="dv">8</span>, ]</span>
<span id="cb320-732"><a href="#cb320-732" aria-hidden="true" tabindex="-1"></a>gene_df[gene_df<span class="sc">$</span>mutation <span class="sc">==</span> <span class="st">"Yes"</span>, ]</span>
<span id="cb320-733"><a href="#cb320-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-734"><a href="#cb320-734" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple conditions</span></span>
<span id="cb320-735"><a href="#cb320-735" aria-hidden="true" tabindex="-1"></a>gene_df[gene_df<span class="sc">$</span>expression <span class="sc">&gt;</span> <span class="dv">7</span> <span class="sc">&amp;</span> gene_df<span class="sc">$</span>mutation <span class="sc">==</span> <span class="st">"No"</span>, ]</span>
<span id="cb320-736"><a href="#cb320-736" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-737"><a href="#cb320-737" aria-hidden="true" tabindex="-1"></a>**Logical Operators**</span>
<span id="cb320-738"><a href="#cb320-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-739"><a href="#cb320-739" aria-hidden="true" tabindex="-1"></a>| Operator | Meaning          | Example       |</span>
<span id="cb320-740"><a href="#cb320-740" aria-hidden="true" tabindex="-1"></a>|----------|------------------|---------------|</span>
<span id="cb320-741"><a href="#cb320-741" aria-hidden="true" tabindex="-1"></a>| <span class="in">`==`</span>     | Equal to         | <span class="in">`x == 5`</span>      |</span>
<span id="cb320-742"><a href="#cb320-742" aria-hidden="true" tabindex="-1"></a>| <span class="in">`!=`</span>     | Not equal        | <span class="in">`x != 5`</span>      |</span>
<span id="cb320-743"><a href="#cb320-743" aria-hidden="true" tabindex="-1"></a>| <span class="in">`&lt;`</span>      | Less than        | <span class="in">`x &lt; 5`</span>       |</span>
<span id="cb320-744"><a href="#cb320-744" aria-hidden="true" tabindex="-1"></a>| <span class="in">`&gt;`</span>      | Greater than     | <span class="in">`x &gt; 5`</span>       |</span>
<span id="cb320-745"><a href="#cb320-745" aria-hidden="true" tabindex="-1"></a>| <span class="in">`&lt;=`</span>     | Less or equal    | <span class="in">`x &lt;= 5`</span>      |</span>
<span id="cb320-746"><a href="#cb320-746" aria-hidden="true" tabindex="-1"></a>| <span class="in">`&gt;=`</span>     | Greater or equal | <span class="in">`x &gt;= 5`</span>      |</span>
<span id="cb320-747"><a href="#cb320-747" aria-hidden="true" tabindex="-1"></a>| <span class="in">`!`</span>      | Not              | <span class="in">`!(x &lt; 5)`</span>    |</span>
<span id="cb320-748"><a href="#cb320-748" aria-hidden="true" tabindex="-1"></a>| <span class="in">`|`</span>      | OR               | <span class="in">`x &lt; 5 | x &gt; 10`</span> |</span>
<span id="cb320-749"><a href="#cb320-749" aria-hidden="true" tabindex="-1"></a>| <span class="in">`&amp;`</span>      | AND              | <span class="in">`x &gt; 5 &amp; x &lt; 10`</span> |</span>
<span id="cb320-750"><a href="#cb320-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-751"><a href="#cb320-751" aria-hidden="true" tabindex="-1"></a><span class="fu">### Row Names in Data Frames  </span></span>
<span id="cb320-752"><a href="#cb320-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-753"><a href="#cb320-753" aria-hidden="true" tabindex="-1"></a>Row names are particularly important in bioinformatics where genes, proteins, or samples are often used as identifiers.  </span>
<span id="cb320-754"><a href="#cb320-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-755"><a href="#cb320-755" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rownames}</span></span>
<span id="cb320-756"><a href="#cb320-756" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting row names for gene_df</span></span>
<span id="cb320-757"><a href="#cb320-757" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(gene_df) <span class="ot">&lt;-</span> gene_df<span class="sc">$</span>gene_id</span>
<span id="cb320-758"><a href="#cb320-758" aria-hidden="true" tabindex="-1"></a>gene_df</span>
<span id="cb320-759"><a href="#cb320-759" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-760"><a href="#cb320-760" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb320-761"><a href="#cb320-761" aria-hidden="true" tabindex="-1"></a>We can now drop the gene_id column, if required.  </span>
<span id="cb320-764"><a href="#cb320-764" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb320-765"><a href="#cb320-765" aria-hidden="true" tabindex="-1"></a>gene_df_clean <span class="ot">&lt;-</span> gene_df[, <span class="sc">-</span><span class="dv">1</span>]  <span class="co"># Remove the first column</span></span>
<span id="cb320-766"><a href="#cb320-766" aria-hidden="true" tabindex="-1"></a>gene_df_clean</span>
<span id="cb320-767"><a href="#cb320-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-768"><a href="#cb320-768" aria-hidden="true" tabindex="-1"></a><span class="co"># Access rows by name</span></span>
<span id="cb320-769"><a href="#cb320-769" aria-hidden="true" tabindex="-1"></a>gene_df_clean[<span class="st">"TP53"</span>, ]</span>
<span id="cb320-770"><a href="#cb320-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-771"><a href="#cb320-771" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if row names are unique</span></span>
<span id="cb320-772"><a href="#cb320-772" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(<span class="fu">rownames</span>(gene_df_clean)))</span>
<span id="cb320-773"><a href="#cb320-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-774"><a href="#cb320-774" aria-hidden="true" tabindex="-1"></a><span class="co"># Handle potential duplicated row names</span></span>
<span id="cb320-775"><a href="#cb320-775" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: R doesn't allow duplicate row names by default</span></span>
<span id="cb320-776"><a href="#cb320-776" aria-hidden="true" tabindex="-1"></a>dup_genes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb320-777"><a href="#cb320-777" aria-hidden="true" tabindex="-1"></a>  <span class="at">expression =</span> <span class="fu">c</span>(<span class="fl">5.2</span>, <span class="fl">6.3</span>, <span class="fl">5.2</span>, <span class="fl">8.1</span>),</span>
<span id="cb320-778"><a href="#cb320-778" aria-hidden="true" tabindex="-1"></a>  <span class="at">mutation =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb320-779"><a href="#cb320-779" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb320-780"><a href="#cb320-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-781"><a href="#cb320-781" aria-hidden="true" tabindex="-1"></a><span class="co"># This would cause an error:</span></span>
<span id="cb320-782"><a href="#cb320-782" aria-hidden="true" tabindex="-1"></a><span class="co"># rownames(dup_genes) &lt;- c("BRCA1", "BRCA1", "TP53", "EGFR")</span></span>
<span id="cb320-783"><a href="#cb320-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-784"><a href="#cb320-784" aria-hidden="true" tabindex="-1"></a><span class="co"># Instead, we can preemptively make them unique:</span></span>
<span id="cb320-785"><a href="#cb320-785" aria-hidden="true" tabindex="-1"></a>proposed_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BRCA1"</span>, <span class="st">"BRCA1"</span>, <span class="st">"TP53"</span>, <span class="st">"EGFR"</span>)</span>
<span id="cb320-786"><a href="#cb320-786" aria-hidden="true" tabindex="-1"></a>unique_names <span class="ot">&lt;-</span> <span class="fu">make.unique</span>(proposed_names)</span>
<span id="cb320-787"><a href="#cb320-787" aria-hidden="true" tabindex="-1"></a>unique_names  <span class="co"># Show the generated unique names</span></span>
<span id="cb320-788"><a href="#cb320-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-789"><a href="#cb320-789" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we can safely assign them</span></span>
<span id="cb320-790"><a href="#cb320-790" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(dup_genes) <span class="ot">&lt;-</span> unique_names</span>
<span id="cb320-791"><a href="#cb320-791" aria-hidden="true" tabindex="-1"></a>dup_genes</span>
<span id="cb320-792"><a href="#cb320-792" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-793"><a href="#cb320-793" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-794"><a href="#cb320-794" aria-hidden="true" tabindex="-1"></a><span class="fu">## Handling Missing/Wrong Values   </span></span>
<span id="cb320-795"><a href="#cb320-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-796"><a href="#cb320-796" aria-hidden="true" tabindex="-1"></a><span class="fu">### Identifying Issues  </span></span>
<span id="cb320-797"><a href="#cb320-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-798"><a href="#cb320-798" aria-hidden="true" tabindex="-1"></a><span class="in">```{r missing-values}</span></span>
<span id="cb320-799"><a href="#cb320-799" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data with missing values</span></span>
<span id="cb320-800"><a href="#cb320-800" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb320-801"><a href="#cb320-801" aria-hidden="true" tabindex="-1"></a>  <span class="at">patient_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb320-802"><a href="#cb320-802" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">99</span>, <span class="dv">30</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">40</span>),    <span class="co"># -5 is wrong, 99 is suspect</span></span>
<span id="cb320-803"><a href="#cb320-803" aria-hidden="true" tabindex="-1"></a>  <span class="at">bp =</span> <span class="fu">c</span>(<span class="dv">120</span>, <span class="cn">NA</span>, <span class="dv">115</span>, <span class="dv">125</span>, <span class="dv">118</span>),  <span class="co"># NA is missing</span></span>
<span id="cb320-804"><a href="#cb320-804" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight =</span> <span class="fu">c</span>(<span class="dv">65</span>, <span class="dv">70</span>, <span class="cn">NA</span>, <span class="dv">68</span>, <span class="sc">-</span><span class="dv">1</span>)   <span class="co"># -1 is wrong</span></span>
<span id="cb320-805"><a href="#cb320-805" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb320-806"><a href="#cb320-806" aria-hidden="true" tabindex="-1"></a>clinical_data</span>
<span id="cb320-807"><a href="#cb320-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-808"><a href="#cb320-808" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing values</span></span>
<span id="cb320-809"><a href="#cb320-809" aria-hidden="true" tabindex="-1"></a><span class="fu">is.na</span>(clinical_data)</span>
<span id="cb320-810"><a href="#cb320-810" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(clinical_data))  <span class="co"># Count NAs by column</span></span>
<span id="cb320-811"><a href="#cb320-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-812"><a href="#cb320-812" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for impossible values</span></span>
<span id="cb320-813"><a href="#cb320-813" aria-hidden="true" tabindex="-1"></a>clinical_data<span class="sc">$</span>age <span class="sc">&lt;</span> <span class="dv">0</span></span>
<span id="cb320-814"><a href="#cb320-814" aria-hidden="true" tabindex="-1"></a>clinical_data<span class="sc">$</span>weight <span class="sc">&lt;</span> <span class="dv">0</span></span>
<span id="cb320-815"><a href="#cb320-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-816"><a href="#cb320-816" aria-hidden="true" tabindex="-1"></a><span class="co"># Find indices of problematic values</span></span>
<span id="cb320-817"><a href="#cb320-817" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(clinical_data<span class="sc">$</span>age <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">|</span> clinical_data<span class="sc">$</span>age <span class="sc">&gt;</span> <span class="dv">90</span>)</span>
<span id="cb320-818"><a href="#cb320-818" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-819"><a href="#cb320-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-820"><a href="#cb320-820" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fixing Data</span></span>
<span id="cb320-821"><a href="#cb320-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-822"><a href="#cb320-822" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fixing-data}</span></span>
<span id="cb320-823"><a href="#cb320-823" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace impossible values with NA</span></span>
<span id="cb320-824"><a href="#cb320-824" aria-hidden="true" tabindex="-1"></a>clinical_data<span class="sc">$</span>age[clinical_data<span class="sc">$</span>age <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">|</span> clinical_data<span class="sc">$</span>age <span class="sc">&gt;</span> <span class="dv">90</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb320-825"><a href="#cb320-825" aria-hidden="true" tabindex="-1"></a>clinical_data<span class="sc">$</span>weight[clinical_data<span class="sc">$</span>weight <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb320-826"><a href="#cb320-826" aria-hidden="true" tabindex="-1"></a>clinical_data</span>
<span id="cb320-827"><a href="#cb320-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-828"><a href="#cb320-828" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace NAs with mean (common in biological data)</span></span>
<span id="cb320-829"><a href="#cb320-829" aria-hidden="true" tabindex="-1"></a>clinical_data<span class="sc">$</span>bp[<span class="fu">is.na</span>(clinical_data<span class="sc">$</span>bp)] <span class="ot">&lt;-</span> <span class="fu">mean</span>(clinical_data<span class="sc">$</span>bp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb320-830"><a href="#cb320-830" aria-hidden="true" tabindex="-1"></a>clinical_data<span class="sc">$</span>weight[<span class="fu">is.na</span>(clinical_data<span class="sc">$</span>weight)] <span class="ot">&lt;-</span> <span class="fu">mean</span>(clinical_data<span class="sc">$</span>weight, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb320-831"><a href="#cb320-831" aria-hidden="true" tabindex="-1"></a>clinical_data</span>
<span id="cb320-832"><a href="#cb320-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-833"><a href="#cb320-833" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace NAs with median (better for skewed data)</span></span>
<span id="cb320-834"><a href="#cb320-834" aria-hidden="true" tabindex="-1"></a>clinical_data<span class="sc">$</span>age[<span class="fu">is.na</span>(clinical_data<span class="sc">$</span>age)] <span class="ot">&lt;-</span> <span class="fu">median</span>(clinical_data<span class="sc">$</span>age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb320-835"><a href="#cb320-835" aria-hidden="true" tabindex="-1"></a>clinical_data</span>
<span id="cb320-836"><a href="#cb320-836" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-837"><a href="#cb320-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-838"><a href="#cb320-838" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Transformation</span></span>
<span id="cb320-839"><a href="#cb320-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-840"><a href="#cb320-840" aria-hidden="true" tabindex="-1"></a><span class="fu">### Introduction to Outliers</span></span>
<span id="cb320-841"><a href="#cb320-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-842"><a href="#cb320-842" aria-hidden="true" tabindex="-1"></a>Outliers can significantly affect statistical analyses, especially in biological data where sample variation can be high.</span>
<span id="cb320-843"><a href="#cb320-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-844"><a href="#cb320-844" aria-hidden="true" tabindex="-1"></a><span class="in">```{r outliers}</span></span>
<span id="cb320-845"><a href="#cb320-845" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data with outliers</span></span>
<span id="cb320-846"><a href="#cb320-846" aria-hidden="true" tabindex="-1"></a>expression_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.3</span>, <span class="fl">2.7</span>, <span class="fl">3.1</span>, <span class="fl">2.9</span>, <span class="fl">2.5</span>, <span class="fl">3.0</span>, <span class="fl">15.2</span>, <span class="fl">2.8</span>)</span>
<span id="cb320-847"><a href="#cb320-847" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(expression_levels, </span>
<span id="cb320-848"><a href="#cb320-848" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Expression Levels with Outlier"</span>,</span>
<span id="cb320-849"><a href="#cb320-849" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Expression"</span>)</span>
<span id="cb320-850"><a href="#cb320-850" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-851"><a href="#cb320-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-852"><a href="#cb320-852" aria-hidden="true" tabindex="-1"></a><span class="fu">### Identifying Outliers</span></span>
<span id="cb320-853"><a href="#cb320-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-854"><a href="#cb320-854" aria-hidden="true" tabindex="-1"></a><span class="in">```{r identify-outliers}</span></span>
<span id="cb320-855"><a href="#cb320-855" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical approach: Values beyond 1.5*IQR</span></span>
<span id="cb320-856"><a href="#cb320-856" aria-hidden="true" tabindex="-1"></a>data_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(expression_levels)</span>
<span id="cb320-857"><a href="#cb320-857" aria-hidden="true" tabindex="-1"></a>data_summary</span>
<span id="cb320-858"><a href="#cb320-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-859"><a href="#cb320-859" aria-hidden="true" tabindex="-1"></a>IQR_value <span class="ot">&lt;-</span> <span class="fu">IQR</span>(expression_levels)</span>
<span id="cb320-860"><a href="#cb320-860" aria-hidden="true" tabindex="-1"></a>upper_bound <span class="ot">&lt;-</span> data_summary[<span class="st">"3rd Qu."</span>] <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR_value</span>
<span id="cb320-861"><a href="#cb320-861" aria-hidden="true" tabindex="-1"></a>lower_bound <span class="ot">&lt;-</span> data_summary[<span class="st">"1st Qu."</span>] <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR_value</span>
<span id="cb320-862"><a href="#cb320-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-863"><a href="#cb320-863" aria-hidden="true" tabindex="-1"></a><span class="co"># Find outliers</span></span>
<span id="cb320-864"><a href="#cb320-864" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> expression_levels[expression_levels <span class="sc">&gt;</span> upper_bound <span class="sc">|</span> </span>
<span id="cb320-865"><a href="#cb320-865" aria-hidden="true" tabindex="-1"></a>                             expression_levels <span class="sc">&lt;</span> lower_bound]</span>
<span id="cb320-866"><a href="#cb320-866" aria-hidden="true" tabindex="-1"></a>outliers</span>
<span id="cb320-867"><a href="#cb320-867" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-868"><a href="#cb320-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-869"><a href="#cb320-869" aria-hidden="true" tabindex="-1"></a><span class="fu">### Transforming Vectors</span></span>
<span id="cb320-870"><a href="#cb320-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-871"><a href="#cb320-871" aria-hidden="true" tabindex="-1"></a>Mathematical transformations can normalize data, reduce outlier effects, and make data more suitable for statistical analyses.</span>
<span id="cb320-872"><a href="#cb320-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-873"><a href="#cb320-873" aria-hidden="true" tabindex="-1"></a><span class="in">```{r transformations}</span></span>
<span id="cb320-874"><a href="#cb320-874" aria-hidden="true" tabindex="-1"></a><span class="co"># Original data</span></span>
<span id="cb320-875"><a href="#cb320-875" aria-hidden="true" tabindex="-1"></a>gene_exp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">42</span>, <span class="dv">87</span>, <span class="dv">115</span>, <span class="dv">320</span>, <span class="dv">560</span>, <span class="dv">1120</span>)</span>
<span id="cb320-876"><a href="#cb320-876" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(gene_exp, <span class="at">main =</span> <span class="st">"Original Expression Values"</span>, <span class="at">xlab =</span> <span class="st">"Expression"</span>)</span>
<span id="cb320-877"><a href="#cb320-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-878"><a href="#cb320-878" aria-hidden="true" tabindex="-1"></a><span class="co"># Log transformation (common in gene expression analysis)</span></span>
<span id="cb320-879"><a href="#cb320-879" aria-hidden="true" tabindex="-1"></a>log_exp <span class="ot">&lt;-</span> <span class="fu">log2</span>(gene_exp)</span>
<span id="cb320-880"><a href="#cb320-880" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(log_exp, <span class="at">main =</span> <span class="st">"Log2 Transformed Expression"</span>, <span class="at">xlab =</span> <span class="st">"Log2 Expression"</span>)</span>
<span id="cb320-881"><a href="#cb320-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-882"><a href="#cb320-882" aria-hidden="true" tabindex="-1"></a><span class="co"># Square root transformation (less aggressive than log)</span></span>
<span id="cb320-883"><a href="#cb320-883" aria-hidden="true" tabindex="-1"></a>sqrt_exp <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(gene_exp)</span>
<span id="cb320-884"><a href="#cb320-884" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sqrt_exp, <span class="at">main =</span> <span class="st">"Square Root Transformed Expression"</span>, <span class="at">xlab =</span> <span class="st">"Sqrt Expression"</span>)</span>
<span id="cb320-885"><a href="#cb320-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-886"><a href="#cb320-886" aria-hidden="true" tabindex="-1"></a><span class="co"># Z-score normalization (standardization)</span></span>
<span id="cb320-887"><a href="#cb320-887" aria-hidden="true" tabindex="-1"></a>z_exp <span class="ot">&lt;-</span> <span class="fu">scale</span>(gene_exp)</span>
<span id="cb320-888"><a href="#cb320-888" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(z_exp, <span class="at">main =</span> <span class="st">"Z-score Normalized Expression"</span>, <span class="at">xlab =</span> <span class="st">"Z-score"</span>)</span>
<span id="cb320-889"><a href="#cb320-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-890"><a href="#cb320-890" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare transformations</span></span>
<span id="cb320-891"><a href="#cb320-891" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb320-892"><a href="#cb320-892" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(gene_exp, <span class="at">main =</span> <span class="st">"Original"</span>)</span>
<span id="cb320-893"><a href="#cb320-893" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(log_exp, <span class="at">main =</span> <span class="st">"Log2"</span>)</span>
<span id="cb320-894"><a href="#cb320-894" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sqrt_exp, <span class="at">main =</span> <span class="st">"Square Root"</span>)</span>
<span id="cb320-895"><a href="#cb320-895" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(z_exp, <span class="at">main =</span> <span class="st">"Z-score"</span>)</span>
<span id="cb320-896"><a href="#cb320-896" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))  <span class="co"># Reset plotting layout</span></span>
<span id="cb320-897"><a href="#cb320-897" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-898"><a href="#cb320-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-899"><a href="#cb320-899" aria-hidden="true" tabindex="-1"></a><span class="fu">### Logical Expressions</span></span>
<span id="cb320-900"><a href="#cb320-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-901"><a href="#cb320-901" aria-hidden="true" tabindex="-1"></a><span class="in">```{r logical-expressions}</span></span>
<span id="cb320-902"><a href="#cb320-902" aria-hidden="true" tabindex="-1"></a><span class="co"># Create gene expression vector</span></span>
<span id="cb320-903"><a href="#cb320-903" aria-hidden="true" tabindex="-1"></a>exp_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">5.2</span>, <span class="fl">3.8</span>, <span class="fl">7.1</span>, <span class="fl">2.9</span>, <span class="fl">6.5</span>, <span class="fl">8.0</span>, <span class="fl">4.3</span>)</span>
<span id="cb320-904"><a href="#cb320-904" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(exp_data) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Gene_"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span>
<span id="cb320-905"><a href="#cb320-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-906"><a href="#cb320-906" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic comparisons</span></span>
<span id="cb320-907"><a href="#cb320-907" aria-hidden="true" tabindex="-1"></a>exp_data <span class="sc">&gt;</span> <span class="dv">5</span>    <span class="co"># Which genes have expression &gt; 5?</span></span>
<span id="cb320-908"><a href="#cb320-908" aria-hidden="true" tabindex="-1"></a>exp_data <span class="sc">&lt;=</span> <span class="dv">4</span>   <span class="co"># Which genes have expression &lt;= 4?</span></span>
<span id="cb320-909"><a href="#cb320-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-910"><a href="#cb320-910" aria-hidden="true" tabindex="-1"></a><span class="co"># Store results in logical vector</span></span>
<span id="cb320-911"><a href="#cb320-911" aria-hidden="true" tabindex="-1"></a>high_exp <span class="ot">&lt;-</span> exp_data <span class="sc">&gt;</span> <span class="dv">6</span></span>
<span id="cb320-912"><a href="#cb320-912" aria-hidden="true" tabindex="-1"></a>high_exp</span>
<span id="cb320-913"><a href="#cb320-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-914"><a href="#cb320-914" aria-hidden="true" tabindex="-1"></a><span class="co"># Use logical vectors for subsetting</span></span>
<span id="cb320-915"><a href="#cb320-915" aria-hidden="true" tabindex="-1"></a>exp_data[high_exp]  <span class="co"># Get high expression values</span></span>
<span id="cb320-916"><a href="#cb320-916" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-917"><a href="#cb320-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-918"><a href="#cb320-918" aria-hidden="true" tabindex="-1"></a><span class="fu">### Logical Operators</span></span>
<span id="cb320-919"><a href="#cb320-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-920"><a href="#cb320-920" aria-hidden="true" tabindex="-1"></a><span class="in">```{r logical-operators}</span></span>
<span id="cb320-921"><a href="#cb320-921" aria-hidden="true" tabindex="-1"></a><span class="co"># Combining conditions with AND (&amp;)</span></span>
<span id="cb320-922"><a href="#cb320-922" aria-hidden="true" tabindex="-1"></a>exp_data <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">&amp;</span> exp_data <span class="sc">&lt;</span> <span class="dv">7</span>  <span class="co"># Expression between 4 and 7</span></span>
<span id="cb320-923"><a href="#cb320-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-924"><a href="#cb320-924" aria-hidden="true" tabindex="-1"></a><span class="co"># Combining conditions with OR (|)</span></span>
<span id="cb320-925"><a href="#cb320-925" aria-hidden="true" tabindex="-1"></a>exp_data <span class="sc">&lt;</span> <span class="dv">4</span> <span class="sc">|</span> exp_data <span class="sc">&gt;</span> <span class="dv">7</span>  <span class="co"># Expression less than 4 OR greater than 7</span></span>
<span id="cb320-926"><a href="#cb320-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-927"><a href="#cb320-927" aria-hidden="true" tabindex="-1"></a><span class="co"># Using NOT (!)</span></span>
<span id="cb320-928"><a href="#cb320-928" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span>high_exp  <span class="co"># Not high expression</span></span>
<span id="cb320-929"><a href="#cb320-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-930"><a href="#cb320-930" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting with combined conditions</span></span>
<span id="cb320-931"><a href="#cb320-931" aria-hidden="true" tabindex="-1"></a>exp_data[exp_data <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">&amp;</span> exp_data <span class="sc">&lt;</span> <span class="dv">7</span>]  <span class="co"># Get values between 4 and 7</span></span>
<span id="cb320-932"><a href="#cb320-932" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-933"><a href="#cb320-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-934"><a href="#cb320-934" aria-hidden="true" tabindex="-1"></a><span class="fu">### Logical Functions</span></span>
<span id="cb320-935"><a href="#cb320-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-936"><a href="#cb320-936" aria-hidden="true" tabindex="-1"></a><span class="in">```{r logical-functions}</span></span>
<span id="cb320-937"><a href="#cb320-937" aria-hidden="true" tabindex="-1"></a><span class="co"># all() - Are all values TRUE?</span></span>
<span id="cb320-938"><a href="#cb320-938" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(exp_data <span class="sc">&gt;</span> <span class="dv">0</span>)  <span class="co"># Are all expressions positive?</span></span>
<span id="cb320-939"><a href="#cb320-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-940"><a href="#cb320-940" aria-hidden="true" tabindex="-1"></a><span class="co"># any() - Is at least one value TRUE?</span></span>
<span id="cb320-941"><a href="#cb320-941" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(exp_data <span class="sc">&gt;</span> <span class="dv">7</span>)  <span class="co"># Is any expression greater than 7?</span></span>
<span id="cb320-942"><a href="#cb320-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-943"><a href="#cb320-943" aria-hidden="true" tabindex="-1"></a><span class="co"># which() - Get indices of TRUE values</span></span>
<span id="cb320-944"><a href="#cb320-944" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(exp_data <span class="sc">&gt;</span> <span class="dv">6</span>)  <span class="co"># Which elements have expressions &gt; 6?</span></span>
<span id="cb320-945"><a href="#cb320-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-946"><a href="#cb320-946" aria-hidden="true" tabindex="-1"></a><span class="co"># %in% operator - Test for membership</span></span>
<span id="cb320-947"><a href="#cb320-947" aria-hidden="true" tabindex="-1"></a>test_genes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Gene_1"</span>, <span class="st">"Gene_5"</span>, <span class="st">"Gene_9"</span>)</span>
<span id="cb320-948"><a href="#cb320-948" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(exp_data) <span class="sc">%in%</span> test_genes  <span class="co"># Which names match test_genes?</span></span>
<span id="cb320-949"><a href="#cb320-949" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-950"><a href="#cb320-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-951"><a href="#cb320-951" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conditionals</span></span>
<span id="cb320-952"><a href="#cb320-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-953"><a href="#cb320-953" aria-hidden="true" tabindex="-1"></a><span class="in">```{r conditionals}</span></span>
<span id="cb320-954"><a href="#cb320-954" aria-hidden="true" tabindex="-1"></a><span class="co"># if-else statement</span></span>
<span id="cb320-955"><a href="#cb320-955" aria-hidden="true" tabindex="-1"></a>gene_value <span class="ot">&lt;-</span> <span class="fl">6.8</span></span>
<span id="cb320-956"><a href="#cb320-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-957"><a href="#cb320-957" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(gene_value <span class="sc">&gt;</span> <span class="dv">6</span>) {</span>
<span id="cb320-958"><a href="#cb320-958" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"High expression</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb320-959"><a href="#cb320-959" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span>(gene_value <span class="sc">&gt;</span> <span class="dv">4</span>) {</span>
<span id="cb320-960"><a href="#cb320-960" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Medium expression</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb320-961"><a href="#cb320-961" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb320-962"><a href="#cb320-962" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Low expression</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb320-963"><a href="#cb320-963" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb320-964"><a href="#cb320-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-965"><a href="#cb320-965" aria-hidden="true" tabindex="-1"></a><span class="co"># ifelse() for vectors</span></span>
<span id="cb320-966"><a href="#cb320-966" aria-hidden="true" tabindex="-1"></a>expression_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="fl">5.8</span>, <span class="fl">7.2</span>, <span class="fl">3.1</span>, <span class="fl">6.9</span>)</span>
<span id="cb320-967"><a href="#cb320-967" aria-hidden="true" tabindex="-1"></a>expression_category <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(expression_levels <span class="sc">&gt;</span> <span class="dv">6</span>, </span>
<span id="cb320-968"><a href="#cb320-968" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"High"</span>, </span>
<span id="cb320-969"><a href="#cb320-969" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(expression_levels <span class="sc">&gt;</span> <span class="dv">4</span>, <span class="st">"Medium"</span>, <span class="st">"Low"</span>))</span>
<span id="cb320-970"><a href="#cb320-970" aria-hidden="true" tabindex="-1"></a>expression_category</span>
<span id="cb320-971"><a href="#cb320-971" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-972"><a href="#cb320-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-973"><a href="#cb320-973" aria-hidden="true" tabindex="-1"></a><span class="fu">## Practical Session  </span></span>
<span id="cb320-974"><a href="#cb320-974" aria-hidden="true" tabindex="-1"></a>Check out this repo: <span class="in">`https://github.com/genomicsclass/dagdata/`</span></span>
<span id="cb320-975"><a href="#cb320-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-976"><a href="#cb320-976" aria-hidden="true" tabindex="-1"></a><span class="in">```{r practical, eval=FALSE}</span></span>
<span id="cb320-977"><a href="#cb320-977" aria-hidden="true" tabindex="-1"></a><span class="co"># Download small example dataset</span></span>
<span id="cb320-978"><a href="#cb320-978" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">"https://github.com/genomicsclass/dagdata/raw/master/inst/extdata/msleep_ggplot2.csv"</span>,</span>
<span id="cb320-979"><a href="#cb320-979" aria-hidden="true" tabindex="-1"></a>              <span class="at">destfile =</span> <span class="st">"msleep_data.csv"</span>)</span>
<span id="cb320-980"><a href="#cb320-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-981"><a href="#cb320-981" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb320-982"><a href="#cb320-982" aria-hidden="true" tabindex="-1"></a>msleep <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"msleep_data.csv"</span>)</span>
<span id="cb320-983"><a href="#cb320-983" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb320-984"><a href="#cb320-984" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-985"><a href="#cb320-985" aria-hidden="true" tabindex="-1"></a>**In-class Tasks:** </span>
<span id="cb320-986"><a href="#cb320-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-987"><a href="#cb320-987" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Convert 'vore' column to factor and plot its distribution.  </span>
<span id="cb320-988"><a href="#cb320-988" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Create a matrix of sleep data columns and add row names.  </span>
<span id="cb320-989"><a href="#cb320-989" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Find and handle any missing values.  </span>
<span id="cb320-990"><a href="#cb320-990" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Calculate mean sleep time by diet category (vore).  </span>
<span id="cb320-991"><a href="#cb320-991" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Identify outliers in sleep_total.  </span>
<span id="cb320-992"><a href="#cb320-992" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-993"><a href="#cb320-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-994"><a href="#cb320-994" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary of Today's Lesson  </span></span>
<span id="cb320-995"><a href="#cb320-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-996"><a href="#cb320-996" aria-hidden="true" tabindex="-1"></a>In today's class, we covered:</span>
<span id="cb320-997"><a href="#cb320-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-998"><a href="#cb320-998" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Factor Variables**: Essential for categorical data in biology (genotypes, treatments, etc.)</span>
<span id="cb320-999"><a href="#cb320-999" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Creation, levels, ordering, and visualization</span>
<span id="cb320-1000"><a href="#cb320-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-1001"><a href="#cb320-1001" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Subsetting Techniques**: Critical for data extraction and analysis</span>
<span id="cb320-1002"><a href="#cb320-1002" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Vector and data frame subsetting with various methods</span>
<span id="cb320-1003"><a href="#cb320-1003" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Using row names effectively for biological identifiers</span>
<span id="cb320-1004"><a href="#cb320-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-1005"><a href="#cb320-1005" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Matrix Operations**: Fundamental for expression data</span>
<span id="cb320-1006"><a href="#cb320-1006" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Creation, manipulation, and biological applications</span>
<span id="cb320-1007"><a href="#cb320-1007" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Calculating fold changes and other common operations</span>
<span id="cb320-1008"><a href="#cb320-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-1009"><a href="#cb320-1009" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Missing Values**: Practical approaches for real-world biological data</span>
<span id="cb320-1010"><a href="#cb320-1010" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Identification and appropriate replacement methods</span>
<span id="cb320-1011"><a href="#cb320-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-1012"><a href="#cb320-1012" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Data Transformation**: Making data suitable for statistical analysis</span>
<span id="cb320-1013"><a href="#cb320-1013" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Log, square root, and z-score transformations</span>
<span id="cb320-1014"><a href="#cb320-1014" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Outlier identification and handling</span>
<span id="cb320-1015"><a href="#cb320-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-1016"><a href="#cb320-1016" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>**Logical Operations**: For data filtering and decision making</span>
<span id="cb320-1017"><a href="#cb320-1017" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Conditions, combinations, and applications</span>
<span id="cb320-1018"><a href="#cb320-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-1019"><a href="#cb320-1019" aria-hidden="true" tabindex="-1"></a>   These skills form the foundation for the more advanced visualization techniques we'll cover in future lessons.  </span>
<span id="cb320-1020"><a href="#cb320-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-1021"><a href="#cb320-1021" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>We will know more about conditionals, R packages to handle data and visualization in a better and efficient way.  </span>
<span id="cb320-1022"><a href="#cb320-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-1023"><a href="#cb320-1023" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>**List**: Fundamental for many biological data and packages' output.  </span>
<span id="cb320-1024"><a href="#cb320-1024" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Properties, accessing, and applications</span>
<span id="cb320-1025"><a href="#cb320-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-1026"><a href="#cb320-1026" aria-hidden="true" tabindex="-1"></a><span class="fu">## Homework  </span></span>
<span id="cb320-1027"><a href="#cb320-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-1028"><a href="#cb320-1028" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Matrix Operations**:  </span>
<span id="cb320-1029"><a href="#cb320-1029" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Create a gene expression matrix with 8 genes and 4 conditions</span>
<span id="cb320-1030"><a href="#cb320-1030" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Calculate the mean expression for each gene</span>
<span id="cb320-1031"><a href="#cb320-1031" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Calculate fold change between condition 4 and condition 1</span>
<span id="cb320-1032"><a href="#cb320-1032" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Create a heatmap of your matrix</span>
<span id="cb320-1033"><a href="#cb320-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-1034"><a href="#cb320-1034" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Factor Analysis**:  </span>
<span id="cb320-1035"><a href="#cb320-1035" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Using the <span class="in">`iris`</span> dataset, convert Species to an ordered factor</span>
<span id="cb320-1036"><a href="#cb320-1036" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Create boxplots showing Sepal.Length by Species</span>
<span id="cb320-1037"><a href="#cb320-1037" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Calculate mean petal length for each species level</span>
<span id="cb320-1038"><a href="#cb320-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-1039"><a href="#cb320-1039" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Data Cleaning Challenge**:  </span>
<span id="cb320-1040"><a href="#cb320-1040" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>In the downloaded <span class="in">`msleep_data.csv`</span>:</span>
<span id="cb320-1041"><a href="#cb320-1041" aria-hidden="true" tabindex="-1"></a><span class="ss">     * </span>Identify all columns with missing values</span>
<span id="cb320-1042"><a href="#cb320-1042" aria-hidden="true" tabindex="-1"></a><span class="ss">     * </span>Replace missing values appropriately</span>
<span id="cb320-1043"><a href="#cb320-1043" aria-hidden="true" tabindex="-1"></a><span class="ss">     * </span>Create a new categorical variable "sleep_duration" with levels "Short", "Medium", "Long"</span>
<span id="cb320-1044"><a href="#cb320-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-1045"><a href="#cb320-1045" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**List challenge**:  </span>
<span id="cb320-1046"><a href="#cb320-1046" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Make your own lists</span>
<span id="cb320-1047"><a href="#cb320-1047" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Replicate all the tasks we did</span>
<span id="cb320-1048"><a href="#cb320-1048" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>You may ask AI to give you beginner-level questions but don't ask to solve the questions programmatically. Tell AI not to provide answers. </span>
<span id="cb320-1049"><a href="#cb320-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-1050"><a href="#cb320-1050" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Complete Documentation**:  </span>
<span id="cb320-1051"><a href="#cb320-1051" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Write all code in R Markdown</span>
<span id="cb320-1052"><a href="#cb320-1052" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Include comments explaining your approach</span>
<span id="cb320-1053"><a href="#cb320-1053" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Push to GitHub</span>
<span id="cb320-1054"><a href="#cb320-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-1055"><a href="#cb320-1055" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Due date: Friday 10pm BD Time  </span></span>
<span id="cb320-1056"><a href="#cb320-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-1057"><a href="#cb320-1057" aria-hidden="true" tabindex="-1"></a><span class="in">```{r save-examples, include=FALSE}</span></span>
<span id="cb320-1058"><a href="#cb320-1058" aria-hidden="true" tabindex="-1"></a><span class="co"># Save example data for students who missed class</span></span>
<span id="cb320-1059"><a href="#cb320-1059" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(expr_matrix, <span class="st">"example_expression_matrix.csv"</span>, <span class="at">row.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb320-1060"><a href="#cb320-1060" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(gene_df, <span class="st">"example_gene_data.csv"</span>, <span class="at">row.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb320-1061"><a href="#cb320-1061" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>